*****************************************
******* Sat Dec 12, 2020


ADJUST SURFACE GRIDS TO REDUCE OVERLAP


ogen -noplot solidEllipsoidInABoxGrid -order=2 -per=npp -a=.45 -b=.4 -c=.5 -overlapOption=maximize -factor=6



TRY maximize overlap --> WORKS , But there are small cells near the pole


ogen -noplot solidEllipsoidInABoxGrid -order=2 -per=npp -a=.45 -b=.4 -c=.5 -angle1=45 -rotationAxis1=1 -angle2=45 -rotationAxis2=0 -overlapOption=maximize -factor=3



REVISIT solid ellipsoid  *TROUBLE* non-matching mask at interface 

G3 -- 

$cgmx -noplot -noplot dielectricBodies -g=solidEllipsoidInABoxGride3.order2.hdf -tf=1 -tp=.1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-.75 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-.7 -xRightProbe=.7 -dm=none -probeFrequency=1 -probeFileName=EllipsoidEps4Polar1Dir1G4 -matFile=baMatIsoEps4.txt -go=og


ogen -noplot solidEllipsoidInABoxGrid -order=2 -per=npp -a=.45 -b=.4 -c=.5 -angle1=45 -rotationAxis1=1 -angle2=45 -rotationAxis2=0 -factor=3


--MX-- POTENTIAL Interface: ellipsoidOuterGrid=(grid1,side,dir1)=(1,0,2) AND ellipsoidInnerGrid=(grid2,side2,dir2)=(5,0,2) share=100
 grid1: r1=[5.00e-01,5.00e-01,0.00e+00] x1=[-3.18e-01,-2.25e-01,2.25e-01]
 grid2: r2=[5.00e-01,5.00e-01,-5.93e-31] x2=[-3.18e-01,-2.25e-01,2.25e-01] .. rDist=5.93e-31 xDist=1.52e-17, xNorm=3.66e+00
--MX-- Interface found: ellipsoidOuterGrid=(grid1,side,dir1)=(1,0,2) matches ellipsoidInnerGrid=(grid2,side2,dir2)=(5,0,2) share=100
       ERROR: the mask arrays do not match on the interface. This is currently required.
       Try re-generating the grid with more lines in the normal direction, this sometimes fixes this problem.
       See debug file for more info if debug &2 


*****************************************
******* Wed Dec 9, 2020

REVISIT ELLIPSOID



To-do:
    - convert to Nurbs
    - periodic 



NURBS and rotated: 
ogen -noplot solidEllipsoidInABoxGrid -order=2 -per=npp -a=.375 -b=.4 -c=.5 -angle1=45 -rotationAxis1=1 -angle2=45 -rotationAxis2=0 -factor=4
ogen -noplot solidEllipsoidInABoxGrid -order=2 -per=npp -a=.375 -b=.4 -c=.5 -angle1=45 -rotationAxis1=1 -factor=4


ogen -noplot solidEllipsoidInABoxGrid -order=2 -interp=e -factor=4


*****************************************
******* Sun Nov 28, 2020

START TEST RUN PARALLEL

runParallel.p -runCase=performance -configFile="bodyConfig.pl" -npv=2 -matFile=matGDM2.txt -tf=0.5 -factor=64 -order=4 -numRuns=3


runParallel.p -runCase=performance -configFile="bodyConfig.pl" -npv=2 -matFile=matGDM2.txt -tf=0.5 -factor=32 -order=4 -numRuns=3


\begin{table}[hbt]
\begin{center}\tableFont
\begin{tabular}{|c|c|c|} \hline
  NP  & sec/step   &  speedup  \\   \hline\hline 
   1  &  1.2e-01   &     1.0  \\
   2  &  7.3e-02   &     1.7  \\
   4  &  5.9e-02   &     2.1  \\
 \hline 
\end{tabular}
\end{center}
\caption{bodysquare137438953472matGDM2,   shortSolidDiskGridYpe32.order4.ng3.hdf , 1.20972e+06 grid points, Computer: CG6, 48 procs = 2 X 12 core (X 2 threads), Intel Xeon CPU E5-2697 v2 @ 2
.70GHz, 132 Gb, Sun Nov 29 14:46:45 2020.}
\label{tab:bodysquare137438953472matGDM2} 
\end{table}



runParallel.p -runCase=performance -configFile="bodyConfig.pl" -npv=2 -matFile=matGDM2.txt -tf=0.5 -factor=16 -order=4 -numRuns=2

factor=16
Case 0 np=1: advance: cpu=1.17e+01, cpu/step=4.21e-02, percent=97.003 
Case 1 np=2: advance: cpu=8.31e+00, cpu/step=2.99e-02, percent=97.933 





TEST THREE DIMENSIONS


ELLIPSOID

mpirun -np=2 $cgmx -noplot -noplot dielectricBodies -g=solidEllipsoidInABoxGride4.order2.hdf -tf=1 -tp=.1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-.75 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-.7 -xRightProbe=.7 -dm=none -probeFrequency=1 -probeFileName=EllipsoidEps4Polar1Dir1G4 -matFile=baMatIsoEps4.txt -go=og

runScat.p -tf=1 -case=EllipsoidEps4 -grid=solidEllipsoidInABoxGrid -order=2 -xProbe=.65 -xGaussianPlaneWaveStartPoint=1.5 -matFile=matIsoEps4 -dm=none -direction=1 -polarization=-1 -resStart=2 -numResolutions=2



GDM SPHERE - order=4  OK 
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=dielectricSphereGride4.order4.ng3.hdf -tf=1 -tp=.1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-1.0 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=gdm -probeFrequency=1 -probeFileName=SphereEps4Polar1Dir1G4 -matFile=baMatGDM1.txt -debug=0 -go=og

GDM SPHERE - order=2  OK 
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=dielectricSphereGride4.order2.hdf -tf=1 -tp=.1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-1.0 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=gdm -probeFrequency=1 -probeFileName=SphereEps4Polar1Dir1G4 -matFile=baMatGDM1.txt -debug=0 -go=og



SPHERE -- **trouble --> matIsoEps4.txt leads to a dispersive material **    --> ADDED CHECK 
mpirun -np 1 $cgmx -noplot dielectricBodies -g=dielectricSphereGride2.order2.hdf -tf=1 -tp=.1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-1.0 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=SphereEps4Polar1Dir1G4 -matFile=matIsoEps4.txt -go=og

SPHERE - order=4  OK 
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=dielectricSphereGride4.order4.ng3.hdf -tf=1 -tp=.1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-1.0 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=SphereEps4Polar1Dir1G4 -matFile=baMatIsoEps4.txt -go=og

SPHERE - order=2 OK 
mpirun -np 1 $cgmx -noplot dielectricBodies -g=dielectricSphereGride2.order2.hdf -tf=1 -tp=.1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-1.0 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=SphereEps4Polar1Dir1G4 -matFile=baMatIsoEps4.txt -go=og

serial OK 
$cgmx -noplot dielectricBodies -g=dielectricSphereGride2.order2.hdf -tf=1 -tp=.1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-1.0 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=SphereEps4Polar1Dir1G4 -matFile=matIsoEps4.txt -go=og 


runScat.p -tf=200 -case=SphereEps4 -grid=dielectricSphereGrid -order=2 -xProbe=.75 -xGaussianPlaneWaveStartPoint=1.5 -matFile=matIsoEps4 -dm=none -direction=1 -polarization=1 -resStart=2 -numResolutions=2





I-BEAM -OK 
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=IBeamGride16.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.2 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=1 -go=og



mpirun -np 2 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe8.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=.5 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=0 -go=og



BUG FOUND IN MASK CHECK ON INTERACE


TEST INTERFACE MASK CHECK


mpirun -np 2 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe2.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.01 -tf=.01 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=3 -go=go 

*****************************************
******* Sat Nov 27, 2020


BACK T0 PARALLEL


ISSUE WITH MASK ON INTERFACE -- parallel check is broken ??
mpirun -np 2 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe8.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=.5 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=0 -go=og 


ISSUE WITH MASK ON INTERFACE -- parallel check is broken ??
mpirun -np=4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=IBeamGride16.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=1 -go=og

OK 
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=none -matFile=baMatIsoEps2.txt -debug=1 -go=og



PLOT POLARIZATION COMPONENTS


cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe2.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=5 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=1 -show=db.show -go=og 

NPV=2 : 
cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe2.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=5 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -npv=2 -matFile=baMatGDM2.txt -debug=1 -show=db.show -go=og 


*****************************************
******* Fri Nov 26, 2020

Now OK: 
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=none -matFile=baMatIsoEps2.txt -debug=1 -go=og



>>>>>>>>>>>>>   **bug found** RadiationBC.C includeGhost



+++++++++++++ ORDER=2 *trouble*
NO-GDM : TROUBLE on the interface for FOR np=4 
ERROR AT OUTFLOW in Ex 
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.01 -tf=1 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=none -matFile=baMatIsoEps2.txt -debug=1 -go=og




mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=none -matFile=baMatIsoEps2.txt -debug=1 -go=og

+++++++++++++++++++++ ORDER=4 LOOKS OK
+++ test order=4
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.05 -tf=1 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=none -matFile=baMatIsoEps2.txt -debug=1 -go=og

mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=10 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=none -matFile=baMatIsoEps2.txt -debug=1 -go=og


********************************
********  Thurs Nov 26, 2020

TODO -- fix show file for P and N

$cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe2.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=.5 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=1 -show=db.show -go=go 




++++++++++ MORE PARALLEL TESTS 

-- ELLIPSE 
ellipticalSmallGride2.order2.hdf

NO-GMD *bad* for -np=6 -np=8 
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatIsoEps2.txt -debug=1 -go=og

CHECK PARALLEL: 
mpirun -np 1 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.01 -tf=.03 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatIsoEps2.txt -debug=7 -go=go 

mpirun -np 1 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.01 -tf=.03 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=7 -go=go 




OK for np=2 -- bad for np=4
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=ellipticalSmallGride2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=1 -go=og



----- IBeam
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=IBeamGride8.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=1 -go=og

parallel -- np=1 : ok , *trouble: np=2
mpirun -np 1 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=IBeamGride8.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=1 -go=og

ORDER=4 : OK for np=1
mpirun -np=1 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=IBeamGride16.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=1 -go=og

>>> TEST: **TROUBLE np=2 
mpirun -np 1 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=IBeamGride8.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=1 -go=og

try no-GDM  **TROUBLE np=2 
mpirun -np 2 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=IBeamGride8.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatIsoEps2.txt -debug=1 -go=og



>>>>>> Serial -- OK

$cgmx -noplot dielectricBodies -numParallelGhost=3 -g=IBeamGride8.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=1 -go=og




mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1a.txt -debug=1 -go=og



********************************
********  Wed Nov 25, 2020

BUG FOUND --> interface3d: only extend STAGE 1 bounds on parallel boundaries 


START TEST PARALLEL + interfaces + GDM 

--OK--
mpirun -np 2 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe2.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.1 -tf=3 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=1 -go=og




debug=7 : no nan's 

$cgmx -noplot dielectricBodies -numParallelGhost=2 -g=shortSolidDiskGridYpe1.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.01 -tf=.01 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=7 -go=go 


>>> Cgmx:FD: t=1.00e-02 dt=1.0e-02 TS=ME GDM |div(E)|/|grad(E)|=     nan (=3.03e-04/     nan) 1 steps mem=66.9(Mb) cpu=7.58e+00(s)



GDM: TROUBLE: nan's 
mpirun -np 1 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe2.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tp=.01 -tf=.03 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=1 -go=og

valgrind $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe2.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=.03 -tp=.01 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=3 -go=go



++++++ Order=2 **TROUBLE**

valgrind $cgmx -noplot dielectricBodies -numParallelGhost=2 -g=shortSolidDiskGridYpe2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=.01 -tp=.01 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=3 -go=go >& junk

**TROUBLE**
$cgmx -noplot dielectricBodies -numParallelGhost=2 -g=shortSolidDiskGridYpe2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=.03-tp=.01 -xLeftProbe=-0.7 -xRightProbe=0.7 -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -dm=gdm -matFile=baMatGDM1.txt -debug=3 -go=og


NO-GDM -OK-
mpirun -np 1 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-0.7 -xRightProbe=0.7  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og

********************************
********  Sun Nov 15, 2020


SIMPLE TEST CASE FOR PARALLEL PERF.


$cgmx -noplot dielectricBodies -numParallelGhost=3 -g=square256.order4.ng3.hdf -backGround=outerSquare -rbc=pec  -background=OuterSquare -ic=gpw -x0=0.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=.5 -tp=.5  -xLeftProbe=.25 -xRightProbe=0.75  -matFile=baMatIsoEps2.txt -go=go 


********************************
********  Tues Nov 10, 2020

START THINKING OF PARALLEL FOR DISPERSIVE


TEST Shorter domain
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-0.7 -xRightProbe=0.7  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og

Timing: 
mpirun -np 1 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=shortSolidDiskGridYpe8.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-1.0 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=1 -tp=1  -xLeftProbe=-0.7 -xRightProbe=0.7  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=go 


++++++++++ -np=4
              ---------Maxwell Summary------- 
                       Tue Nov 10 07:41:06 2020
               Grid:   shortSolidDiskGridYpe8.order4.ng3.hdf 
  ==== final time= 1.00e+00, numberOfStepsTaken =      252, grids=4, gridpts =80541, interp pts=3648, processors=4 ==== 
  ==== memory per-proc: [min=68.4648,ave=69.2295,max=69.7539](Mb), max-recorded=69.1719 (Mb), total=276.918 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  4.25e+00    1.69e-02    2.10e-07   100.000   4.252e+00   4.252e+00
setup and initialize................  7.58e-03    3.01e-05    3.73e-10     0.178   7.588e-03   7.561e-03
initial conditions..................  5.00e-03    1.98e-05    2.46e-10     0.117   5.194e-03   4.793e-03
advance.............................  4.20e+00    1.67e-02    2.07e-07    98.798   4.201e+00   4.201e+00
  advance rectangular grids.........  1.24e+00    4.92e-03    6.11e-08    29.187   1.243e+00   1.239e+00
  advance curvilinear grids.........  4.63e-01    1.84e-03    2.28e-08    10.897   4.644e-01   4.618e-01
   (advOpt).........................  1.37e+00    5.43e-03    6.74e-08    32.194   1.371e+00   1.367e+00
  boundary conditions...............  1.05e+00    4.18e-03    5.19e-08    24.794   1.066e+00   1.042e+00
  interface bc......................  8.35e-01    3.31e-03    4.11e-08    19.638   8.412e-01   8.172e-01
  radiation bc......................  7.99e-01    3.17e-03    3.94e-08    18.783   8.078e-01   7.736e-01
  radiationKernel...................  7.58e-01    3.01e-03    3.74e-08    17.829   7.669e-01   7.334e-01
    Fourier transform...............  5.87e-01    2.33e-03    2.89e-08    13.806   5.945e-01   5.659e-01
  interpolation.....................  3.68e-01    1.46e-03    1.81e-08     8.647   4.322e-01   1.742e-01
  update ghost (parallel)...........  3.45e-01    1.37e-03    1.70e-08     8.122   7.180e-01   1.117e-01
  get norms.........................  6.58e-04    2.61e-06    3.24e-11     0.015   6.580e-04   6.571e-04
get divergence......................  1.99e-02    7.91e-05    9.83e-10     0.469   1.996e-02   1.989e-02
compute dt..........................  1.42e-03    5.64e-06    7.00e-11     0.033   1.441e-03   1.405e-03
plotting............................  2.02e-02    8.02e-05    9.96e-10     0.475   2.022e-02   2.020e-02
output results......................  7.50e-02    2.98e-04    3.70e-09     1.764   7.989e-02   7.261e-02
waiting (not counted)...............  4.17e-04    1.65e-06    2.05e-11     0.010   4.249e-04   4.025e-04

++++++++++ -np=2
              ---------Maxwell Summary------- 
                       Tue Nov 10 07:40:22 2020
               Grid:   shortSolidDiskGridYpe8.order4.ng3.hdf 
  ==== final time= 1.00e+00, numberOfStepsTaken =      252, grids=4, gridpts =80541, interp pts=3648, processors=2 ==== 
  ==== memory per-proc: [min=74.2188,ave=75.5,max=76.7812](Mb), max-recorded=75.7891 (Mb), total=151 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  7.87e+00    3.12e-02    3.88e-07   100.000   7.868e+00   7.868e+00
setup and initialize................  1.21e-02    4.82e-05    5.98e-10     0.154   1.214e-02   1.214e-02
initial conditions..................  8.15e-03    3.24e-05    4.02e-10     0.104   8.152e-03   8.152e-03
advance.............................  7.79e+00    3.09e-02    3.84e-07    99.034   7.792e+00   7.792e+00
  advance rectangular grids.........  2.37e+00    9.40e-03    1.17e-07    30.119   2.823e+00   1.916e+00
  advance curvilinear grids.........  1.51e+00    6.01e-03    7.46e-08    19.243   1.514e+00   1.514e+00
   (advOpt).........................  2.64e+00    1.05e-02    1.30e-07    33.536   2.808e+00   2.469e+00
  boundary conditions...............  1.49e+00    5.92e-03    7.34e-08    18.947   1.491e+00   1.491e+00
  interface bc......................  2.58e+00    1.02e-02    1.27e-07    32.744   2.576e+00   2.576e+00
  radiation bc......................  1.24e+00    4.92e-03    6.11e-08    15.758   1.240e+00   1.240e+00
  radiationKernel...................  1.17e+00    4.65e-03    5.78e-08    14.899   1.172e+00   1.172e+00
    Fourier transform...............  8.58e-01    3.41e-03    4.23e-08    10.910   8.584e-01   8.584e-01
  interpolation.....................  4.01e-01    1.59e-03    1.98e-08     5.097   6.545e-01   1.475e-01
  update ghost (parallel)...........  9.36e-02    3.71e-04    4.61e-09     1.189   1.348e-01   5.230e-02
  get norms.........................  1.01e-03    4.00e-06    4.97e-11     0.013   1.008e-03   1.008e-03
get divergence......................  3.71e-02    1.47e-04    1.83e-09     0.471   3.707e-02   3.707e-02
compute dt..........................  2.84e-03    1.13e-05    1.40e-10     0.036   3.484e-03   2.205e-03
plotting............................  3.52e-02    1.40e-04    1.73e-09     0.447   3.520e-02   3.520e-02
output results......................  1.31e+00    5.21e-03    6.47e-08    16.689   2.550e+00   7.628e-02
waiting (not counted)...............  4.08e-04    1.62e-06    2.01e-11     0.005   4.077e-04   4.077e-04
--------------------------------------------------------------------------------------------------------

++++++++++++++++++ -np=1

              ---------Maxwell Summary------- 
                       Tue Nov 10 07:39:52 2020
               Grid:   shortSolidDiskGridYpe8.order4.ng3.hdf 
  ==== final time= 1.00e+00, numberOfStepsTaken =      252, grids=4, gridpts =80541, interp pts=3648, processors=1 ==== 
  ==== memory per-proc: [min=87.1914,ave=87.1914,max=87.1914](Mb), max-recorded=85.3945 (Mb), total=87.1914 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  1.07e+01    4.23e-02    5.25e-07   100.000   1.065e+01   1.065e+01
setup and initialize................  1.40e-02    5.54e-05    6.87e-10     0.131   1.395e-02   1.395e-02
initial conditions..................  1.26e-02    4.98e-05    6.19e-10     0.118   1.256e-02   1.256e-02
advance.............................  1.05e+01    4.18e-02    5.19e-07    98.905   1.054e+01   1.054e+01
  advance rectangular grids.........  4.67e+00    1.85e-02    2.30e-07    43.852   4.672e+00   4.672e+00
  advance curvilinear grids.........  1.50e+00    5.95e-03    7.38e-08    14.064   1.498e+00   1.498e+00
   (advOpt).........................  5.22e+00    2.07e-02    2.57e-07    49.020   5.223e+00   5.223e+00
  boundary conditions...............  1.55e+00    6.16e-03    7.65e-08    14.569   1.552e+00   1.552e+00
  interface bc......................  2.53e+00    1.00e-02    1.25e-07    23.728   2.528e+00   2.528e+00
  radiation bc......................  1.21e+00    4.82e-03    5.98e-08    11.392   1.214e+00   1.214e+00
  radiationKernel...................  1.09e+00    4.31e-03    5.35e-08    10.194   1.086e+00   1.086e+00
    Fourier transform...............  4.82e-01    1.91e-03    2.37e-08     4.520   4.816e-01   4.816e-01
  interpolation.....................  1.41e-01    5.60e-04    6.95e-09     1.324   1.411e-01   1.411e-01
  update ghost (parallel)...........  1.17e-02    4.64e-05    5.76e-10     0.110   1.169e-02   1.169e-02
  get norms.........................  1.25e-03    4.97e-06    6.17e-11     0.012   1.252e-03   1.252e-03
get divergence......................  7.02e-02    2.79e-04    3.46e-09     0.659   7.024e-02   7.024e-02
compute dt..........................  2.15e-03    8.54e-06    1.06e-10     0.020   2.152e-03   2.152e-03
plotting............................  6.49e-02    2.58e-04    3.20e-09     0.609   6.491e-02   6.491e-02
output results......................  9.27e-02    3.68e-04    4.57e-09     0.870   9.269e-02   9.269e-02
waiting (not counted)...............  3.52e-04    1.40e-06    1.73e-11     0.003   3.519e-04   3.519e-04
--------------------------------------------------------------------------------------------------------




mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=solidDiskYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og



********************************
********  Sun Nov 8, 2020

**BUG FIXED : assignInterfaceBCs.bC -- fix workspace for Jacobi update for parallel


**BUG FIXED : computeTimeStep.C -- getGridSpacing uses communication!

ORDER=4 -np=2 : OK -np=3: TROUBLE 
mpiexec -n 3 xterm -e gdb --args $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=solidDiskYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=go

ORDER=4 -np=2 : OK -np=3: TROUBLE
mpirun -np 4 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=solidDiskYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og

ORDER=2
mpirun -np 4 $cgmx -noplot dielectricBodies -g=solidDiskYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og

mpirun -np 2 $cgmx -noplot dielectricBodies -g=solidDiskYpe2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og


********************************
********  Sat Nov 7, 2020

**BUG FIXED in RaditionBoundaryCondition.C *** routines: 

START TEST PARALLEL NLNR BC's in parallel

recte2np.order2.hdf

+++++++++++ DISK 

mpiexec -np 2 valgrind --log-file=cgmx.out.np%p $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=solidDiskYpe1.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=.1 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=go 


TROUBLE:
mpiexec -n 2 xterm -e gdb --args $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=solidDiskYpe1.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og

TROUBLE:
mpirun -np 2 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=solidDiskYpe2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og

mpirun -np 2 $cgmx -noplot dielectricBodies  -g=solidDiskYpe1.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og -debug=3



valgrind $cgmx -noplot dielectricBodies  -g=solidDiskYpe1.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=.1 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=go -debug=3 >& junk



DIRICHLET BC OK 
cgmx -noplot dielectricBodies -g=solidDiskYpe2.order2.hdf -backGround=outerSquare -rbc=dirichlet  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.01  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og

**BUG FIXED in RaditionBoundaryCondition.C ***

TROUBLE
cgmx -noplot dielectricBodies -g=solidDiskYpe2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=.02 -tp=.01  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=go > junk

cgmx -noplot dielectricBodies -g=solidDiskYpe2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=1 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og 

valgrind $cgmx -noplot dielectricBodies -g=solidDiskYpe2.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=1 -tp=.01  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og


+++++++++++++++  RECTANGLE: 

OK
mpirun -np 2 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=recte4np.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og

OK
mpirun -np 2 $cgmx -noplot dielectricBodies -g=recte2np.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og

**TROUBLE**
cgmx -noplot dielectricBodies -g=recte2np.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og

valgrind $cgmx -noplot dielectricBodies -g=recte2np.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=.2 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=go

cgmx -noplot dielectricBodies -g=recte2np.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-.5 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og





>>> TRY baMatIsoEps2
mpirun -np 2 $cgmx -noplot dielectricBodies -numParallelGhost=3 -g=solidDiskYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1. -useSosupDissipation=1 -tf=30 -tp=.5  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og 

cgmx -noplot dielectricBodies -g=solidDiskYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1. -useSosupDissipation=1 -tf=30 -tp=.5  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=baMatIsoEps2.txt -go=og 


NOT DISPERSIVE ?!
--MX-- INTERFACE - finish me for dispersive and parallel
cgmx -noplot dielectricBodies -g=solidDiskYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1. -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og 


SERIAL, ORDER=2: **BROKEN** NAN's
cgmx -noplot dielectricBodies -g=solidDiskYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.01  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og

SERIAL ORDER=4 : OK 
cgmx -noplot dielectricBodies -g=solidDiskYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1 -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og

********************************
********  Fri Oct 23, 2020

ogen -noplot solidCylinderInABoxGrid -prefix=solidCylGrid -order=2 -interp=e -ybc=p -zbc=p -factor=2 -za=-.5 -zb=.5 



********************************
********  Sat Jun 27, 2020

START -- Homogenize an array of gdm disks

ogen -noplot latticeGrid -prefix=fourDisksGrid -xa=-2.5 -xb=2.5 -rad=.25 -deltaX=.65 -deltaY=.65 -order=2 -interp=e -nCylx=2 -nCyl=2 -factor=2


********************************
********  Sat Jun 27, 2020

CONTUNUE HOMOGENIZING A DISK (CYLINDER)

GDM disk -- order=4
runScat.p -tf=400 -case=SolidDiskMatIsoEps4GDMfp25 -grid=solidDiskYp -order=4 -matFile=matIsoEps4GDMfp25 -dm=gdm -direction=1  -polarization=1 -resStart=2 -numResolutions=2

GDM disk -- order=2
runScat.p -tf=400 -case=SolidDiskMatIsoEps4GDMfp25 -grid=solidDiskYp -order=2 -matFile=matIsoEps4GDMfp25 -dm=gdm -direction=1  -polarization=1 -resStart=2 -numResolutions=2


********************************
********  Fri Jun 26, 2020


START ON HOMOGENIZING A DISK (CYLINDER)

eps=4
runScat.p -tf=100 -case=SolidDiskMatIsoEps4 -grid=solidDiskYp -order=2 -matFile=matIsoEps4 -dm=none -direction=1  -polarization=1 -resStart=2 -numResolutions=2



>>>> FIX-UP runScat.p
runScat.p -tf=100 -case=SolidDiskMatIsoEps2 -grid=solidDiskYp -order=2 -matFile=matIsoEps2 -dm=none -direction=1  -polarization=1 -resStart=2 -numResolutions=2


*new grid*
cgmx -noplot dielectricBodies -g=solidDiskYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1. -useSosupDissipation=1 -tf=100 -tp=1.0  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=go > ! solidDiskkMatIsoEps2.out

*new grid*
cgmx -noplot dielectricBodies -g=solidDiskYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1. -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=SolidDiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og 



cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal  -background=OuterSquare -ic=gpw -x0=-2 -kx=1 -eps1=2 -eps2=1. -useSosupDissipation=1 -tf=30 -tp=.1  -xLeftProbe=-1 -xRightProbe=1  -probeFrequency=1 -probeFileName=DiskMatIsoEps2 -matFile=matIsoEps2.txt -go=og 




********************************
********  St Jun 6, 2020

MAKE PLOTS FOR DOCS

runScat.p -tf=100 -case=Block -matFile=matIsoGDM2 -dm=gdm -direction=1  -polarization=1 -numResolutions=3


/home/henshw/cg.g/mx/bin/cgmx -noplot -noplot dielectricBodies -g=blockGride8.order4.ng3.hdf -tf=10 -tp=.5 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=gdm -probeFrequency=1 -probeFileName=BlockMatIsoGDM2Polar1Dir1G2 -matFile=matIsoGDM2.txt -show=blockMatIsoGDM2G8.show -go=go


********************************
********  Thurs May 28, 2020


matIsoGDM2.txt : eps=2

runScat.p -tf=100 -case=Block -matFile=matIsoGDM2 -dm=gdm -direction=1  -polarization=1 -numResolutions=3



********************************
********  Tues May 27, 2020

CHANGE matIsoGDM1 to use BA format

RERUN: 

runScat.p -tf=100 -case=Block -matFile=matIsoGDM1 -dm=gdm -direction=1  -polarization=1 -numResolutions=3


runScat.p -tf=20 -case=Block -matFile=matIsoGDM1 -dm=gdm -direction=1  -polarization=1 -numResolutions=1



********************************
********  Tues May 26, 2020


+++++++++++ SWITCH TO BA FORMAT FOR TXT MATERIAL FILES

GDM: 
cgmx -noplot -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=100 -tp=1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=gdm -probeFrequency=1 -probeFileName=probe -matFile=baMatGDM1.txt -go=og


cgmx -noplot -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=100 -tp=1 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=probe -matFile=baMatIsoEps2.txt -go=og

********************************
********  Mon May 25, 2020

SIMPLE GDM: **FIXED** omegaScale to GDM pars are unchanged when read into cgx

runScat.p -tf=100 -case=Block -matFile=matIsoGDM1 -dm=gdm -direction=1  -polarization=1 -numResolutions=3




********************************
********  Sun May 24, 2020

SIMPLE GDM:

runScat.p -tf=20 -case=Block -matFile=matIsoGDM1 -dm=gdm -direction=1  -polarization=1 -numResolutions=1


EPS=2: run all cases 
runScat.p -tf=20 -case=Block -matFile=matIsoEps2 -direction=-1  -polarization=-1 -numResolutions=3






********************************
********  Tues May 19, 2020

TEST DIRECTION=2 

runScat.p -tf=20 -case=Block -matFile=matIsoEps2 -direction=2 -numResolutions=3


********************************
********  Sun May 17, 2020


Return to plane-wave initial condition

runScat.p -tf=20 -case=Block -matFile=matIsoEps2 -ic=pw -direction=1 -numResolutions=3

runScat.p -tf=20 -case=Block -matFile=matIsoEps1 -ic=pw -direction=1 -numResolutions=3



********************************
********  Sat May 16, 2020


START: FIX GAUSSIAN PLANE WAVE TO SUPPORT TMZ POLARIZATION


TMz Polarization  -az=1   a = (0,0,1) 
cgmx -noplot dielectricBodies -g=blockGrid3de2.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=gp -kx=1 -az=1 -x0=-1 -rbc=abcEM2 -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=block3dp2Eps1G2 -eps1=1 -go=og


********************************
********   Thurs May 14, 2020


3D GAUSSIAN POLARIZATION=2 
runScat.p -tf=20 -case=Block3d -grid=blockGrid3d -rbc=abcEM2 -matFile=matIsoEps2 -ic=gp -direction=1 -polarization=2 -numResolutions=2
runScat.p -tf=20 -case=Block3d -grid=blockGrid3d -rbc=abcEM2 -matFile=matIsoEps1 -ic=gp -direction=1 -polarization=2 -numResolutions=2


3D GAUSSIAN POLARIZATION=1 
runScat.p -tf=20 -case=Block3d -grid=blockGrid3d -rbc=abcEM2 -matFile=matIsoEps2 -ic=gp -direction=1 -polarization=1 -numResolutions=2
runScat.p -tf=20 -case=Block3d -grid=blockGrid3d -rbc=abcEM2 -matFile=matIsoEps1 -ic=gp -direction=1 -polarization=1 -numResolutions=2



3D PLANE-WAVE POLARIZATION=2 
runScat.p -tf=20 -case=Block3d -grid=blockGrid3d -rbc=abcEM2 -matFile=matIsoEps2 -ic=pw -direction=1 -polarization=2 -numResolutions=2
runScat.p -tf=20 -case=Block3d -grid=blockGrid3d -rbc=abcEM2 -matFile=matIsoEps1 -ic=pw -direction=1 -polarization=2 -numResolutions=2

3D PLANE WAVE
runScat.p -tf=10 -case=Block3d -grid=blockGrid3d -rbc=abcEM2 -matFile=matIsoEps2 -ic=pw  -direction=1 -numResolutions=2
runScat.p -tf=10 -case=Block3d -grid=blockGrid3d -rbc=abcEM2 -matFile=matIsoEps1 -ic=pw  -direction=1 -numResolutions=2



Return to plane-wave initial condition

runScat.p -tf=20 -case=Block -matFile=matIsoEps2 -ic=pw -direction=1 -numResolutions=2
runScat.p -tf=20 -case=Block -matFile=matIsoEps1 -ic=pw -direction=1 -numResolutions=2


********************************
********   Wed May 13, 2020


Reverse direction:

cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=gp -kx=-1 -x0=2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=blockGPWEps2G4 -matFile=matIsoEps2.txt -go=og


runScat.p -tf=20 -case=Block -matFile=matIsoEps2 -direction=2 -numResolutions=2
runScat.p -tf=20 -case=Block -matFile=matIsoEps1 -direction=2 -numResolutions=2



START ON PERL SCRIPT runScat.p

runScat.p -tf=20 -case=Block -matFile=matIsoEps4 -numResolutions=3
runScat.p -tf=20 -case=Block -matFile=matIsoEps3 -numResolutions=3
runScat.p -tf=20 -case=Block -matFile=matIsoEps2 -numResolutions=3
runScat.p -tf=20 -case=Block -matFile=matIsoEps1 -numResolutions=3

runScat.p -tf=1 -case=Block -matFile=matIsoEps2 -numResolutions=2
runScat.p -tf=1 -case=Block -matFile=matIsoEps1 -numResolutions=2


START USING -matFile2=baIsoEps2.txt 

cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=gp -kx=1 -x0=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=blockGPWEps2G4 -matFile=matIsoEps2.txt -go=og


********************************
********   Tues May 12, 2020

+++++  Gaussian plane wave 2D

G4 EPS=2
cgmx -noplot dielectricBodies -g=blockGride4.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=gp -kx=1 -x0=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=blockGPWEps2G4 -eps1=2 -go=go >! blockGPWEps2G4.out

G4 EPS=1
cgmx -noplot dielectricBodies -g=blockGride4.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=gp -kx=1 -x0=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=blockGPWEps1G4 -eps1=1 -go=go >! blockGPWEps1G4.out


G2 EPS=2
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=gp -kx=1 -x0=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=blockGPWEps2G2 -eps1=2 -go=go >! blockGPWEps2G2.out

G2 EPS=1
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=gp -kx=1 -x0=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=blockGPWEps1G2 -eps1=1 -go=go >! blockGPWEps1G2.out


********************************
********   Mon May 11, 2020

START ON 3D


TMz Polarization  -az=1   a = (0,0,1) 
cgmx -noplot dielectricBodies -g=blockGrid3de2.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -az=1 -xb=-2 -rbc=abcEM2 -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=block3dp2Eps1G2 -eps1=1 -go=og



TRY PML ** TROUBLE *****
cgmx -noplot dielectricBodies -g=blockGrid3de2.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=2 -rbc=abcPML -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=block3dEps2G2 -eps1=2 -go=og



TRY PML 
cgmx -noplot dielectricBodies -g=blockGrid3de2.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=abcPML -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=block3dEps1G2 -eps1=1 -go=og



EPS=2: G4
cgmx -noplot dielectricBodies -g=blockGrid3de4.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=abcEM2 -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=block3dEps2G4 -eps1=2 -go=og


EPS=1: G2
cgmx -noplot dielectricBodies -g=blockGrid3de2.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=abcEM2 -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=block3dEps1G2 -eps1=1 -go=og

go >! block3dEps1G2.out



********************************
********   Sat/Sun May 9/10, 2020

START ON 3D

EPS=1: G2
cgmx -noplot dielectricBodies -g=blockGrid3de2.order2.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-1.5 -rbc=abcEM2 -background=OuterSquare -xLeftProbe=-1 -xRightProbe=1 -dm=none -probeFrequency=1 -probeFileName=block3dEps1G2 -eps1=1 -go=og

go >! block3dEps1G2.out





Integrate eps=4 longer

EPS=4 G8
cgmx -noplot dielectricBodies -g=blockGride8.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps4G8 -eps1=4 -go=go >! blockEps4G8.out

EPS=4 G4
cgmx -noplot dielectricBodies -g=blockGride4.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps4G4 -eps1=4 -go=go >! blockEps4G4.out


EPS=4 G2
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps3G2 -eps1=3 -go=go >! blockEps3G2.out


EPS=3 G8
cgmx -noplot dielectricBodies -g=blockGride8.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps3G8 -eps1=3 -go=go >! blockEps3G8.out

EPS=3 G4
cgmx -noplot dielectricBodies -g=blockGride4.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps3G4 -eps1=3 -go=go >! blockEps4G3.out


EPS=3 G2
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps3G2 -eps1=3 -go=go >! blockEps4G3.out



EPS=2 G8
cgmx -noplot dielectricBodies -g=blockGride8.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps2G8 -eps1=2 -go=go >! blockEps2G8.out

EPS=2 G4
cgmx -noplot dielectricBodies -g=blockGride4.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps2G4 -eps1=2 -go=go >! blockEps2G4.out


EPS=2 G2
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps2G2 -eps1=2 -go=go >! blockEps2G2.out


EPS=1 G8 
cgmx -noplot dielectricBodies -g=blockGride8.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps1G8 -eps1=1 -go=go >! blockEps1G8.out

EPS=1 G4
cgmx -noplot dielectricBodies -g=blockGride4.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps1G4 -eps1=1 -go=go >! blockEps1G4.out

EPS=1: G2
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=30 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps1G2 -eps1=1 -go=go >! blockEps1G2.out



********************************
********   Sat May 9, 2020


EPS=2 G2
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps2G2 -eps1=2 -go=go >! blockEps2.out


cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps1G2 -eps1=1 -go=go >! blockEps1.out




********************************
********   Fri May 8, 2020


EPS=1:  kx=.5
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=pw -kx=.5 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1.7 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps1 -eps1=1 -go=go >! blockEps1.out



EPS=1:  move probe 
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-1.7 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps1 -eps1=1 -go=go >! blockEps1.out


EPS=1: 
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=20 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-2 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFrequency=1 -probeFileName=blockEps1 -eps1=1 -go=go >! blockEps1.out



********************************
********   May 4-5, 2020


GET SOME PROBE DATA FOR TESTING SPECTRAL ANALYSIS

PLANE WAVE eps=2
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=100 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFileName=blockEps2 -eps1=2 -go=go >! blockEps2.out

Incident field only 
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=100 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFileName=blockEps1 -eps1=1 -go=go >! blockEps1.out

Incident field -- start everywhere 
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=100 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=-1 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFileName=blockEps1 -eps1=1 -go=go >! blockEps1.out


Incident field only 
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=1 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -xb=5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFileName=blockEps1 -eps1=1 -go=go >! blockEps1.out




PLANE WAVE eps=4
cgmx -noplot dielectricBodies -g=blockGride2.order4.ng3.hdf -tf=100 -tp=1 -useSosupDissipation=1 -ic=pw -kx=1 -x0=-2.5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=none -probeFileName=blockEps4 -eps1=4 -go=go >! blockEps4.out


PLANE WAVE 
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de2.order4.ng3.hdf -tf=120 -useSosupDissipation=1 -ic=pw -kx=1 -x0=-2.5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=gdm -probeFileName=GDMBlockNpv2Eps2a03o1a1p1op2b02o2b11op5 -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og


Gaussian plane wave:
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de2.order4.ng3.hdf -tf=120 -useSosupDissipation=1 -ic=gp -beta=40 -x0=-2.5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2 -xRightProbe=2 -dm=gdm -probeFileName=GDMBlockNpv2Eps2a03o1a1p1op2b02o2b11op5 -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og




********************************
********  Sat Feb 22, 2020

START FIGURES FOR BAGDM PAPER 

HIT BODY WITH GAUSSIAN -- starting outside 

L=[-2,2]
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=5 -tp=.5 -probeFileName="" -xar=-5 -xbr=-4 -xat=4 -xbt=5 -ic=gp -x0=-3 -beta=50  -show=ellGL4gp.show -go=go > ellGL4gp.out



********************************
********  Sun Feb 16, 2020

START ON OBLIQUE INCIDENCE

ARRAY OF BODIES
ogen -noplot embeddedBodyArrayGrid -numBodies=3 -shape=ellipse -prefix=ellipseEmbeddedBodyArrayGrid -xa=-5. -xb=5. -per=0 -interp=e -factor=4

ogen -noplot embeddedBodyArrayGrid -numBodies=2 -shape=ellipse -prefix=ellipseEmbeddedBodyArrayGrid -xa=-5. -xb=5. -per=0 -interp=e -factor=4



THREE ELLIPSES
cgmx -noplot embeddedBodies -g=ellipseEmbeddedBodyArrayGrid3Bodiese4.order2.hdf -numBodies=3 -tf=8 -tp=.5 -useSosupDissipation=1 -ic=gp -kx=2 -ky=1 -beta=40 -x0=-2.5 -rbc=abcPML -background=OuterSquare -xLeftProbe=-1. -xRightProbe=1. -probeFileName=ThreeEllipsee -eps1=2 -show=ellipseThreeAngle45.show -go=go

TWO ELLIPSES
cgmx -noplot embeddedBodies -g=ellipseEmbeddedBodyArrayGrid2Bodiese4.order2.hdf -numBodies=2 -tf=8 -tp=.5 -useSosupDissipation=1 -ic=gp -kx=2 -ky=1 -beta=40 -x0=-2.5 -rbc=abcPML -background=OuterSquare -xLeftProbe=-1. -xRightProbe=1. -probeFileName=TwoEllipsee -eps1=2 -show=ellipseTwoAngle45.show -go=go


ONE ELLIPSE
cgmx -noplot embeddedBodies -g=ellipseEmbeddedBodyGride4.order2.hdf -numBodies=1 -tf=8 -tp=.5 -useSosupDissipation=1 -ic=gp -kx=2 -ky=1 -beta=40 -x0=-2.5 -rbc=abcPML -background=OuterSquare -xLeftProbe=-1. -xRightProbe=1. -probeFileName=OneEllipse -eps1=2  -show=ellipseOneAngle45.show -go=go




-- ADD REFINEMENT WHERE WE PUT AN INTEGRAL PROBE
ogen -noplot embeddedBodyGrid -shape=ellipse -prefix=ellipseEmbeddedBodyGrid -xa=-5. -xb=5. -per=0 -interp=e -factor=4


cgmx -noplot embeddedBodies -g=ellipseEmbeddedBodyGride4.order2.hdf -tf=20 -tp=.2 -useSosupDissipation=1 -ic=gp -kx=2 -ky=1 -beta=40 -x0=-1.5 -rbc=abcPML -background=OuterSquare -xLeftProbe=-1. -xRightProbe=1. -probeFileName=myProbe -eps1=2 -go=og


********************************
********  Fri Jan 31, 2020

START ON OBLIQUE INCIDENCE

ELLIPSE WITYH PML on all sides

cgmx -noplot dielectricBodies -g=ellipticalGridne4.order2.hdf -tf=20 -useSosupDissipation=1 -ic=gp -kx=2 -ky=1 -beta=40 -x0=-1.5 -rbc=abcPML -background=OuterSquare -xLeftProbe=-1.5 -xRightProbe=1.5 -dm=gdm -probeFileName=myProbe -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og

cgmx -noplot dielectricBodies -g=ellipticalGridne4.order2.hdf -tf=120 -useSosupDissipation=1 -ic=gp -beta=40 -x0=-2 -rbc=abcPML -background=OuterSquare -xLeftProbe=-1.5 -xRightProbe=1.5 -dm=gdm -probeFileName=myProbe -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og



cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de2.order4.ng3.hdf -tf=120 -useSosupDissipation=1 -ic=gp -beta=40 -x0=-2.5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2. -xRightProbe=2. -dm=gdm -probeFileName=GDMBlockNpv2Eps2a03o1a1p1op2b02o2b11op5 -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og


********************************
********  Tue Jan 14, 2020

FIX BUG with integral probe, add option to average integral by area.

cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de2.order4.ng3.hdf -tf=120 -useSosupDissipation=1 -ic=gp -beta=40 -x0=-2.5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2. -xRightProbe=2. -dm=gdm -probeFileName=GDMBlockNpv2Eps2a03o1a1p1op2b02o2b11op5 -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og

********************************
********  Tue Jan 14, 2020

check integral probe -- Derek's bug with number of components ?


Gaussian pulse -- start outside domain ? 
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de2.order4.ng3.hdf -tf=120 -useSosupDissipation=1 -ic=gp -beta=40 -x0=-3.5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2. -xRightProbe=2. -dm=gdm -probeFileName=GDMBlockNpv2Eps2a03o1a1p1op2b02o2b11op5 -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og


cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de2.order4.ng3.hdf -tf=120 -useSosupDissipation=1 -ic=gp -beta=40 -x0=-2.5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-2. -xRightProbe=2. -dm=gdm -probeFileName=GDMBlockNpv2Eps2a03o1a1p1op2b02o2b11op5 -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og


************************************
*** Mon Dec 9, 2019

TEST for Derek: from Brett
ogen -noplot dielectricBlockGrid2d -order=4 -numGhost=3 -interp=e -factor=6
ogen -noplot dielectricBlockGrid2d -order=4 -numGhost=3 -interp=e -factor=2


cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de2.order4.ng3.hdf -tf=120 -useSosupDissipation=1 -ic=gp -beta=40 -x0=-2.5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-4.5 -xRightProbe=4.5 -dm=gdm -probeFileName=GDMBlockNpv2Eps2a03o1a1p1op2b02o2b11op5 -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og

cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de6.order4.ng3.hdf -tf=120 -useSosupDissipation=1 -ic=gp -beta=40 -x0=-2.5 -rbc=rbcNonLocal -background=OuterSquare -xLeftProbe=-4.5 -xRightProbe=4.5 -dm=gdm -probeFileName=GDMBlockNpv2Eps2a03o1a1p1op2b02o2b11op5 -eps1=2 -npv=2 -a01=3.0 1.0 -a11=0.1 0.2  -b01=2.0 2.0 -b11=1.0 0.5 -go=og


**************************************
******* Thurs Nov 28, 2019




**************************************
******* Nov 27, 2019

RECREATE waveCurve.h  (lost in disk crash)


Order=2 -eps=.25

nohup $cgmx -noplot dielectricBodies -g=waveyDiskGride128.order4.ng3.hdf -eps1=4 -eps2=1 -ic=gp -x0=-1.5 -beta=500 -rbc=rbcNonLocal -useSosupDissipation=1 -tp=.1 -tf=5. -probeFrequency=1000 -flushFrequency=2 -show=waveyDiskc.show -go=go >!  waveyDiskc.out &

OK
cgmx -noplot dielectricBodies -g=waveyDiskGride64.order2.hdf -eps1=4 -eps2=1 -ic=gp -x0=-1.5 -beta=500 -rbc=rbcNonLocal -useSosupDissipation=1 -tp=.1 -tf=5. -probeFrequency=1000 -flushFrequency=2 -show=waveyDiskb.show -go=go >! waveyDiskb.out &


ogen -noplot shapedDiskGrid -shape=waveyCurve.h -prefix=waveyDiskGrid -interp=e -numGhost=3 -order=4 -factor=128

ogen -noplot shapedDiskGrid -shape=waveyCurve.h -prefix=waveyDiskGrid -interp=e -order=2 -factor=128
ogen -noplot shapedDiskGrid -shape=waveyCurve.h -prefix=waveyDiskGrid -interp=e -order=2 -factor=64
ogen -noplot shapedDiskGrid -shape=waveyCurve.h -prefix=waveyDiskGrid -interp=e -order=2 -factor=32


**************************************
******* Sun Oct 27, 2019


ogen -noplot shapedDiskGrid -shape=starFish -prefix=starFishGrid -interp=e -numGhost=3 -order=4 -factor=128


nohup $cgmx -noplot dielectricBodies -g=starFishGride128.order4.ng3.hdf -eps1=4 -eps2=1 -ic=gp -x0=-1.5 -beta=500 -rbc=rbcNonLocal -useSosupDissipation=1 -tp=.1 -tf=5. -probeFrequency=1000 -flushFrequency=2 -show=starFishb.show -go=go >! starFishb.out &


==== Oct 26, 2019 

ogen -noplot shapedDiskGrid -shape=waveyCurve.h -prefix=waveyDiskGrid -interp=e -numGhost=3 -order=4 -factor=128

ogen -noplot shapedDiskGrid -shape=waveyCurve.h -prefix=waveyDiskGrid -interp=e -order=2 -factor=128
ogen -noplot shapedDiskGrid -shape=waveyCurve.h -prefix=waveyDiskGrid -interp=e -order=2 -factor=64
ogen -noplot shapedDiskGrid -shape=waveyCurve.h -prefix=waveyDiskGrid -interp=e -order=2 -factor=32

TO-DO: order=4, change eps1
nohup $cgmx -noplot dielectricBodies -g=waveyDiskGride128.order4.ng3 -eps1=4 -eps2=1 -ic=gp -x0=-1.5 -beta=500 -rbc=rbcNonLocal -useSosupDissipation=1 -tp=.1 -tf=5. -probeFrequency=1000 -flushFrequency=2 -show=waveyDiska.show -go=go >! waveyDiska.out &


Order=2 -eps=.25 OK -- killed
nohup $cgmx -noplot dielectricBodies -g=waveyDiskGride128.order2.hdf -eps1=.25 -eps2=1 -ic=gp -x0=-1.5 -beta=500 -rbc=rbcNonLocal -useSosupDissipation=1 -tp=.1 -tf=5. -probeFrequency=1000 -flushFrequency=2 -show=waveyDisk.show -go=go >! waveyDisk.out &



nohup $cgmx -noplot dielectricBodies -g=starFishGride128.order2.hdf -eps1=4 -eps2=1 -ic=gp -x0=-1.5 -beta=500 -rbc=rbcNonLocal -useSosupDissipation=1 -tp=.1 -tf=5. -probeFrequency=1000 -flushFrequency=2 -show=starFisha.show -go=go >! starFisha.out &






==== Oct 25, 2019 

POSSIBLE FANCY SHAPES 

ogen -noplot shapedDiskGrid -shape=waveyCurve.h -prefix=waveyGrid -interp=e -order=2 -factor=32


ogen -noplot shapedDiskGrid -shape=starFish -prefix=starFishGrid -interp=e -order=2 -factor=64
ogen -noplot shapedDiskGrid -shape=starFish -prefix=starFishGrid -interp=e -order=2 -factor=128

ogen -noplot shapedDiskGrid -shape=starFish -prefix=starFishGrid -interp=e -order=4 -factor=128


RED-DO STAR-FISH  with SOSUP 

G64 -- ok for a while : bad ghost points? 
nohup $cgmx -noplot dielectricBodies -g=starFishGride64.order2.hdf -eps1=4 -eps2=1 -ic=gp -x0=-1.5 -beta=500 -rbc=rbcNonLocal -useSosupDissipation=1 -tp=.1 -tf=5. -probeFrequency=100 -flushFrequency=2 -show=starFish.show -go=go >! starFish.out &



**************************************
******* April 28, 2019

START on reading GDM fits from gdmOpt.m

alias trdmf /home/henshw/cg.g/mx/bin/trdmf

trdmf -file=GoldJCDispersionFits.txt

trdmf -file=SilverJCDispersionFits.txt


cgmx dielectricBodies -g=dielectricBlockGrid2de4.order4 -dm=gdm -dmFile=GoldJCDispersionFits.txt -backGround=leftBackGround -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=0 -tf=.05 -tp=.05 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1 -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-1. -beta=50. -go=og




**************************************
******* April 18, 2019

** CHECK PROBE FILE -- multiple t=0 enty

cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de4.order4 -backGround=leftBackGround -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=0 -tf=.05 -tp=.05 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1 -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-1. -beta=50. -go=go >! junk




**********************


cgmx dielectricBodies -g=IBeamGride8.order2.hdf -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1 -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-1. -beta=50. -go=halt



**************************************
******* Jan 29, 2019


REVIST REFLECTION/TRANSMISSION from a BLOCK


DIELECTRIC BLOCK EPS=8 
cgmx dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -show="dieBlockG8Eps8b.show" -probeFileName=probeDieBlockG8Eps8b -go=halt


GDM BLOCK
cgmx dielectricBodies -g=dielectricBlockGrid2de4.order4.ng3 -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=leftBackGround -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=15 -tp=.1 -go=halt


SOSUP: *NOTE* Ex is not-zero here(?)
cgmx dielectricBodies -g=dielectricBlockGrid2de4.order4.ng3 -backGround=leftBackGround -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=15 -tp=.1 -go=halt

Single BLOCK -- 
cgmx dielectricBodies -g=dielectricBlockGrid2de4.order4 -backGround=leftBackGround -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -go=halt


**************************************
******* Jan 22, 2019

RE-RUN STANDARD PLANE WAVE  -- longer wavelength


L=20 
cgmx -noplot dielectricBodies -g=ellipticalGridL20Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.25 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=20 -tp=.5 -xLeftProbe=-1.9 -yLeftProbe=.0 -xRightProbe=1.9  -yRightProbe=.0 -show=ellipseL20A30G8kx0p25.show -go=go >! ellipseL20A30G8kx0p25.out 

L=10 
cgmx -noplot dielectricBodies -g=ellipticalGridL10Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.25 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=20 -tp=.5 -xLeftProbe=-1.9 -yLeftProbe=.0 -xRightProbe=1.9  -yRightProbe=.0 -show=ellipseL10A30G8kx0p25.show -go=go >! ellipseL10A30G8kx0p25.out 


L=4 
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.25 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=20 -tp=.5 -xLeftProbe=-1.9 -yLeftProbe=.0 -xRightProbe=1.9  -yRightProbe=.0 -show=ellipseL4A30G8kx0p25.show -go=go >! ellipseL4A30G8kx0p25.out



cgmx -noplot dielectricBodies -g=ellipticalGridL20Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.25 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=20 -tp=.5 -xLeftProbe=-1.9 -yLeftProbe=.0 -xRightProbe=1.9  -yRightProbe=.0 -show=ellipseL20A30G8.show -go=go >! ellipseL20A30G8.out 

**************************************
******* Jan 21, 2019

Run for a movie L10 
cgmx -noplot dielectricBodies -g=ellipticalGridL10Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=20 -tp=.02 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -show=ellipseL10A30G8movie.show -go=go >! ellipseL10A30G8movie.out

++++++++++++++++++++++ SECOND ORDER ++++++++++++++++++++++++++

PML41: COMPARE L10 TO LONG G8 increase pmlLines 
cgmx -noplot dielectricBodies -g=ellipticalGridL10Angle30e4.order2.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -pmlLines=41 -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL10G4PML41Order2vL20G8.show -go=go >! ellL10G4PML41Order2vL20G8.out


PML: COMPARE L4 SHORT G4 TO LONG G8
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e4.order2.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL4G4PMLOrder2vL20G8.show -go=go >! ellL4G4PMLOrder2vL20G8.out 


NLBC: COMPARE VERY SHORT G4 TO LONG G8
cgmx -noplot dielectricBodies -g=ellipticalGridL2Angle30e4.order2.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL2G4NLOrder2vL20G8.show -go=go >! ellL2G4NLOrder2vL20G8.out

NLBC: COMPARE L4 SHORT G4 TO LONG G8
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e4.order2.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL4G4NLOrder2vL20G8.show -go=go >! ellL4G4NLOrder2vL20G8.out


++++++++++++++++++++++ FOURTH ORDER ++++++++++++++++++++++++++

PML81: COMPARE L10 TO LONG G8 increase pmlLines 
cgmx -noplot dielectricBodies -g=ellipticalGridL10Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -pmlLines=81 -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL10G4PM81LvL20G8.show -go=go >! ellL10G4PM81LvL20G8.out 


PML41: COMPARE L10 TO LONG G8 increase pmlLines 
cgmx -noplot dielectricBodies -g=ellipticalGridL10Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -pmlLines=41 -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL10G4PML41vL20G8.show -go=go >! ellL10G4PML41vL20G8.out 

PML41: COMPARE L4 SHORT G4 TO LONG G8
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -pmlLines=41 -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL4G4PML41vL20G8.show -go=go >! ellL4G4PML41vL20G8.out 



PML: COMPARE L10 TO LONG G8
cgmx -noplot dielectricBodies -g=ellipticalGridL10Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL10G4PMLvL20G8.show -go=go >! ellL10G4PMLvL20G8.out 

PML: COMPARE L4 SHORT G4 TO LONG G8
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL4G4PMLvL20G8.show -go=go >! ellL4G4PMLvL20G8.out 


PML: COMPARE VERY SHORT G4 TO LONG G8 -- *trouble* at late times
cgmx -noplot dielectricBodies -g=ellipticalGridL2Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL2G4PMLvL20G8.show -go=go >! ellL2G4PMLvL20G8.out 

NLBC: COMPARE L4 SHORT G4 TO LONG G8
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL4G4NLvL20G8.show -go=go >! ellL4G4NLvL20G8.out 

NLBC: COMPARE VERY SHORT G4 TO LONG G8
cgmx -noplot dielectricBodies -g=ellipticalGridL2Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show -show=ellL2G4NLvL20G8.show -go=go >! ellL2G4NLvL20G8.out 


LONG domain G8  -- run to t=50 
cgmx -noplot dielectricBodies -g=ellipticalGridL20Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=50 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -show=ellipseL20A30G8.show -go=go >! ellipseL20A30G8.out


**************************************
******* Jan 18-19, 2019

>>>>>>>>>> TEST PML AND GAUSSIAN PULSE staring outside the domain 

TEST "compare to show file"
"reference show file:

short domain - compare


PML 
COMPARE PML TO LONG G8
cgmx dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show



COMPARE VERY SHORT TO LONG G8
cgmx dielectricBodies -g=ellipticalGridL2Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show


COMPARE TO LONG
cgmx dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show

LONG domain G4 
cgmx -noplot dielectricBodies -g=ellipticalGridL20Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=5. -tp=.1 -xLeftProbe=-1.9 -yLeftProbe=.0 -xRightProbe=1.9  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -show=ellipseL20A30G4.show -go=go >! ellipseL20A30G4.out


COMPARE TO LONG G8
cgmx dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL20A30G8.show

COMPARE TO SHORT G8
cgmx dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -compareToShowFile=ellipseL4A30G8.show

Short domain G8 
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -show=ellipseL4A30G8.show -go=go >! ellipseL4A30G8.out

Short domain G4 
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -show=ellipseL4A30G4.show -go=go >! ellipseL4A30G4.out

LONG domain G8 
cgmx -noplot dielectricBodies -g=ellipticalGridL20Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -show=ellipseL20A30G8.show -go=go >! ellipseL20A30G8.out


LONG domain
cgmx -noplot dielectricBodies -g=ellipticalGridL20Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=5. -tp=.1 -xLeftProbe=-1.9 -yLeftProbe=.0 -xRightProbe=1.9  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -show=ellipseL20A30G8.show -go=go >! ellipseL20A30G8.out


+++++++++++++++++++BODY +++++++++++++++++++

PML
cgmx dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=abcPML -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. 

RBC
cgmx dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. 

++++++++++++++++++++++++++++++ SQUARE DOMAIN ++++++++++++++++++++++++++++++++++++++++
RBC:
cgmx gaussianPlaneWave -g=square128np.order4 -dm=none -backGround=square -rbc=rbcNonLocal -kx=1 -eps1=1 -useSosupDissipation=0 -tf=2.5 -tp=.1 -ic=gp -x0=-1 -beta=50 -go=halt

PML 
cgmx gaussianPlaneWave -g=square128np.order4 -dm=none -backGround=square -rbc=abcPML -kx=1 -eps1=1 -useSosupDissipation=0 -tf=2.5 -tp=.1 -ic=gp -x0=-1 -beta=50 -go=halt

PML: 
cgmx gaussianPlaneWave -g=square80np.order2 -dm=none -backGround=square -rbc=abcPML -kx=1 -eps1=1 -useSosupDissipation=0 -tf=20 -tp=.1 -ic=gp -x0=-1 -beta=50 -go=halt


cgmx gaussianPlaneWave -g=square80np.order2 -dm=none -backGround=square -rbc=rbcNonLocal -kx=1 -eps1=1 -useSosupDissipation=0 -tf=20 -tp=.1 -ic=gp -x0=-1 -beta=50 -go=halt

**************************************
******* Jan 16-17, 2019

HIT BODY WITH GAUSSIAN -- starting outside 



L=[-2,2]
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50. -show=ellGL4gp.show -go=go >! ellGL4gp.out 

L=[-5,5]
cgmx -noplot dielectricBodies -g=ellipticalGridAngle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -ic=gp -x0=-3. -beta=50.  -show=ellGL10gp.show -go=go >! ellGL10gp.out 


>>>>>>>>>> TEST gaussian pulse staring outside the domain 

cgmx gaussianPlaneWave -g=square128np.order4 -dm=none -backGround=square -rbc=rbcNonLocal -kx=1 -eps1=1 -useSosupDissipation=0 -tf=20 -tp=.1 -ic=gp -x0=-1 -beta=50 -go=halt

cgmx gaussianPlaneWave -g=square80np.order2 -dm=none -backGround=square -rbc=rbcNonLocal -kx=1 -eps1=1 -useSosupDissipation=1 -tf=20 -tp=.1 -ic=gp -x0=-1 -beta=50 -go=halt

**************************************
******* Jan 9, 2019

REVISIT Scattering from bodies -- ADD GDM AND SOSUP AND FAR-FIELD

FD44-GDM -- ellipse rotated by 30 degrees

Long domain 
cgmx -noplot dielectricBodies -g=ellipticalGridL20Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=20 -tp=.5 -xLeftProbe=-1.9 -yLeftProbe=.0 -xRightProbe=1.9  -yRightProbe=.0 -show=ellipseL20A30G8.show -go=go >! ellipseL20A30G8.out 

Short-domain  L4 : [-2,2]
G8 -OK 
cgmx -noplot dielectricBodies -g=ellipticalGridL4Angle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.5 -xLeftProbe=-1.9 -yLeftProbe=.0 -xRightProbe=1.9  -yRightProbe=.0 -show=ellipseL4A30G8.show -go=go >! ellipseL4A30G8.out 

G8 -OK 
cgmx -noplot dielectricBodies -g=ellipticalGridAngle30e8.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=10 -tp=.5 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -show=ellipseL10A30G8.show -go=go >! ellipseL10A30G8.out 

G4  - OK 
cgmx dielectricBodies -g=ellipticalGridAngle30e4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5.

FD22-GDM -- 
cgmx dielectricBodies -g=ellipticalGride4.order2.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5.



**************************************
******* Jan 9, 2019

REVISIT Scattering from bodies -- ADD GDM AND SOSUP AND FAR-FIELD


**** 2D DISK in a long channel

ADD GDM DISK 

FD44-GDM -- OK 
cgmx dielectricBodies -g=diskInBoxYpe4.order4.ng3.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -useSosupDissipation=1 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5.

FD22-GDM -- OK 
cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -dm=gdm -npv=1 -a01=1 -a11=.1 -b01=1 -b11=.2 -backGround=outerSquare -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. 


FD44s : SOSUP -OK 
cgmx dielectricBodies -g=diskInBoxYpe4.order4.ng3.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -useSosupDissipation=1 -diss=0 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5.


FD22s : SOSUP OK
cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -useSosupDissipation=1 -diss=0 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5.

FD22 OK
cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. 


**************************************
******* Nov 6, 2018


==== START TESTS OF GDM BODIES ******

--- NOTE: using Tom's RBC here 

+++++++++++++++++++++++= GDM  +++++++++++++++++++++


+++++++++++++++++++++++= Dielectric bodies  +++++++++++++++++++++

cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. 

--- sosup-diss: 
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -diss=0. -useSosupDissipation=1 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -xb=-2 -go=og

**************************************
******* March 3, 2017

TEST SOSUP DISSIPATION -- START SIMPLER

PROBLEM FOUND -- wrong options in cmd file 


ADD SOSUP DISSIPATION  -- WORKS NOW!
cgmx -noplot dielectricBodies -g=IBeamGride8.order2.hdf -eps1=4 -eps2=1. -kx=.5 -diss=0. -useSosupDissipation=1 -tp=.5 -tf=20 -rbc=abcEM2 -go=og

DISK- SD *trouble ** Why? --> OK NOW FIXED SOSUP DISS PARAMETERS!
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -diss=0. -useSosupDissipation=1 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -xb=-2 -go=og

DISK - AD = OK
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -diss=4. -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -xb=-2 -go=og

**************************************
******* March 2, 2017

ADD SOSUP DISSIPATION *trouble*
cgmx -noplot dielectricBodies -g=IBeamGride8.order2.hdf -eps1=4 -eps2=1. -kx=.5 -diss=0. -useSosupDissipation=1 -tp=.01 -tf=10 -rbc=abcEM2 -go=og

cgmx -noplot dielectricBodies -g=IBeamGride16.order4.ng3.hdf -eps1=4 -eps2=1. -kx=.5 -diss=0. -useSosupDissipation=1 -tp=.01 -tf=10 -rbc=abcEM2 -go=og


TEST  - OK
cgmx -noplot dielectricBodies -g=IBeamGride8.order2.hdf -eps1=4 -eps2=1. -kx=.5 -diss=1. -tp=.01 -tf=10 -rbc=abcEM2 -go=og

ORDER=2 TROUBLE --> fixed ( etrap P in interface 3d was done even when non-dispersive)
cgmx -noplot dielectricBodies -g=ellipticalGride4.order2.hdf -eps1=4 -eps2=1. -kx=.25 -diss=8. -tp=.01 -tf=10 -rbc=rbcNonLocal -go=og

cgmx -noplot dielectricBodies -g=ellipticalGride8.order4.hdf -eps1=4 -eps2=1. -kx=.25 -diss=8. -tp=.01 -tf=10 -rbc=rbcNonLocal -go=og


START on 2D I-BEAM grid 

ogen -noplot shapedDiskGrid -shape=IBeam -prefix=IBeamGrid -interp=e -order=2 -factor=8
ogen -noplot shapedDiskGrid -shape=IBeam -prefix=IBeamGrid -interp=e -order=2 -factor=16

**************************************
******* Sept 28, 2017

REDO runs for 6 month review -- larger wavelength

cgmx -noplot dielectricBodies -g=ellipticalGride8.order4.hdf -eps1=4 -eps2=1. -kx=.25 -diss=8. -tp=.5 -tf=10 -rbc=rbcNonLocal -show=ellipse8kx0p25.show -go=go >! ellipse8kx0p25.out


cgmx -noplot dielectricBodies -g=ellipticalGride16.order4.hdf -eps1=4 -eps2=1. -kx=.5 -diss=8. -tp=.5 -tf=10 -rbc=rbcNonLocal -show=ellipse16kx0p5.show -go=go >! ellipse16kx0p5.out

cgmx -noplot dielectricBodies -g=ellipticalGride8.order4.hdf -eps1=4 -eps2=1. -kx=.5 -diss=8. -tp=.5 -tf=10 -rbc=rbcNonLocal -show=ellipse8kx0p5.show -go=go >! ellipse8kx0p5.out


cgmx -noplot dielectricBodies -g=rodGrid2de16.order4.hdf -eps1=4 -eps2=1. -kx=.25 -diss=8. -tp=.5 -tf=10 -rbc=rbcNonLocal -show=rod16kx0p25.show -go=go >! rod16kx0p25.out

cgmx -noplot dielectricBodies -g=rodGrid2de16.order4.hdf -eps1=4 -eps2=1. -kx=.5 -diss=8. -tp=.5 -tf=10 -rbc=rbcNonLocal -show=rod16kx0p5.show -go=go >! rod16kx0p5.out

cgmx -noplot dielectricBodies -g=crossGridi16.order4.hdf -eps1=4 -eps2=1. -kx=.25 -diss=8. -tp=.5 -tf=10 -rbc=rbcNonLocal -show=cross16kx0p25.show -go=go >! cross16kx0p25.out

cgmx -noplot dielectricBodies -g=crossGridi16.order4.hdf -eps1=4 -eps2=1. -kx=.5 -diss=8. -tp=.5 -tf=10 -rbc=rbcNonLocal -show=cross16kx0p5.show -go=go >! cross16kx0p5.out

**************************************
******* Sept 18, 2017

FIX reflection probe for kx!=1 -- incidentAmplitude may be off

Single BLOCK -- 
cgmx dielectricBodies -g=dielectricBlockGrid2de4.order4 -backGround=leftBackGround -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -go=halt

**************************************
******* Sept 15, 2017

CURVED DIELECTRIC BLOCK 

"convex" lens: 
cgmx -noplot dielectricBodies -g=convexBlockGride4.order4 -backGround=leftBackGround -rbc=rbcNonLocal -kx=2 -eps1=4 -eps2=1. -diss=2 -tf=15 -tp=.1 -xb=-1. -go=og


cgmx -noplot dielectricBodies -g=convexBlockGride4.order4 -backGround=leftBackGround -rbc=rbcNonLocal -kx=4 -eps1=4 -eps2=1. -diss=2 -tf=15 -tp=.1 -xb=-1. -go=og


cgmx -noplot dielectricBodies -g=curvedBlockGrid2de4.order4 -backGround=leftBackGround -rbc=rbcNonLocal -kx=4 -eps1=4 -eps2=1. -diss=2 -tf=15 -tp=.1 -go=og

cgmx -noplot dielectricBodies -g=curvedBlockGrid2de4.order2 -backGround=leftBackGround -rbc=rbcNonLocal -kx=2 -eps1=4 -eps2=1. -diss=2 -tf=15 -tp=.1 -go=og


**************************************
******* Sept 1, 2017

START ON dimensioning grid functions to account for VARYING number of polarization vectors 

ONE BLOCK: GDM
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -dm=gdm -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -go=og

TEST TWO BLOCK
cgmx -noplot dielectricBodies -g=dielectricMultiBlockGrid2d2Blockse4.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -numBlocks=2 -eps1=2 -eps2=4 -diss=2 -tf=15 -tp=.1 -show="dieTwoBlockG8Eps2Eps4.show" -probeFileName=ProbeDieTwoBlockG8Eps2Eps4 -go=go > dieTwoBlockG8Eps2Eps4.out

**************************************
******* Aug 31, 2017

RESURRECT TOM's exact RBC


DISK: kx=.25
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=.25 -eps1=8 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -xb=-2 -show="DibG4Eps8K0p25.show" -probeFileName=probeDibG4Eps8K0p25 -go=go >! DibG4Eps8K0p25.out 

DISK: kx=.5
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=.5 -eps1=8 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -xb=-2 -show="DibG4Eps8K0p5.show" -probeFileName=probeDibG4Eps8K0p5 -go=go >! DibG4Eps8K0p5.out 

DISK -- middle frequency kx=1
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -show="DibG4Eps8K1.show" -probeFileName=probeDibG4Eps8K1 -go=go >! DibG4Eps8K1.out 

DISK -- high frequency kx=4
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=rbcNonLocal -kx=4 -eps1=8 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -show="DibG4Eps8K4.show" -probeFileName=probeDibG4Eps8K4 -go=go >! DibG4Eps8K4.out 

Single BLOCK -- LOOKS OK:
cgmx dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=rbcNonLocal -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -go=halt


*********************************
*********** Aug 24, 2017

cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare-rbc=abcEM2 -kx=.25 -eps1=8 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5. -go=halt


*********************************
*********** Aug 24, 2017

Make probe boxes very narrow in x -- approximates integral along a line

EPS=1 
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare-rbc=abcEM2 -kx=1 -eps1=1 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.1 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5.2 -xbr=-5 -xat=5 -xbt=5.2  -show="DibG4Eps1.show" -probeFileName=probeDibG4Eps1 -go=go > diBG41.out


EPS=8  -- thicker strip for least squares average.
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare-rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=30 -tp=.1 -xLeftProbe=-5.2 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5. -xbr=-4 -xat=4 -xbt=5.  -show="DibG4Eps8.show" -probeFileName=probeDibG4Eps8 -go=go > diBG48.out

EPS=8  -- thin strip for least squares average
cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare-rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=20 -tp=.1 -xLeftProbe=-5.1 -yLeftProbe=.0 -xRightProbe=5.1  -yRightProbe=.0 -xar=-5.2 -xbr=-5 -xat=5 -xbt=5.2  -show="DibG4Eps8.show" -probeFileName=probeDibG4Eps8 -go=go > diBG48.out

cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare-rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -xRightProbe=1.6 -yRightProbe=.15 -xar=-2.8 -xbr=-2.8 -xat=2.8 -xbt=2.8  -show="DibG4Eps8.show" -probeFileName=probeDibG4Eps8 -go=halt




*********************************
*********** Aug 23, 2017


Probes are too close to disk --

cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare-rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -xRightProbe=1.6 -yRightProbe=.15 -show="DibG4Eps8.show" -probeFileName=probeDibG4Eps8 -go=go > diBG48.out

cgmx -noplot dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare-rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -show="DibG4Eps8.show" -probeFileName=probeDibG4Eps8 -go=og






TEST NEW LEAST SQUARE PROBES


**FIXED BUG WITH initial conditions

REDO EPS=8 
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -show="dieBlockG8Eps8a.show" -probeFileName=probeDieBlockG8Eps8a -go=go > dieBlockG8Eps8a.out


REDO EPS=8 
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -show="dieBlockG8Eps8.show" -probeFileName=probeDieBlockG8Eps8 -go=go > dieBlockG8Eps8.out


*********************************
*********** Aug 20-22, 2017


TEST USER DEFINED TRANSMISSION PROBE

cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de4.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -go=go 

REDO: 
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -show="dieBlockG8Eps8a.show" -probeFileName=probeDieBlockG8Eps8a -go=go > dieBlockG8Eps8a.out

probe box index range: [60,100] X [0,80] X [0,0] (grid=2)
 a11=1627.73, a12=-23.8053, a22=1693.27, f1=322.79, f2=386.336 det= 2.76e+06 kx=1
 transmission probe: t=6.800e+00, T = (0.201685,0.230996)


*********************************
*********** Aug 20, 2017


START ON USER DEFINED PROBE

cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -kx=4 -eps1=11.9025 -eps2=1. -probeFileName=ProbeDiskInBox -xb=-1 -go=halt

*********************************
*********** Aug 13, 2017

Think about new probes to average over a box

cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de4.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=1 -eps2=1. -diss=2 -tf=15 -tp=.1 -go=og 


*********************************
*********** Aug 9 -- 


TEST PEC CYLINDER


PML -- TODO
cgmx -noplot dielectricBodies -g=diskInAChannelGride4.order4 -backGround=backGround -bcBody=pec -rbc=abcPML -pmlLines=51 -pmlStrength=40 -kx=1 -eps1=4 -diss=2 -tf=15 -tp=.1 -show=pecDiskG4Eps4pml.show -probeFileName=ProbePecDiskG4Eps4pml -go=go > pecDiskG4Eps4pml.out


REFERENCE RUN IN Cannel with no disk
cgmx -noplot dielectricBodies -g=noPecDisk4np.order4 -backGround=rectangle -rbc=abcEM2 -kx=1 -eps1=4 -diss=2 -tf=25 -tp=.1 -show=noPecDisk4np.show -probeFileName=ProbeNoPecDisk4np -go=go > noPecDisk4np.out

PEC DISK
cgmx -noplot dielectricBodies -g=diskInAChannelGride4.order4 -backGround=backGround -bcBody=pec -rbc=abcEM2 -kx=1 -eps1=4 -diss=2 -tf=25 -tp=.1 -show=pecDiskG4Eps4.show -probeFileName=ProbePecDiskG4Eps4 -go=go > pecDiskG4Eps4.out



Grid for a PEC cylinder

ogen -noplot diskInAChannelGrid -interp=e -order=2 -factor=2


try Yee scheme

cgmx dielectricBodies -method=Yee -g=channel2np.order2 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -numBlocks=2 -eps1=2 -eps2=4 -tf=15 -tp=.1 

*********************************
*********** Aug 8 two block runs

TEST TWO BLOCK
cgmx -noplot dielectricBodies -g=dielectricMultiBlockGrid2d2Blockse4.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -numBlocks=2 -eps1=2 -eps2=4 -diss=2 -tf=15 -tp=.1 -show="dieTwoBlockG8Eps2Eps4.show" -probeFileName=ProbeDieTwoBlockG8Eps2Eps4 -go=go > dieTwoBlockG8Eps2Eps4.out

REFERENCE RUN" 
cgmx -noplot dielectricBodies -g=dielectricMultiBlockGrid2d2Blockse4.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -numBlocks=2 -eps1=1 -eps2=1 -diss=2 -tf=15 -tp=.1 -show="dieTwoBlockG8Eps1Eps1.show" -probeFileName=ProbeDieTwoBlockG8Eps1Eps1 -go=go > dieTwoBlockG8Eps1Eps1.out

*********************************
*********** Aug 7, 2017

TEST TWO BLOCK
cgmx dielectricBodies -g=dielectricMultiBlockGrid2d2Blockse2.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -numBlocks=2 -eps1=2 -eps2=4 -diss=2 -tf=15 -tp=.1 



MULTI-BLOCK 

ogen dielectricMultiBlockGrid2d -numBlocks=3 -x1=-1 -x2=-.5 -x3=0 -x4=.5 -order=2 -interp=e -factor=2

ogen dielectricMultiBlockGrid2d -numBlocks=2 -x1=-.5 -x2=.0 -x3=.5 -order=2 -interp=e -factor=2

*********************************
*********** Aug 6, 2017

EPS=1 
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=1 -eps2=1. -diss=2 -tf=15 -tp=.1 -show="dieBlockG8Eps1.show" -probeFileName=probeDieBlockG8Eps1 -go=go > dieBlockG8Eps1.out

REDO EPS=8 
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=15 -tp=.1 -show="dieBlockG8Eps8.show" -probeFileName=probeDieBlockG8Eps8 -go=go > dieBlockG8Eps8.out


*********************************
*********** Aug 6, 2017


cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=4 -eps2=1. -diss=2 -tf=15 -tp=.1 -show="dieBlockG8Eps4.show" -probeFileName=probeDieBlockG8Eps4 -go=go > dieBlockG8Eps4.out


*********************************
*********** Aug 5 , 2017

CONSIDER SIMULATIONS by Derek Olson

Notes to Derek:
    (1) Your airSlab grid is only built to 2nd-order accuracy

-------------------- DIELECTRIC BLOCK

cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=1 -eps1=8 -eps2=1. -diss=2 -tf=10 -tp=.1 -show="dieBlockG8.show" -go=go > dieBlockG8.out



TRY SOSUP DISSIPATION -- order=4 **trouble : increase interface-iterations (?) **TROUBLE NEAR bottom periodic boundary
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4.ng3 -backGround=leftBackGround -rbc=abcEM2 -kx=2 -eps1=8 -eps2=1. -diss=2 -tf=20 -tp=.5 -useSosupDissipation=1 -ii=10 -go=og

TRY SOSUP DISSIPATION -- order=2 OK
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order2 -backGround=leftBackGround -rbc=abcEM2 -kx=2 -eps1=8 -eps2=1. -diss=2 -tf=20 -tp=.5 -useSosupDissipation=1 -go=og

>>> Test dielectric block grid *NOTE* dissipation needed for interface 
cgmx -noplot dielectricBodies -g=dielectricBlockGrid2de8.order4 -backGround=leftBackGround -rbc=abcEM2 -kx=2 -eps1=8 -eps2=1. -diss=2 -tf=20 -tp=.5 -go=og


-------------------------   AIR SLAB: 

>>>>>>>>>> ABC PML: 


cgmx -noplot airSlab -g=airSlabGrid8np.order4.hdf -tf=10 -tp=.5 -xLoc=0 -probeLoc=2 -rbc=abcPML -pmlLines=81 -pmlStrength=40 -go=og -cfl=.7
>>> t=1.00e+01 dt=6.2e-03 max errors:[0.00e+00,6.24e-04,6.24e-04,], max (u):[0.00e+00,5.12e-03,5.12e-03,] (1620 steps)

cgmx -noplot airSlab -g=airSlabGrid4np.order4.hdf -tf=10 -tp=.5 -xLoc=0 -probeLoc=2 -rbc=abcPML -pmlLines=41 -go=og

>>> t=9.50e+00 dt=1.6e-02 max errors:[0.00e+00,2.25e-03,2.25e-03,], max (u):[0.00e+00,1.49e-02,1.49e-02,] (608 steps)

ABC EM2
cgmx airSlab -g=airSlabGrid4np.order4.hdf -tf=10 -tp=.5 -xLoc=0 -probeLoc=2 -go=halt

>>> t=6.50e+00 dt=1.6e-02 max errors:[0.00e+00,1.27e-04,1.27e-04,], max (u):[0.00e+00,1.27e-04,1.27e-04,] (416 steps)




*********************************
*********** June 20, 2017

** Add sosup option **

SOSUP + PML : *BROKEN* --FIX ME--
cgmx dielectricBodies -g=diskInBoxYpe4.order4.ng3.hdf -backGround=outerSquare -method=sosup -xb=-1.25 -rbc=abcPML -kx=4 -eps1=11.9025 -eps2=1. -diss=0 -go=halt

SOSUP : needs extra ghost *WORKS*
cgmx dielectricBodies -g=diskInBoxYpe4.order4.ng3.hdf -backGround=outerSquare -method=sosup -xb=-1.25 -rbc=abcEM2 -kx=4 -eps1=11.9025 -eps2=1. -diss=0 -go=halt 


*********************************
*********** May 18, 2017


Test *NEW* probes

DISK+PML
cgmx dielectricBodies -g=diskInBoxYpe8.order4.hdf -backGround=outerSquare -kx=4 -eps1=11.9025 -eps2=1. -probeFileName=ProbeDiskInBox -xb=-1 -rbc=abcPML -pmlLines=3 -diss=4 -go=halt

cgmx dielectricBodies -g=diskInBoxYpe4.order4.hdf -backGround=outerSquare -kx=4 -eps1=11.9025 -eps2=1. -probeFileName=ProbeDiskInBox -xb=-1 -go=halt

cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -kx=4 -eps1=11.9025 -eps2=1. -probeFileName=ProbeDiskInBox -xb=-1 -go=halt

RECTANGLE: -- no body -- by subtracting this solution, could be used to get scattered field
cgmx dielectricBodies -g=rect8np.order4.hdf -backGround=rectangle -kx=4 -eps1=11.9025 -eps2=1. -probeFileName=ProbeRectangle -xb=-1 -go=halt
cgmx dielectricBodies -g=rect4np.order4.hdf -backGround=rectangle -kx=4 -eps1=11.9025 -eps2=1. -probeFileName=ProbeRectangle -xb=-1 -go=halt

cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -kx=4 -eps1=11.9025 -eps2=1. -go=halt


*********************************
*********** May 16-17, 2017

**TROUBLE WITH FAR-FIELD BC AND BOUNDING BOX INITIAL CONDITIONS ****

---> FIX MADE : adjustForIncident -- clip to IC-Bounding box

ORDER=4 DISK
cgmx dielectricBodies -g=diskInBoxYpe8.order4.hdf -backGround=outerSquare -xb=-1.25 -rbc=abcPML -pmlLines=32 -kx=4 -eps1=11.9025 -eps2=1. -diss=4 -go=halt -pmlStrength=50. -pmlPower=5

OK: 
cgmx dielectricBodies -g=diskInBoxYpe8.order2.hdf -backGround=outerSquare -xb=-1.25 -rbc=abcPML -pmlLines=32 -kx=4 -eps1=11.9025 -eps2=1. -diss=4 -go=halt -pmlStrength=100. -pmlPower=3


cgmx dielectricBodies -g=diskInBoxYpe8.order2.hdf -backGround=outerSquare -xb=-1.25 -rbc=abcPML -pmlLines=16 -kx=4 -eps1=11.9025 -eps2=1. -diss=4 -go=halt


** OK if we turn off adjust box ar enough away ****
cgmx dielectricBodies -g=diskInBoxYpe8.order2.hdf -backGround=outerSquare -rbc=abcPML -pmlLines=8 -kx=4 -eps1=11.9025 -eps2=1. -diss=4 -go=haltdisk

TRY LEFTBC=planeWave and NO IC BB

cgmx dielectricBodies -g=diskInBoxYpe8.order2.hdf -backGround=outerSquare -rbc=abcPML -leftBC=planeWave -pmlLines=32 -kx=4 -eps1=11.9025 -eps2=1. -go=halt


**TROUBLE**
cgmx dielectricBodies -g=diskInBoxYpe8.order2.hdf -backGround=outerSquare -rbc=abcPML -pmlLines=64 -kx=4 -eps1=11.9025 -eps2=1. -go=halt

cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -rbc=abcPML -kx=4 -eps1=11.9025 -eps2=1. -go=h
alt

Test probes -- seems ok

cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -kx=4 -eps1=11.9025 -eps2=1. -go=halt



*********************************
***********May 7, 2017

check PML

=== PIL BOX
cgmx -noplot dielectricBodies -g=solidPillBoxGride6.order2 -bg=backGround -kx=2 -eps1=11.9025 -eps2=1. -diss=5 -show=solidPillBox.show -tf=4. -go=go >! solidPillBox.out 


*** CROSS ****


cgmx dielectricBodies -g=crossGride16.order2.hdf -eps1=11.9025 -eps2=1. -kx=2 -diss=8. -tp=.1 -tf=5 -go=halt


cgmx dielectricBodies -g=crossGridi16.order4.hdf -eps1=11.9025 -eps2=1. -kx=2 -diss=8. -tp=.1 -tf=5 -show=crossG16.show  -go=halt


*********************************
***********May 6, 2017

#  --- cross:
#   ogen -noplot shapedDiskGrid -shape=cross -prefix=crossGrid -interp=e -order=2 -factor=16

cgmx dielectricBodies -g=crossGride16.order2.hdf -eps1=11.9025 -eps2=1. -kx=2 -diss=8. -tp=.1 -tf=5 -go=halt


*** ADDED omega RELAXATION to 2D order=4 ***

***NEW ROD GRID -- USE HYPE ***
*** IMPORTANT : GRID aspect ratio near corner ***


cgmx dielectricBodies -g=rodGrid2de8.order4.hdf -eps1=11.9025 -eps2=1. -kx=2 -diss=8. -tp=.1 -tf=5 -go=halt


cgmx dielectricBodies -g=rodGrid2de16.order4.hdf -eps1=11.9025 -eps2=1. -kx=2 -diss=8. -tp=.1 -tf=5 -go=halt


STILL OSCILLATIONS AT INTERFACE: *WHY*
cgmx dielectricBodies -g=rodGrid2de32.order4.hdf -eps1=11.9025 -eps2=1. -kx=2 -diss=16. -tp=.1 -tf=10 -go=halt


*** FIXED INTERFACE CHECK****

cgmx dielectricBodies -g=solidPillBoxGride6.order2 -bg=backGround -kx=2 -eps1=11.9025 -eps2=1. -diss=5 -show=pillBoxG6.show -go=halt

==== STAR-FISH

MOVIE:
cgmx -noplot dielectricBodies -g=starFishGride128.order2.hdf -kx=8 -eps1=11.9025 -eps2=1. -diss=64 -tp=.01 -tf=5. -show=starFishMovie.show -go=go > starFishMovie.out




cgmx -noplot dielectricBodies -g=starFishGride128.order2.hdf -kx=2 -eps1=11.9025 -eps2=1. -diss=64 -show=starFishG128.show -go=go > starFishG128.out



=== NEW ELLIPSE GRID -- splines ---

OK: 
cgmx dielectricBodies -g=ellipticalGride8.order2.hdf -kx=2 -eps1=11.9025 -eps2=1. -show=ellipseG8.show -go=halt

OK: ORDER=4
cgmx dielectricBodies -g=ellipticalGride8.order4.hdf -kx=2 -eps1=11.9025 -eps2=1. -go=halt


*********************************
***********May 5, 2017

=========== DIELECTRIC PILL-BOX ================

 ogen -noplot solidPillBoxGrid.cmd -interp=e -nrMin=8 -factor=8 
 ogen -noplot solidPillBoxGrid.cmd -interp=e -nrMin=6 -factor=6 
 ogen -noplot solidPillBoxGrid.cmd -interp=e -factor=4 --> cgmx negative vols

cgmx dielectricBodies -g=solidPillBoxGride6.order2 -bg=backGround -kx=1 -eps1=11.9025 -eps2=1. -diss=5 -go=halt

============ DIELECTRIC SPHERE ====
ogen -noplot solidSphereInABox -prefix=dielectricSphereGrid -xa=-3 -xb=3 -ya=-1.5 -yb=1.5 -za=-1.5 -zb=1.5 -outerBC=yzPeriodic -order=2 -interp=e -factor=2 

ogen -noplot solidSphereInABox -prefix=dielectricSphereGrid -xa=-3 -xb=3 -ya=-1.5 -yb=1.5 -za=-1.5 -zb=1.5 -outerBC=yzPeriodic -order=2 -interp=e -factor=4

ogen -noplot solidSphereInABox -prefix=dielectricSphereGrid -xa=-3 -xb=3 -ya=-1.5 -yb=1.5 -za=-1.5 -zb=1.5 -outerBC=yzPeriodic -order=4 -interp=e -nrMin=11 -factor=4

cgmx dielectricBodies -g=dielectricSphereGride4.order4 -bg=outerBox -kx=1 -eps1=11.9025 -eps2=1. -diss=5 -go=halt

cgmx dielectricBodies -g=dielectricSphereGride4.order4 -bg=outerBox -kx=1 -eps1=11.9025 -eps2=1. -diss=5 -go=halt


cgmx dielectricBodies -g=dielectricSphereGride2.order2 -bg=outerBox -kx=2 -eps1=11.9025 -eps2=1. -go=halt

cgmx dielectricBodies -g=dielectricSphereGride4.order2 -bg=outerBox -kx=1 -eps1=11.9025 -eps2=1. -diss=5 -tf=5. -show=sphereG4.show -go=halt

*********************************
***********May 4, 2017

-- RENAME STUFF --

**** 2D ELLIPTICAL GRID ***

ogen -noplot ellipticalDiskGrid -interp=e -factor=8
Circle: OK
ogen -noplot ellipticalDiskGrid -radX=.5 -radY=.5 -interp=e -order=4 -factor=8

ogen -noplot ellipticalDiskGrid -radX=.6 -radY=.4 -interp=e -order=4 -factor=8

TROUBLE AT INTERFACE: 
cgmx -noplot dielectricBodies -g=ellipticalDiskGride16.order4.hdf -kx=4 -eps1=11.9025 -eps2=1. -go=og

OK: 
cgmx dielectricBodies -g=ellipticalDiskGride8.order2.hdf -kx=2 -eps1=11.9025 -eps2=1. -show=ellipseG8.show -go=halt


*** 2D dielectric DISK ****

GRID
ogen -noplot io -prefix=diskInBox -order=2 -interp=e -xa=-2. -xb=2. -ya=-.75 -yb=.75 -outerBC=yPeriodic -factor=4

cgmx dielectricBodies -g=diskInBoxYpe8.order2.hdf -backGround=outerSquare -kx=2 -eps1=11.9025 -eps2=1. -tf=5 -show=diskInBoxG8.show -diss=4 -go=halt


OK:
cgmx dielectricBodies -g=diskInBoxYpe4.order2.hdf -backGround=outerSquare -kx=4 -eps1=11.9025 -eps2=1. -go=halt

ogen -noplot io -prefix=diskInBox -order=4 -interp=e -xa=-2. -xb=2. -ya=-.75 -yb=.75 -outerBC=yPeriodic -factor=4

OK
cgmx dielectricBodies -g=diskInBoxYpe4.order4.hdf -backGround=outerSquare -kx=4 -eps1=11.9025 -eps2=1. -go=halt


************* VERTICAL ROD ********
ogen -noplot rodGrid2d -order=2 -interp=e -factor=8
ogen -noplot rodGrid2d -order=4 -interp=e -factor=16

cgmx dielectricBodies -g=rodGrid2de8.order2.hdf -eps1=11.9025 -eps2=1. -kx=2 -diss=1. -tp=.1 -tf=5 -show=rodG8.show -go=halt
cgmx dielectricBodies -g=rodGrid2de16.order2.hdf -eps1=11.9025 -eps2=1. -kx=2 -diss=1. -tp=.1 -tf=10 -go=halt

TROUBLE: -- ghost cells?
cgmx dielectricBodies -g=rodGrid2de16.order4.hdf -eps1=11.9025 -eps2=1. -kx=4 -diss=5. -tp=.1 -tf=10 -go=halt

*********************************
***********May 2, 2017

# Run: 
#     glass  n=1.5 -> eps1= (1.5)^2 
#   cgmx rod2d -g=rodGride8.order2.hdf -eps1=2.25 -eps2=1. -kx=5 -diss=1. -tp=.1 -tf=10 -go=halt
#     silicon  n=3.45 -> eps1= (3.45)^2 =11.9025
#   cgmx rod2d -g=rodGride8.order2.hdf -eps1=11.9025 -eps2=1. -kx=2 -diss=1. -tp=.1 -tf=10 -go=halt



*********************************
***********May 2, 2017

2D version -- rod grid 

# Grid:
#   ogen -noplot rodGrid2d -order=2 -interp=e -factor=8 
# Run: 
cgmx rod2d -g=rodGride8.order2.hdf -eps1=2.25 -eps2=1. -kx=5 -diss=1. -tp=.1 -tf=10 -go=halt


ogen -noplot rodGrid2d -order=2 -interp=e -factor=2

*********************************
***********May 2, 2017

Start on a dielectric pill box

ogen pillInABoxGrid.cmd -interp=e -thickness=.33333 -factor=2 