
*********************************************
*************** Sat March 20,  2021

START ON MULA


+++++ E36 
ogen -noplot solidEllipsoidArrayGrid -prefix=36SolidEllipsoidsGrid -nsx=3 -nsy=3 -nsz=4 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -rFactor=.65 -nrExtra=3 -orthographicPatchParameter=.7 -factor=4

mpirun -np 8 $cgmx -noplot mxScript $cgmx -noplot mxScript -g=36SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numBodies=36 -dm=gdm -nm=mla -materialFile=ellipsoidMlaMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.5 -ic=gp -x0=-3 -beta=120 -flushFrequency=4 -extraCommandsEnd=plotSpheres.h -show=36MlaEllipsoids.show -go=go > 36MlaEllipsoids.out



TRY PARALLEL -- looks ok
mpirun -np 4 $cgmx -noplot mxScript $cgmx -noplot mxScript -g=eightSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numBodies=8 -dm=gdm -nm=mla -materialFile=ellipsoidMlaMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.5 -ic=gp -x0=-1.75 -beta=120 -flushFrequency=4 -extraCommandsEnd=plotSpheres.h -go=og


+++++ EIGHT
ORDER=4 -- INTERP=e --> trouble with match-grids --> fails
ogen -noplot solidEllipsoidArrayGrid -prefix=eightSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig8.h -order=4 -per=npp -rFactor=.7 -nrExtra=4 -orthographicPatchParameter=.7 -factor=4 -matchGridsAtInterfaces=1 -interp=e -numGhost=3

ORDER=4 -- INTERP=i 
ogen -noplot solidEllipsoidArrayGrid -prefix=eightSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig8.h -order=4 -per=npp -rFactor=.65 -nrExtra=4 -orthographicPatchParameter=.6 -factor=4 -matchGridsAtInterfaces=1 -interp=i -numGhost=3

Parallel, order=4, implicit interp: looks ok:
mpirun -np 8 $cgmx -noplot mxScript $cgmx -noplot mxScript -g=eightSolidEllipsoidsGridi4.order4.ng3 -domainBaseName=ellipsoid -numBodies=8 -dm=gdm -nm=mla -materialFile=ellipsoidMlaMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.5 -ic=gp -x0=-1.75 -beta=120 -flushFrequency=4 -extraCommandsEnd=plotSpheres.h -go=og

-show=eightMlaEllipsoidsO4.show -go=go > eightMlaEllipsoidsO4.out

ORDER=2
$cgmx -noplot mxScript $cgmx -noplot mxScript -g=eightSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numBodies=8 -dm=gdm -nm=mla -materialFile=ellipsoidMlaMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.5 -ic=gp -x0=-1.75 -beta=120 -flushFrequency=4 -extraCommandsEnd=plotSpheres.h -show=eightMlaEllipsoids.show -go=go > eightMlaEllipsoids.out

Four MLA ellipsoids -- show file for plotting
$cgmx -noplot mxScript $cgmx -noplot mxScript -g=fourSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numBodies=4 -numSpheres=4 -dm=gdm -nm=mla -materialFile=ellipsoidMlaMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.5 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -extraCommandsEnd=plotSpheres.h -show=fourMlaEllipsoids.show -go=go > fourMlaEllipsoids.out




+++++ ONE ELLIPSOID
one MLA ellipsoid -- Looks ok
$cgmx -noplot mxScript $cgmx -noplot mxScript -g=1SolidEllipsoidsGridi2.order2 -domainBaseName=ellipsoid -numBodies=1 -dm=gdm -nm=mla -materialFile=ellipsoidMlaMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.05 -ic=gp -x0=-1.0 -beta=120 -flushFrequency=4 -extraCommandsEnd=plotSpheres.h -go=og

ORDER=4 : interp=e : OK:
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=4 -per=npp -factor=4 -rFactor=.7 -nrExtra=4 -orthographicPatchParameter=.7 -interp=e

ORDER=4 : interp=i
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=4 -per=npp -factor=4 -rFactor=.65 -nrExtra=3 -orthographicPatchParameter=.7 -interp=i

ORDER=2 : 
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4 -rFactor=.65 -nrExtra=3 -orthographicPatchParameter=.7

*********************************************
*************** Fri March 19,  2021

REVISIT ELLIPSOID ARRAY -- fixes to grid-generation


START MXSCRIPT: OK: 

++++++++++++++FOUR ELLIPSOIDS: 

ORDER=4 -- looks OK
cgmx -noplot mxScript $cgmx -noplot mxScript -g=fourSolidEllipsoidsGridi4.order4.ng3 -domainBaseName=ellipsoid -numBodies=4 -numSpheres=4 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.05 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -tallCellRatioBound=1.5 -go=og


ORDER=2
$cgmx -noplot mxScript $cgmx -noplot mxScript -g=fourSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numBodies=4 -numSpheres=4 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.05 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og

++++++++++++++++ONE ELLIPSOID -- 

ORDER=2 
$cgmx -noplot mxScript $cgmx -noplot mxScript -g=1SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numBodies=1 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.05 -ic=gp -x0=-1.0 -beta=120 -flushFrequency=4 -go=og

ONE ELLIPSOID -- ORDER=2 INTERP=i
$cgmx -noplot mxScript $cgmx -noplot mxScript -g=1SolidEllipsoidsGridi2.order2 -domainBaseName=ellipsoid -numBodies=1 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.05 -ic=gp -x0=-1.0 -beta=120 -flushFrequency=4 -go=og


+++++++++ EIGHT

ogen -noplot solidEllipsoidArrayGrid -prefix=eightSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig8.h -order=2 -per=npp -rFactor=.65 -nrExtra=3 -orthographicPatchParameter=.7 -factor=4

 Maximum tall cell ratio=1.29e+00 (tallCellRatioBound=1.3), total bad cells=     0 (  0.0 % of 88212 points).


cgmx -noplot solidSphereArray -g=eightSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=8 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.05 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og


ORIGINAL: 
>>> Cgmx:FD: t=5.00e-02 dt=5.6e-03 TS=ME GDM |div(E)|/|grad(E)|=1.04e-02 (=4.83e-02/4.64e+00) 9 steps mem=792(Mb) cpu=1.81e+01(s)


+++++++++ FOUR ELLIPSOIDS
WE probably need to set orthographicPatchParameter DIFFERENTLY FOR EACH ELLIPSOID

ORDER=4 -- INTERP=i OK
ogen -noplot solidEllipsoidArrayGrid -prefix=fourSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig4.h -order=4 -per=npp -rFactor=.65 -nrExtra=4 -orthographicPatchParameter=.6 -factor=4 -matchGridsAtInterfaces=1 -interp=i -numGhost=3

OPP=.6
Maximum tall cell ratio=1.28e+00 (tallCellRatioBound=1.3), total bad cells=     0 (  0.0 % of 45118 points).

OPP=??
Maximum tall cell ratio=1.39e+00 (tallCellRatioBound=1.3), total bad cells=   168 (  0.4 % of 46410 points).


ORDER=4 -- *trouble with matchGridsAtInterfaces: 
ogen -noplot solidEllipsoidArrayGrid -prefix=fourSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig4.h -order=4 -per=npp -rFactor=.65 -nrExtra=4 -orthographicPatchParameter=.7 -factor=4 -matchGridsAtInterfaces=0

ogen -noplot solidEllipsoidArrayGrid -prefix=fourSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig4.h -order=2 -per=npp -rFactor=.65 -nrExtra=3 -orthographicPatchParameter=.7 -factor=4

cgmx -noplot solidSphereArray -g=fourSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=4 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.05 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og




MXSCRIPT EXAMPLE FROM DIELECTRIC BODIES: 
mpirun -np 4 $cgmx -noplot mxScript -g=fourDiskMLAGridnpe2.order4.ng3.hdf -dm=gdm -nm=mla -numBodies=4 -materialFile=disk4MlaMaterials.h -tf=3 -tp=.2 -useSosupDissipation=1 -ic=gp -kx=1 -ay=1 -az=0 -x0=-2 -rbc=rbcNonLocal -background=backGround -debug=0 -go=og


++++++++++++++  REVISIT GEN GRIDS 

TEST FIX FOR MATCHING GRIDS AT INTERFACES

TURN OFF MAXIMIZE OVERLAP (was default)


ORDER=4: FACTOR=2 INTERP=i : decrease orthographicFactor to improve tall-cell-ratio
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=4 -per=npp -factor=2 -interp=i -rFactor=.65 -nrExtra=4 -matchGridsAtInterfaces=1  -orthographicPatchParameter=.6

ORDER=4: OK: 
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=4 -per=npp -factor=4 -rFactor=.65 -nrExtra=4 -matchGridsAtInterfaces=1  -orthographicPatchParameter=.7

--- GridStatistics::checkForTallCells: CHECK FOR TALL CELLS AT THE INTERFACE--- 
 grid=  1 (side,dir)=(0,2) worst tallCellRatio=1.054e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=ellipsoidOuter1)
 grid=  5 (side,dir)=(0,2) worst tallCellRatio=1.115e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=ellipsoidInner1)
 grid=  2 (side,dir)=(0,2) worst tallCellRatio=1.167e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=southPoleOuter1)
 grid=  6 (side,dir)=(0,2) worst tallCellRatio=1.221e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=southPoleInner1)
 grid=  3 (side,dir)=(0,2) worst tallCellRatio=1.167e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=northPoleOuter1)
 grid=  7 (side,dir)=(0,2) worst tallCellRatio=1.221e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=northPoleInner1)
 Maximum tall cell ratio=1.22e+00 (tallCellRatioBound=1.3), total bad cells=     0 (  0.0 % of 14834 points).

 DEFAULT orthographicPatchParameter: 
--- GridStatistics::checkForTallCells: CHECK FOR TALL CELLS AT THE INTERFACE--- 
 grid=  1 (side,dir)=(0,2) worst tallCellRatio=1.138e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=ellipsoidOuter1)
 grid=  5 (side,dir)=(0,2) worst tallCellRatio=1.200e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=ellipsoidInner1)
 grid=  2 (side,dir)=(0,2) worst tallCellRatio=1.139e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=southPoleOuter1)
 grid=  6 (side,dir)=(0,2) worst tallCellRatio=1.189e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=southPoleInner1)
 grid=  3 (side,dir)=(0,2) worst tallCellRatio=1.139e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=northPoleOuter1)
 grid=  7 (side,dir)=(0,2) worst tallCellRatio=1.189e+00, num bad=    0 (  0.0 % of cells exceed ratio 1.30) (name=northPoleInner1)
 Maximum tall cell ratio=1.20e+00 (tallCellRatioBound=1.3), total bad cells=     0 (  0.0 % of 14374 points).


# grids match, but there are tall cells: -- decrease rFactor  **CHECK ME**
ORDER=2 : 
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4 -rFactor=.65 -nrExtra=3 -orthographicPatchParameter=.7

ORDER=2 FACTOR=2 INTERP=I 
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=2 -interp=i -rFactor=.65 -nrExtra=3 -orthographicPatchParameter=.7


*********************************************
*************** Mon Dec 14,  2020

START ON OPTIMIZING PARALLEL INTERFACE ROUTINES

RUN SERIAL for comparison
$cgmx -noplot solidSphereArray -g=125SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=36 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=.1 -tp=.1 -ic=gp -x0=-3.5 -beta=120 -flushFrequency=4 -go=go > 125SolidEllipsoidsSerial.out



              ---------Maxwell Summary------- 
                       Mon Dec 14 12:43:05 2020
               Grid:   125SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       24, grids=876, gridpts =3.76271e+07, interp pts=4000916, processors=1 ==== 
  ==== memory per-proc: [min=8117.77,ave=8117.77,max=8117.77](Mb), max-recorded=8118.91 (Mb), total=8117.77 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  3.01e+02    1.25e+01    3.33e-07   100.000   3.008e+02   3.008e+02
setup and initialize................  4.03e+01    1.68e+00    4.46e-08    13.396   4.030e+01   4.030e+01
initial conditions..................  1.31e+01    5.46e-01    1.45e-08     4.356   1.310e+01   1.310e+01
advance.............................  2.18e+02    9.09e+00    2.42e-07    72.537   2.182e+02   2.182e+02
  advance rectangular grids.........  2.09e+01    8.72e-01    2.32e-08     6.960   2.093e+01   2.093e+01
  advance curvilinear grids.........  1.10e+02    4.57e+00    1.21e-07    36.468   1.097e+02   1.097e+02
   (advOpt).........................  8.35e+01    3.48e+00    9.24e-08    27.747   8.346e+01   8.346e+01
  boundary conditions...............  7.93e+00    3.30e-01    8.78e-09     2.636   7.929e+00   7.929e+00
  interface bc......................  4.88e+01    2.03e+00    5.40e-08    16.220   4.879e+01   4.879e+01
  interpolation.....................  2.47e+01    1.03e+00    2.73e-08     8.195   2.465e+01   2.465e+01
  update ghost (parallel)...........  2.43e-03    1.01e-04    2.70e-12     0.001   2.435e-03   2.435e-03
  get norms.........................  5.42e-01    2.26e-02    6.00e-10     0.180   5.422e-01   5.422e-01
get divergence......................  1.23e+01    5.12e-01    1.36e-08     4.081   1.228e+01   1.228e+01
compute dt..........................  7.94e+00    3.31e-01    8.79e-09     2.639   7.938e+00   7.938e+00
plotting............................  1.61e+01    6.70e-01    1.78e-08     5.343   1.607e+01   1.607e+01
output results......................  3.48e-02    1.45e-03    3.86e-11     0.012   3.482e-02   3.482e-02
waiting (not counted)...............  5.06e-04    2.11e-05    5.60e-13     0.000   5.060e-04   5.060e-04
--------------------------------------------------------------------------------------------------------

PARALLEL -- np=1:


mpirun -np 1 $cgmx -noplot solidSphereArray -g=125SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=36 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=.1 -tp=.1 -ic=gp -x0=-3.5 -beta=120 -flushFrequency=4 -go=go > 125SolidEllipsoidsNp1.out

              ---------Maxwell Summary------- 
                       Mon Dec 14 13:47:06 2020
               Grid:   125SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       24, grids=876, gridpts =3.76271e+07, interp pts=4000916, processors=1 ==== 
  ==== memory per-proc: [min=15570.5,ave=15570.5,max=15570.5](Mb), max-recorded=13607.4 (Mb), total=15570.5 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  4.02e+02    1.67e+01    4.45e-07   100.000   4.019e+02   4.019e+02
setup and initialize................  5.83e+01    2.43e+00    6.46e-08    14.518   5.834e+01   5.834e+01
initial conditions..................  1.63e+01    6.80e-01    1.81e-08     4.061   1.632e+01   1.632e+01
advance.............................  2.99e+02    1.25e+01    3.32e-07    74.502   2.994e+02   2.994e+02
  advance rectangular grids.........  2.01e+01    8.37e-01    2.23e-08     5.000   2.009e+01   2.009e+01
  advance curvilinear grids.........  1.12e+02    4.69e+00    1.25e-07    27.985   1.125e+02   1.125e+02
   (advOpt).........................  8.32e+01    3.47e+00    9.22e-08    20.711   8.323e+01   8.323e+01
  boundary conditions...............  9.78e+00    4.07e-01    1.08e-08     2.433   9.775e+00   9.775e+00
  interface bc......................  1.16e+02    4.82e+00    1.28e-07    28.785   1.157e+02   1.157e+02
  interpolation.....................  3.72e+01    1.55e+00    4.12e-08     9.260   3.721e+01   3.721e+01
  update ghost (parallel)...........  1.21e-01    5.03e-03    1.34e-10     0.030   1.207e-01   1.207e-01
  get norms.........................  5.84e-01    2.43e-02    6.47e-10     0.145   5.839e-01   5.839e-01
get divergence......................  1.25e+01    5.19e-01    1.38e-08     3.102   1.247e+01   1.247e+01
compute dt..........................  1.15e+01    4.78e-01    1.27e-08     2.855   1.147e+01   1.147e+01
plotting............................  1.79e+01    7.47e-01    1.99e-08     4.462   1.793e+01   1.793e+01
output results......................  4.72e-03    1.97e-04    5.22e-12     0.001   4.717e-03   4.717e-03
waiting (not counted)...............  5.18e-04    2.16e-05    5.73e-13     0.000   5.178e-04   5.178e-04




*********************************************
*************** Sun Dec 13,  2020

++++++++++++++  TRY GEN GRIDS ORDER=4

Set nrMin: G4 nrMin=7 OK 
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -overlapOption=maximize -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4 -nrMin=7

Set nrMin: G6 nrMin=7 OK 
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -overlapOption=maximize -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=6 -nrMin=7

G4, G6 68 - backup 
ogen -noplot solidEllipsoidArrayGrid -prefix=1SolidEllipsoidsGrid -overlapOption=maximize -nsx=1 -nsy=1 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=6 -nrMin=6
 

+++++++++++++ RUNS 

**NOTE: USE setsid to run in a new session -- IN PLACE OF nohup .. NOTE be sure to put in background with "&"

LONGER RUN: 
setsid mpirun -np=4 $cgmx -noplot solidSphereArray -g=125SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=125 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=5 -tp=.5 -ic=gp -x0=-3.5 -beta=120 -flushFrequency=4 -show=125SolidEllipsoids.show -go=go > 125SolidEllipsoids.out &


>>>> RE_RUN TESTS

mpirun -np=16 $cgmx -noplot solidSphereArray -g=125SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=36 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=.1 -tp=.1 -ic=gp -x0=-3.5 -beta=120 -flushFrequency=4 -show=125SolidEllipsoids.show -go=go > 125SolidEllipsoids.out

-np=2 
              ---------Maxwell Summary------- 
                       Sun Dec 13 15:16:59 2020
               Grid:   125SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       24, grids=876, gridpts =3.76271e+07, interp pts=4000916, processors=2 ==== 
  ==== memory per-proc: [min=8398.06,ave=8481.91,max=8565.77](Mb), max-recorded=7595.16 (Mb), total=16963.8 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  2.88e+02    1.20e+01    3.19e-07   100.000   2.878e+02   2.878e+02
setup and initialize................  4.64e+01    1.93e+00    5.14e-08    16.127   4.642e+01   4.642e+01
initial conditions..................  1.36e+01    5.67e-01    1.51e-08     4.724   1.360e+01   1.360e+01
advance.............................  1.98e+02    8.26e+00    2.19e-07    68.843   1.982e+02   1.982e+02
  advance rectangular grids.........  1.26e+01    5.23e-01    1.39e-08     4.361   1.255e+01   1.255e+01
  advance curvilinear grids.........  5.64e+01    2.35e+00    6.25e-08    19.602   5.855e+01   5.429e+01
   (advOpt).........................  4.30e+01    1.79e+00    4.76e-08    14.936   4.299e+01   4.299e+01
  boundary conditions...............  5.82e+00    2.42e-01    6.44e-09     2.021   6.037e+00   5.599e+00
  interface bc......................  9.01e+01    3.75e+00    9.97e-08    31.289   9.006e+01   9.006e+01
  interpolation.....................  3.32e+01    1.38e+00    3.67e-08    11.518   3.315e+01   3.315e+01
  update ghost (parallel)...........  1.61e+00    6.70e-02    1.78e-09     0.559   2.320e+00   8.955e-01
  get norms.........................  7.05e-01    2.94e-02    7.81e-10     0.245   7.055e-01   7.055e-01
get divergence......................  8.48e+00    3.53e-01    9.39e-09     2.944   8.521e+00   8.429e+00
compute dt..........................  1.14e+01    4.76e-01    1.26e-08     3.966   1.142e+01   1.142e+01
plotting............................  7.96e+00    3.32e-01    8.82e-09     2.767   7.965e+00   7.965e+00
showFile............................  1.46e+01    6.09e-01    1.62e-08     5.080   1.463e+01   1.461e+01
output results......................  3.04e-03    1.27e-04    3.36e-12     0.001   4.169e-03   1.908e-03
waiting (not counted)...............  4.37e-04    1.82e-05    4.84e-13     0.000   4.370e-04   4.370e-04
--------------------------------------------------------------------------------------------------------

-np 4 
              ---------Maxwell Summary------- 
                       Sun Dec 13 15:09:38 2020
               Grid:   125SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       24, grids=876, gridpts =3.76271e+07, interp pts=4000916, processors=4 ==== 
  ==== memory per-proc: [min=4588.08,ave=4914.67,max=5765.95](Mb), max-recorded=4952.8 (Mb), total=19658.7 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  2.22e+02    9.26e+00    2.46e-07   100.000   2.222e+02   2.222e+02
setup and initialize................  4.24e+01    1.77e+00    4.69e-08    19.075   4.298e+01   4.174e+01
initial conditions..................  1.30e+01    5.40e-01    1.44e-08     5.834   1.296e+01   1.296e+01
advance.............................  1.43e+02    5.98e+00    1.59e-07    64.551   1.434e+02   1.434e+02
  advance rectangular grids.........  6.24e+00    2.60e-01    6.91e-09     2.808   7.755e+00   4.247e+00
  advance curvilinear grids.........  3.13e+01    1.31e+00    3.47e-08    14.108   3.457e+01   2.755e+01
   (advOpt).........................  2.19e+01    9.13e-01    2.43e-08     9.865   2.211e+01   2.147e+01
  boundary conditions...............  4.12e+00    1.72e-01    4.57e-09     1.856   5.210e+00   2.986e+00
  interface bc......................  7.32e+01    3.05e+00    8.11e-08    32.959   7.407e+01   7.239e+01
  interpolation.....................  2.89e+01    1.20e+00    3.20e-08    13.001   3.094e+01   2.724e+01
  update ghost (parallel)...........  2.62e+00    1.09e-01    2.90e-09     1.178   4.543e+00   6.982e-02
  get norms.........................  6.48e-01    2.70e-02    7.18e-10     0.292   6.483e-01   6.481e-01
get divergence......................  4.92e+00    2.05e-01    5.45e-09     2.215   4.940e+00   4.894e+00
compute dt..........................  1.17e+01    4.86e-01    1.29e-08     5.255   1.168e+01   1.168e+01
plotting............................  4.81e+00    2.00e-01    5.32e-09     2.164   4.809e+00   4.809e+00
showFile............................  1.19e+01    4.96e-01    1.32e-08     5.357   1.198e+01   1.181e+01
output results......................  3.26e-03    1.36e-04    3.61e-12     0.001   3.763e-03   2.096e-03
waiting (not counted)...............  4.47e-04    1.86e-05    4.95e-13     0.000   4.759e-04   3.934e-04

-np=8 
              ---------Maxwell Summary------- 
                       Sun Dec 13 14:54:28 2020
               Grid:   125SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       24, grids=876, gridpts =3.76271e+07, interp pts=4000916, processors=8 ==== 
  ==== memory per-proc: [min=3022.63,ave=3252.46,max=3550.88](Mb), max-recorded=3161.58 (Mb), total=26019.7 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  1.94e+02    8.06e+00    2.14e-07   100.000   1.935e+02   1.935e+02
setup and initialize................  4.25e+01    1.77e+00    4.71e-08    21.975   4.295e+01   4.224e+01
initial conditions..................  1.28e+01    5.34e-01    1.42e-08     6.622   1.281e+01   1.281e+01
advance.............................  1.17e+02    4.87e+00    1.29e-07    60.422   1.170e+02   1.169e+02
  advance rectangular grids.........  3.35e+00    1.39e-01    3.71e-09     1.729   4.389e+00   2.431e+00
  advance curvilinear grids.........  1.77e+01    7.38e-01    1.96e-08     9.151   1.933e+01   1.542e+01
   (advOpt).........................  1.20e+01    4.98e-01    1.32e-08     6.180   1.429e+01   9.019e+00
  boundary conditions...............  3.43e+00    1.43e-01    3.80e-09     1.774   4.057e+00   2.831e+00
  interface bc......................  5.98e+01    2.49e+00    6.62e-08    30.902   6.028e+01   5.917e+01
  interpolation.....................  3.28e+01    1.37e+00    3.63e-08    16.954   3.466e+01   3.014e+01
  update ghost (parallel)...........  1.50e+00    6.24e-02    1.66e-09     0.774   3.070e+00   6.214e-02
  get norms.........................  7.08e-01    2.95e-02    7.84e-10     0.366   7.078e-01   7.071e-01
get divergence......................  3.28e+00    1.37e-01    3.63e-09     1.694   3.384e+00   3.064e+00
compute dt..........................  1.27e+01    5.27e-01    1.40e-08     6.537   1.265e+01   1.265e+01
plotting............................  3.07e+00    1.28e-01    3.40e-09     1.587   3.070e+00   3.070e+00
showFile............................  1.12e+01    4.68e-01    1.25e-08     5.810   1.132e+01   1.117e+01
output results......................  1.72e-02    7.16e-04    1.90e-11     0.009   4.385e-02   1.698e-03
waiting (not counted)...............  4.75e-04    1.98e-05    5.26e-13     0.000   4.969e-04   4.368e-04
--------------------------------------------------------------------------------------------------------

--- np=16
              ---------Maxwell Summary------- 
                       Sun Dec 13 15:01:00 2020
               Grid:   125SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       24, grids=876, gridpts =3.76271e+07, interp pts=4000916, processors=16 ==== 
  ==== memory per-proc: [min=2245.85,ave=2328.48,max=2424.72](Mb), max-recorded=2227.82 (Mb), total=37255.6 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  1.83e+02    7.62e+00    2.03e-07   100.000   1.829e+02   1.829e+02
setup and initialize................  4.32e+01    1.80e+00    4.79e-08    23.637   4.329e+01   4.317e+01
initial conditions..................  1.27e+01    5.27e-01    1.40e-08     6.916   1.265e+01   1.265e+01
advance.............................  1.05e+02    4.38e+00    1.16e-07    57.491   1.052e+02   1.051e+02
  advance rectangular grids.........  1.99e+00    8.29e-02    2.20e-09     1.088   3.394e+00   1.372e+00
  advance curvilinear grids.........  1.06e+01    4.40e-01    1.17e-08     5.773   1.185e+01   9.312e+00
   (advOpt).........................  6.19e+00    2.58e-01    6.86e-09     3.385   7.778e+00   4.565e+00
  boundary conditions...............  3.25e+00    1.36e-01    3.60e-09     1.778   3.648e+00   2.704e+00
  interface bc......................  4.55e+01    1.90e+00    5.04e-08    24.886   4.636e+01   4.436e+01
  interpolation.....................  4.43e+01    1.85e+00    4.91e-08    24.224   4.673e+01   4.279e+01
  update ghost (parallel)...........  1.40e+00    5.83e-02    1.55e-09     0.765   2.170e+00   5.695e-02
  get norms.........................  6.29e-01    2.62e-02    6.97e-10     0.344   6.293e-01   6.288e-01
get divergence......................  1.81e+00    7.52e-02    2.00e-09     0.987   1.895e+00   1.749e+00
compute dt..........................  1.31e+01    5.46e-01    1.45e-08     7.166   1.311e+01   1.311e+01
plotting............................  2.28e+00    9.49e-02    2.52e-09     1.244   2.277e+00   2.277e+00
showFile............................  1.27e+01    5.30e-01    1.41e-08     6.952   1.278e+01   1.265e+01
output results......................  2.29e-03    9.55e-05    2.54e-12     0.001   3.806e-03   1.678e-03
waiting (not counted)...............  4.46e-04    1.86e-05    4.94e-13     0.000   4.561e-04   4.332e-04
--------------------------------------------------------------------------------------------------------


***** QUESTION WHY DOES getDivergence use so much time ???

SIMPLER CASE: serial 
$cgmx -noplot solidSphereArray -g=4SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=4 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=.1 -tp=.1 -ic=gp -x0=-2.5 -beta=120 -flushFrequency=4 -go=go


              ---------Maxwell Summary------- 
                       Sun Dec 13 14:25:18 2020
               Grid:   4SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       14, grids=29, gridpts =1.48417e+06, interp pts=131380, processors=1 ==== 
  ==== memory per-proc: [min=395.535,ave=395.535,max=395.535](Mb), max-recorded=397.363 (Mb), total=395.535 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  1.18e+01    8.44e-01    5.69e-07   100.000   1.182e+01   1.182e+01
setup and initialize................  1.30e+00    9.26e-02    6.24e-08    10.962   1.296e+00   1.296e+00
initial conditions..................  4.22e-01    3.02e-02    2.03e-08     3.573   4.225e-01   4.225e-01
advance.............................  4.28e+00    3.06e-01    2.06e-07    36.180   4.278e+00   4.278e+00
  advance rectangular grids.........  4.77e-01    3.40e-02    2.29e-08     4.031   4.765e-01   4.765e-01
  advance curvilinear grids.........  2.23e+00    1.59e-01    1.07e-07    18.871   2.231e+00   2.231e+00
   (advOpt).........................  2.32e+00    1.65e-01    1.11e-07    19.593   2.316e+00   2.316e+00
  boundary conditions...............  2.59e-01    1.85e-02    1.25e-08     2.189   2.588e-01   2.588e-01
  interface bc......................  8.00e-01    5.72e-02    3.85e-08     6.769   8.003e-01   8.003e-01
  interpolation.....................  3.97e-01    2.84e-02    1.91e-08     3.358   3.970e-01   3.970e-01
  update ghost (parallel)...........  4.90e-05    3.50e-06    2.36e-12     0.000   4.900e-05   4.900e-05
  get norms.........................  2.92e-02    2.09e-03    1.41e-09     0.247   2.920e-02   2.920e-02
get divergence......................  5.25e+00    3.75e-01    2.53e-07    44.444   5.255e+00   5.255e+00
compute dt..........................  2.55e-01    1.82e-02    1.22e-08     2.153   2.545e-01   2.545e-01
plotting............................  5.38e+00    3.84e-01    2.59e-07    45.470   5.376e+00   5.376e+00
output results......................  2.40e-03    1.72e-04    1.16e-10     0.020   2.405e-03   2.405e-03
waiting (not counted)...............  4.12e-04    2.94e-05    1.98e-11     0.003   4.120e-04   4.120e-04
--------------------------------------------------------------------------------------------------------



mpirun -np=4 $cgmx -noplot solidSphereArray -g=36SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=36 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=.1 -tp=.1 -ic=gp -x0=-2.5 -beta=120 -flushFrequency=4 -go=go

+++++ AFTER FIX:  (was being called for each grid!)

              ---------Maxwell Summary------- 
                       Sun Dec 13 14:41:59 2020
               Grid:   36SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       17, grids=253, gridpts =1.13676e+07, interp pts=1153008, processors=4 ==== 
  ==== memory per-proc: [min=1454.29,ave=1555.08,max=1639.14](Mb), max-recorded=1508.61 (Mb), total=6220.33 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  4.65e+01    2.73e+00    2.41e-07   100.000   4.650e+01   4.648e+01
setup and initialize................  1.20e+01    7.06e-01    6.21e-08    25.801   1.202e+01   1.196e+01
initial conditions..................  3.48e+00    2.05e-01    1.80e-08     7.490   3.483e+00   3.482e+00
advance.............................  2.80e+01    1.65e+00    1.45e-07    60.160   2.797e+01   2.796e+01
  advance rectangular grids.........  1.26e+00    7.42e-02    6.53e-09     2.713   1.319e+00   1.213e+00
  advance curvilinear grids.........  6.81e+00    4.00e-01    3.52e-08    14.641   7.173e+00   6.121e+00
   (advOpt).........................  6.65e+00    3.91e-01    3.44e-08    14.298   7.158e+00   5.803e+00
  boundary conditions...............  1.05e+00    6.17e-02    5.42e-09     2.255   1.060e+00   1.028e+00
  interface bc......................  1.51e+01    8.86e-01    7.80e-08    32.407   1.515e+01   1.489e+01
  interpolation.....................  4.32e+00    2.54e-01    2.23e-08     9.284   4.671e+00   3.687e+00
  update ghost (parallel)...........  2.35e-01    1.38e-02    1.22e-09     0.506   2.779e-01   1.821e-01
  get norms.........................  1.72e-01    1.01e-02    8.88e-10     0.369   1.716e-01   1.716e-01
get divergence......................  7.73e-01    4.55e-02    4.00e-09     1.663   7.794e-01   7.653e-01
compute dt..........................  3.41e+00    2.01e-01    1.76e-08     7.333   3.409e+00   3.409e+00
plotting............................  1.27e+00    7.49e-02    6.59e-09     2.739   1.274e+00   1.274e+00
output results......................  2.32e-03    1.36e-04    1.20e-11     0.005   2.823e-03   1.083e-03
waiting (not counted)...............  4.82e-04    2.84e-05    2.50e-12     0.001   4.919e-04   4.721e-04
--------------------------------------------------------------------------------------------------------



++++ WITHOUT computDiv:
              ---------Maxwell Summary------- 
                       Sun Dec 13 14:15:20 2020
               Grid:   36SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       17, grids=253, gridpts =1.13676e+07, interp pts=1153008, processors=4 ==== 
  ==== memory per-proc: [min=1453.26,ave=1594.71,max=1654.2](Mb), max-recorded=1509.15 (Mb), total=6378.84 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  4.66e+01    2.74e+00    2.41e-07   100.000   4.661e+01   4.660e+01
setup and initialize................  1.20e+01    7.04e-01    6.20e-08    25.697   1.200e+01   1.194e+01
initial conditions..................  3.48e+00    2.05e-01    1.80e-08     7.478   3.485e+00   3.485e+00
advance.............................  2.82e+01    1.66e+00    1.46e-07    60.601   2.824e+01   2.823e+01
  advance rectangular grids.........  1.27e+00    7.45e-02    6.55e-09     2.717   1.330e+00   1.215e+00
  advance curvilinear grids.........  6.80e+00    4.00e-01    3.52e-08    14.594   7.191e+00   6.066e+00
   (advOpt).........................  6.66e+00    3.92e-01    3.44e-08    14.283   7.197e+00   5.765e+00
  boundary conditions...............  1.05e+00    6.17e-02    5.43e-09     2.250   1.067e+00   1.026e+00
  interface bc......................  1.53e+01    8.98e-01    7.90e-08    32.748   1.531e+01   1.517e+01
  interpolation.....................  4.36e+00    2.57e-01    2.26e-08     9.360   4.733e+00   3.725e+00
  update ghost (parallel)...........  2.79e-01    1.64e-02    1.45e-09     0.600   3.346e-01   1.915e-01
  get norms.........................  1.71e-01    1.00e-02    8.83e-10     0.366   1.706e-01   1.706e-01
get divergence......................  6.36e-01    3.74e-02    3.29e-09     1.365   6.429e-01   6.257e-01
compute dt..........................  3.39e+00    1.99e-01    1.75e-08     7.269   3.388e+00   3.388e+00
plotting............................  1.42e+00    8.37e-02    7.36e-09     3.052   1.422e+00   1.422e+00
output results......................  2.23e-03    1.31e-04    1.15e-11     0.005   2.687e-03   1.091e-03
waiting (not counted)...............  4.96e-04    2.92e-05    2.57e-12     0.001   5.033e-04   4.814e-04




++++++++  WITH computeDiv
              ---------Maxwell Summary------- 
                       Sun Dec 13 13:57:00 2020
               Grid:   36SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       17, grids=253, gridpts =1.13676e+07, interp pts=1153008, processors=4 ==== 
  ==== memory per-proc: [min=1453.81,ave=1595.18,max=1653.94](Mb), max-recorded=1508.59 (Mb), total=6380.71 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  1.58e+02    9.28e+00    8.16e-07   100.000   1.578e+02   1.577e+02
setup and initialize................  1.19e+01    7.02e-01    6.17e-08     7.565   1.196e+01   1.189e+01
initial conditions..................  3.51e+00    2.07e-01    1.82e-08     2.227   3.513e+00   3.512e+00
advance.............................  2.78e+01    1.64e+00    1.44e-07    17.644   2.784e+01   2.783e+01
  advance rectangular grids.........  1.26e+00    7.39e-02    6.50e-09     0.796   1.323e+00   1.198e+00
  advance curvilinear grids.........  6.78e+00    3.99e-01    3.51e-08     4.296   7.129e+00   6.076e+00
   (advOpt).........................  6.63e+00    3.90e-01    3.43e-08     4.200   7.135e+00   5.766e+00
  boundary conditions...............  1.03e+00    6.09e-02    5.36e-09     0.656   1.048e+00   1.016e+00
  interface bc......................  1.50e+01    8.83e-01    7.77e-08     9.517   1.511e+01   1.485e+01
  interpolation.....................  4.27e+00    2.51e-01    2.21e-08     2.708   4.623e+00   3.704e+00
  update ghost (parallel)...........  2.32e-01    1.36e-02    1.20e-09     0.147   2.669e-01   1.385e-01
  get norms.........................  1.70e-01    9.98e-03    8.78e-10     0.108   1.696e-01   1.696e-01
get divergence......................  1.12e+02    6.60e+00    5.80e-07    71.093   1.122e+02   1.121e+02
compute dt..........................  3.37e+00    1.98e-01    1.74e-08     2.136   3.369e+00   3.369e+00
plotting............................  1.13e+02    6.63e+00    5.83e-07    71.426   1.127e+02   1.127e+02
output results......................  2.28e-03    1.34e-04    1.18e-11     0.001   2.573e-03   1.421e-03
waiting (not counted)...............  5.37e-04    3.16e-05    2.78e-12     0.000   5.460e-04   5.093e-04
--------------------------------------------------------------------------------------------------------







E125 -- 30M pts 
mpirun -np=16 $cgmx -noplot solidSphereArray -g=125SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=36 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=.1 -tp=.1 -ic=gp -x0=-3.5 -beta=120 -flushFrequency=4 -show=125SolidEllipsoids.show -go=go > 125SolidEllipsoids.out 

-- np=16 
              ---------Maxwell Summary------- 
                       Sun Dec 13 12:05:20 2020
               Grid:   125SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       24, grids=876, gridpts =3.76271e+07, interp pts=4000916, processors=16 ==== 
  ==== memory per-proc: [min=2214.98,ave=2312.01,max=2424.72](Mb), max-recorded=2227.29 (Mb), total=36992.2 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  1.35e+03    5.64e+01    1.50e-06   100.000   1.353e+03   1.353e+03
setup and initialize................  4.37e+01    1.82e+00    4.84e-08     3.230   4.376e+01   4.361e+01
initial conditions..................  1.29e+01    5.38e-01    1.43e-08     0.955   1.292e+01   1.292e+01
advance.............................  1.06e+02    4.41e+00    1.17e-07     7.820   1.058e+02   1.058e+02
  advance rectangular grids.........  2.06e+00    8.56e-02    2.28e-09     0.152   3.552e+00   1.373e+00
  advance curvilinear grids.........  1.07e+01    4.44e-01    1.18e-08     0.788   1.215e+01   9.154e+00
   (advOpt).........................  6.34e+00    2.64e-01    7.02e-09     0.469   8.101e+00   4.726e+00
  boundary conditions...............  3.29e+00    1.37e-01    3.64e-09     0.243   3.677e+00   2.677e+00
  interface bc......................  4.60e+01    1.92e+00    5.10e-08     3.402   4.678e+01   4.472e+01
  interpolation.....................  4.44e+01    1.85e+00    4.91e-08     3.281   4.696e+01   4.256e+01
  update ghost (parallel)...........  1.47e+00    6.11e-02    1.62e-09     0.108   2.169e+00   5.798e-02
  get norms.........................  6.82e-01    2.84e-02    7.55e-10     0.050   6.822e-01   6.815e-01
get divergence......................  1.17e+03    4.87e+01    1.29e-06    86.394   1.169e+03   1.169e+03
compute dt..........................  1.33e+01    5.56e-01    1.48e-08     0.987   1.335e+01   1.335e+01
plotting............................  6.55e+02    2.73e+01    7.25e-07    48.422   6.551e+02   6.551e+02
showFile............................  5.29e+02    2.20e+01    5.85e-07    39.064   5.286e+02   5.284e+02
output results......................  2.31e-03    9.63e-05    2.56e-12     0.000   3.908e-03   1.791e-03
waiting (not counted)...............  4.43e-04    1.84e-05    4.90e-13     0.000   4.883e-04   3.266e-04
--------------------------------------------------------------------------------------------------------

-np=16 
              ---------Maxwell Summary------- 
                       Sun Dec 13 10:49:31 2020
               Grid:   125SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       24, grids=876, gridpts =3.76271e+07, interp pts=4000916, processors=8 ==== 
  ==== memory per-proc: [min=2982.85,ave=3274.27,max=3549.92](Mb), max-recorded=3159.13 (Mb), total=26194.1 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  2.09e+03    8.69e+01    2.31e-06   100.000   2.085e+03   2.085e+03
setup and initialize................  4.20e+01    1.75e+00    4.66e-08     2.016   4.248e+01   4.179e+01
initial conditions..................  1.25e+01    5.22e-01    1.39e-08     0.601   1.253e+01   1.252e+01
advance.............................  1.14e+02    4.76e+00    1.26e-07     5.476   1.142e+02   1.142e+02
  advance rectangular grids.........  3.31e+00    1.38e-01    3.67e-09     0.159   4.361e+00   2.428e+00
  advance curvilinear grids.........  1.75e+01    7.28e-01    1.94e-08     0.838   1.915e+01   1.518e+01
   (advOpt).........................  1.18e+01    4.91e-01    1.31e-08     0.566   1.408e+01   8.841e+00
  boundary conditions...............  3.40e+00    1.42e-01    3.76e-09     0.163   4.035e+00   2.724e+00
  interface bc......................  5.85e+01    2.44e+00    6.47e-08     2.804   5.893e+01   5.795e+01
  interpolation.....................  3.19e+01    1.33e+00    3.53e-08     1.528   3.371e+01   2.914e+01
  update ghost (parallel)...........  1.39e+00    5.80e-02    1.54e-09     0.067   2.877e+00   6.015e-02
  get norms.........................  6.31e-01    2.63e-02    6.98e-10     0.030   6.309e-01   6.303e-01
get divergence......................  1.90e+03    7.91e+01    2.10e-06    91.006   1.898e+03   1.898e+03
compute dt..........................  1.24e+01    5.18e-01    1.38e-08     0.596   1.243e+01   1.242e+01
plotting............................  1.10e+03    4.59e+01    1.22e-06    52.776   1.101e+03   1.101e+03
showFile............................  8.09e+02    3.37e+01    8.96e-07    38.782   8.088e+02   8.086e+02
output results......................  3.20e-03    1.33e-04    3.55e-12     0.000   5.626e-03   1.649e-03
waiting (not counted)...............  4.64e-04    1.94e-05    5.14e-13     0.000   4.795e-04   4.404e-04


-np=4 
              ---------Maxwell Summary------- 
                       Sun Dec 13 09:55:32 2020
               Grid:   125SolidEllipsoidsGride4.order2.hdf 
  ==== final time= 1.00e-01, numberOfStepsTaken =       24, grids=876, gridpts =3.76271e+07, interp pts=4000916, processors=4 ==== 
  ==== memory per-proc: [min=4589.57,ave=4916.09,max=5766.01](Mb), max-recorded=4952.61 (Mb), total=19664.4 (Mb)
   Timings:         (ave-sec/proc:)   seconds    sec/step   sec/step/pt     %     [max-s/proc] [min-s/proc]
total time..........................  3.34e+03    1.39e+02    3.70e-06   100.000   3.337e+03   3.337e+03
setup and initialize................  4.33e+01    1.80e+00    4.80e-08     1.298   4.387e+01   4.269e+01
initial conditions..................  1.36e+01    5.68e-01    1.51e-08     0.409   1.364e+01   1.364e+01
advance.............................  1.44e+02    6.02e+00    1.60e-07     4.327   1.444e+02   1.444e+02
  advance rectangular grids.........  6.43e+00    2.68e-01    7.12e-09     0.193   7.862e+00   4.633e+00
  advance curvilinear grids.........  3.16e+01    1.32e+00    3.50e-08     0.946   3.473e+01   2.744e+01
   (advOpt).........................  2.23e+01    9.31e-01    2.47e-08     0.669   2.253e+01   2.199e+01
  boundary conditions...............  4.12e+00    1.72e-01    4.56e-09     0.124   5.230e+00   3.016e+00
  interface bc......................  7.32e+01    3.05e+00    8.10e-08     2.192   7.381e+01   7.212e+01
  interpolation.....................  2.97e+01    1.24e+00    3.29e-08     0.891   3.210e+01   2.792e+01
  update ghost (parallel)...........  2.66e+00    1.11e-01    2.94e-09     0.080   4.604e+00   7.008e-02
  get norms.........................  7.70e-01    3.21e-02    8.52e-10     0.023   7.699e-01   7.697e-01
get divergence......................  3.12e+03    1.30e+02    3.45e-06    93.408   3.117e+03   3.117e+03
compute dt..........................  1.20e+01    5.02e-01    1.33e-08     0.361   1.204e+01   1.204e+01
plotting............................  1.83e+03    7.64e+01    2.03e-06    54.962   1.834e+03   1.834e+03
showFile............................  1.30e+03    5.40e+01    1.43e-06    38.806   1.295e+03   1.295e+03
output results......................  3.38e-03    1.41e-04    3.74e-12     0.000   4.256e-03   1.607e-03
waiting (not counted)...............  5.57e-04    2.32e-05    6.17e-13     0.000   5.636e-04   5.395e-04


E36 - 11M pts OK 
mpirun -np=4 $cgmx -noplot solidSphereArray -g=36SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=36 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=4 -tp=.5 -ic=gp -x0=-2.5 -beta=120 -flushFrequency=4 -show=36SolidEllipsoids.show -go=go > 36SolidEllipsoids.out 






++++++++++++ GRID GEN -- MANY ELLIPSOIDs 


E125 - 30M pts OK 
nohup $ogenx -noplot solidEllipsoidArrayGrid -prefix=125SolidEllipsoidsGrid -overlapOption=maximize -nsx=5 -nsy=5 -nsz=5 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4 > e125.out 


*********************************************
*************** Sat Dec 12,  2020


+++++++++++ TRY GENERAL NUMBER OF ELLIPSOIDS ++++++++++++



E512
ogen -noplot solidEllipsoidArrayGrid -prefix=512SolidEllipsoidsGrid -overlapOption=maximize -nsx=8 -nsy=8 -nsz=8 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4


E343 -- 
ogen -noplot solidEllipsoidArrayGrid -prefix=343SolidEllipsoidsGrid -overlapOption=maximize -nsx=7 -nsy=7 -nsz=7 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4 > e343.out 



E75 - OK 
ogen -noplot solidEllipsoidArrayGrid -prefix=75SolidEllipsoidsGrid -overlapOption=maximize -nsx=3 -nsy=5 -nsz=5 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4


E48 
ogen -noplot solidEllipsoidArrayGrid -prefix=48SolidEllipsoidsGrid -overlapOption=maximize -nsx=3 -nsy=4 -nsz=4 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4

E36 
ogen -noplot solidEllipsoidArrayGrid -prefix=36SolidEllipsoidsGrid -overlapOption=maximize -nsx=3 -nsy=3 -nsz=4 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4

E27 
ogen -noplot solidEllipsoidArrayGrid -prefix=27SolidEllipsoidsGrid -overlapOption=maximize -nsx=3 -nsy=3 -nsz=3 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4

E18 
ogen -noplot solidEllipsoidArrayGrid -prefix=18SolidEllipsoidsGrid -overlapOption=maximize -nsx=3 -nsy=2 -nsz=3 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4

E12 - OK 
ogen -noplot solidEllipsoidArrayGrid -prefix=12SolidEllipsoidsGrid -overlapOption=maximize -nsx=2 -nsy=2 -nsz=3 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4

E4 
ogen -noplot solidEllipsoidArrayGrid -prefix=4SolidEllipsoidsGrid -overlapOption=maximize -nsx=2 -nsy=2 -nsz=1 -configFile=solidEllipsoidArrayConfig3d.h -order=2 -per=npp -factor=4



+++++++ TEST PARALLEL ... OK 

twelve: OK 
mpirun -np=4 $cgmx solidSphereArray -g=12SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=12 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.1 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og



eight: OK np=1,2,4
mpirun -np=4 $cgmx -noplot solidSphereArray -g=fourSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=4 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.1 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og


+++++++++++ TRY TWELVE ELLIPSOIDS ++++++++++++

OK 
cgmx -noplot solidSphereArray -g=12SolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=12 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.1 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og


ogen -noplot solidEllipsoidArrayGrid -prefix=12SolidEllipsoidsGrid -overlapOption=maximize -configFile=solidEllipsoidArrayConfig12.h -order=2 -per=npp -factor=4


+++++++++++ TRY EIGHT ELLIPSOIDS ++++++++++++

Run for SHOW FILE and hard-copies 
cgmx -noplot solidSphereArray -g=eightSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=8 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=3 -tp=.5 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -show=eightSolidEllipsoids.show -go=go >! eightSolidEllipsoids.out 


cgmx -noplot solidSphereArray -g=eightSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=8 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.1 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og

G3 -- negative volumes 
ogen -noplot solidEllipsoidArrayGrid -prefix=eightSolidEllipsoidsGrid -overlapOption=maximize -configFile=solidEllipsoidArrayConfig8.h -order=2 -per=npp -factor=4



*** TO-DO Specify material files in config files



Run for show file
cgmx -noplot solidSphereArray -g=fourSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=4 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=2 -tp=.5 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -show=fourSolidEllipsoids.show -go=go >! fourSolidEllipsoids.out 


works 
cgmx -noplot solidSphereArray -g=fourSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=4 -dm=gdm -materialFile=ellipsoidMaterials.h -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.1 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og 




FOUR ELLIPSOIDS 
ogen -noplot solidEllipsoidArrayGrid -prefix=fourSolidEllipsoidsGrid -overlapOption=maximize -configFile=solidEllipsoidArrayConfig4.h -order=2 -per=npp -factor=4

** smallest cell leads to a dt reduction of about 2.5 
grid     name                gridIndexRange(0:1,0:2)           gridPoints        hmx      hmn  
   0:       backGround   ([ 0:  120],[ 0:  120],[ 0:   60])        893101   2.50e-02 2.50e-02 
   1:  ellipsoidOuter1   ([ 0:  126],[ 0:   44],[ 0:    6])         40005   3.17e-02 1.09e-02

WORKS !
cgmx -noplot solidSphereArray -g=fourSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=4 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.1 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og 



TEST: MAXIMIZE OVERLAP SO MASK's MATCH AT INTERFACE 

WORKS but there are small cells near the pole 

cgmx -noplot solidSphereArray -g=oneSolidEllipsoidsGride3.order2 -domainBaseName=ellipsoid -numSpheres=1 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.1 -ic=gp -x0=-1.0 -beta=120 -flushFrequency=4 -go=og

ogen -noplot solidEllipsoidArrayGrid -prefix=oneSolidEllipsoidsGrid -overlapOption=maximize -configFile=solidEllipsoidArrayConfig1.h -order=2 -per=npp -factor=3 


ogen -noplot solidEllipsoidArrayGrid -prefix=oneSolidEllipsoidsGrid -overlapOption=maximize -configFile=solidEllipsoidArrayConfig1.h -order=2 -per=npp -factor=4 


*********************************************
*************** Dec 10,11  2020


+++ start on CGMX RUN FOR ELLIPSOID

----- ONE ELLIPSOID ----
ogen -noplot solidEllipsoidArrayGrid -prefix=oneSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig1.h -order=2 -per=npp -factor=4 -nrMin=7

cgmx -noplot solidSphereArray -g=oneSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=1 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.01 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og 

Works:
ogen -noplot solidEllipsoidArrayGrid -prefix=oneSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig1.h -order=2 -per=npp -factor=3 -nrMin=7

ogen -noplot solidEllipsoidArrayGrid -prefix=oneSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig1.h -order=2 -per=npp -factor=3 -nrMin=5
cgmx -noplot solidSphereArray -g=oneSolidEllipsoidsGride3.order2 -domainBaseName=ellipsoid -numSpheres=1 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.01 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og 




TROUBLE WITH NOn-MATCHING MASKS ON INTERFACE --
   *** INTERFACE SHARE FLAG NOT CORRECT ***
ogen -noplot solidEllipsoidArrayGrid -prefix=fourSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig4.h -order=2 -per=npp -factor=6

ogen -noplot solidEllipsoidArrayGrid -prefix=fourSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig4.h -order=2 -per=npp -factor=4
ogen -noplot solidEllipsoidArrayGrid -prefix=fourSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig4.h -order=2 -per=npp -factor=4


cgmx -noplot solidSphereArray -g=fourSolidEllipsoidsGride4.order2 -domainBaseName=ellipsoid -numSpheres=4 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10 -tp=.01 -ic=gp -x0=-1.5 -beta=120 -flushFrequency=4 -go=og 




+++++  START ON ARRAY OF ELLIPSOIDS

SEE dielctricBodies/solidEllipsoidInABoxGrid.cmd


USE A CONFIG FILE

ogen -noplot solidEllipsoidArrayGrid -prefix=eightSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig8.h -order=2 -per=npp -factor=3

ogen -noplot solidEllipsoidArrayGrid -prefix=fourSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig4.h -order=2 -per=npp -factor=3

ogen -noplot solidEllipsoidArrayGrid -prefix=threeSolidEllipsoidsGrid -configFile=solidEllipsoidArrayConfig3.h -order=2 -per=npp -factor=3

ogen -noplot solidEllipsoidArrayGrid -prefix=oneSolidEllipsoidGrid -configFile=solidEllipsoidArrayConfig1.h -order=2 -per=npp -factor=3



ONE ellispoid 
ogen -noplot solidEllipsoidArrayGrid -nsx=1 -nsy=1 -nsz=1 -order=2  -a=.4 -b=.45 -c=.5 -per=npp -factor=4 



OK
ogen -noplot solidEllipsoidArrayGrid -order=2 -a=.325 -b=.5 -c=.5 -per=npp -factor=3

OK: 
ogen -noplot solidEllipsoidArrayGrid -order=2 -a=.35 -b=.425 -c=.5 -per=npp -factor=3

OK
ogen -noplot solidEllipsoidArrayGrid -order=2 -a=.4 -b=.45 -c=.5 -per=npp -factor=3

Coarse grid with spherical ellipsoid for testing 
ogen -noplot solidEllipsoidArrayGrid -order=2 -a=.5 -b=.5 -c=.5 -per=npp -factor=2


*********************************************
*************** Aug 21, 2019

--------- 64 SPHERES

RUN FOR MOVIE -- finish me 
cgmx -noplot solidSphereArray -g=64SolidSphereGride2.order2.hdf -numSpheres=64 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10. -tp=.05 -ic=gp -x0=-5.5 -beta=120. -flushFrequency=4 -show=ssa64G2O2.show -go=go >! ssa64G2O2.out 



cgmx -noplot solidSphereArray -g=64SolidSphereGride2.order2.hdf -numSpheres=64 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10. -tp=.1 -ic=gp -x0=-5.5 -beta=120. -go=og



cgmx -noplot solidSphereArray -g=27SolidSphereGride2.order2.hdf -numSpheres=27 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10. -tp=.025 -ic=gp -x0=-4.5 -beta=120. -show=ssa27G2O2m.show -flushFrequency=4 -go=go > ssa27G2O2m.out 


*********************************************
*************** Aug 21, 2019


--------- 64 SPHERES

cgmx -noplot solidSphereArray -g=64SolidSphereGride2.order2.hdf -numSpheres=64 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10. -tp=.1 -ic=gp -x0=-5.5 -beta=120. -go=og

--------- 27 SPHERES
G2 Order2
cgmx -noplot solidSphereArray -g=27SolidSphereGride2.order2.hdf -numSpheres=27 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=5. -tp=.5 -ic=gp -x0=-4.5 -beta=120. -show=ssa27G2O2.show -go=go > ssa27G2O2.out 


*********************************************
*************** Aug 20, 2019

++++++++++++++++++++  COMPILE with -O instead of -O3 --> nan's go away

--------- 64 SPHERES
 4 x 4 x 4 
ogen -noplot solidSphereArrayGrid -prefix=64SolidSphereGrid -xa=-6.5 -xb=5.5 -ya=-5.5 -yb=5.5 -za=-5.5 -zb=5.5 -nsx=4 -nsy=4 -nsz=4 -order=2 -factor=1
ogen -noplot solidSphereArrayGrid -prefix=64SolidSphereGrid -xa=-6.5 -xb=5.5 -ya=-5.5 -yb=5.5 -za=-5.5 -zb=5.5 -nsx=4 -nsy=4 -nsz=4 -interp=e -order=2 -factor=2


--------- 27 SPHERES
 3 x 3 x 3 
ogen -noplot solidSphereArrayGrid -prefix=27SolidSphereGrid -xa=-5.5 -xb=5.5 -ya=-5.5 -yb=5.5 -za=-5.5 -zb=5.5 -nsx=3 -nsy=3 -nsz=3 -order=2 -factor=1
ogen -noplot solidSphereArrayGrid -prefix=27SolidSphereGrid -xa=-5.5 -xb=5.5 -ya=-5.5 -yb=5.5 -za=-5.5 -zb=5.5 -nsx=3 -nsy=3 -nsz=
3 -interp=e -order=2 -factor=2

ogen -noplot solidSphereArrayGrid -prefix=27SolidSphereGrid -xa=-5.5 -xb=5.5 -ya=-5.5 -yb=5.5 -za=-5.5 -zb=5.5 -nsx=3 -nsy=3 -nsz=3 -interp=e -order=4 -factor=2



G2Order2
cgmx -noplot solidSphereArray -g=27SolidSphereGride2.order2.hdf -numSpheres=27 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10. -tp=.1 -ic=gp -x0=-3 -beta=120. -go=og


---------- EIGHT spheres 
G2: Order=4, OK 
cgmx -noplot solidSphereArray -g=eightSolidSphereGride2.order4.ng3.hdf -numSpheres=8 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10. -tp=.1 -ic=gp -x0=-3 -beta=120. -go=og


ONE SPHERE -- 
cgmx -noplot solidSphereArray -g=solidSphereGride2.order4.ng3.hdf -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -useSosupDissipation=1 -tf=10. -tp=.01 -ic=gp -x0=-2 -beta=120. -go=og



valgrindebug $cgmx -noplot solidSphereArray -g=../sphere/solidSphereInABoxe2.order4.ng3 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=0 -tf=10. -tp=.01 -ic=gp -x0=-1.5 -beta=120. -go=halt


compile debug -- no nan's
cgmx -noplot solidSphereArray -g=../sphere/solidSphereInABoxe2.order4.ng3 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=0 -tf=10. -tp=.01 -ic=gp -x0=-1.5 -beta=120. -go=og


*********************************************
*************** Aug 19, 2019


------------ ONE SPHERE -----
TRY THIS GRID: solidSphereInABoxe2.order4.ng3 

GDM:    ***NAN's *** on the interface after 1 step 
cgmx -noplot solidSphereArray -g=../sphere/solidSphereInABoxe2.order4.ng3 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=0 -tf=10. -tp=.01 -ic=gp -x0=-1.5 -beta=120. -go=og

NO GDM - OK 
cgmx -noplot solidSphereArray -g=../sphere/solidSphereInABoxe2.order4.ng3 -dm=none -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=0 -tf=10. -tp=.01 -ic=gp -x0=-1.5 -beta=120. -go=og



*********************************************
*************** Aug 18, 2019


FINISH -rbc=rbcNonLocal

---------- EIGHT spheres 
G2: Order=4, **TROUBLE*** NAN's 
cgmx -noplot solidSphereArray -g=eightSolidSphereGride2.order4.ng3.hdf -numSpheres=8 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10. -tp=.1 -ic=gp -x0=-3 -beta=120. -go=og 


G2: Ok 
cgmx -noplot solidSphereArray -g=eightSolidSphereGride2.order2.hdf -numSpheres=8 -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -eps1=2 -useSosupDissipation=1 -tf=10. -tp=.1 -ic=gp -x0=-3 -beta=120. -go=og 


G1: mask mismatch 


------------ ONE SPHERE -----
TRY THIS GRID: solidSphereInABoxe2.order4.ng3 ***NAN's ***
cgmx -noplot solidSphereArray -g=../sphere/solidSphereInABoxe2.order4.ng3
-dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -useSosupDissipation=0 -tf=10. -tp=.01 -ic=gp -x0=-3 -beta=120. -go=og

NO SOSUP-DISS**TROUBLE*** NAN's 
cgmx -noplot solidSphereArray -g=solidSphereGride2.order4.ng3.hdf -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -useSosupDissipation=0 -tf=10. -tp=.01 -ic=gp -x0=-3 -beta=120. -go=og


G2 order=4  **TROUBLE*** NAN's 
cgmx -noplot solidSphereArray -g=solidSphereGride2.order4.ng3.hdf -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -useSosupDissipation=1 -tf=10. -tp=.01 -ic=gp -x0=-3 -beta=120. -interfaceEquationOption=0 -go=og

G2
cgmx -noplot solidSphereArray -g=solidSphereGride2.order2.hdf -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -useSosupDissipation=1 -tf=10. -tp=.1 -ic=gp -x0=-3 -beta=120. -go=og

G1
cgmx -noplot solidSphereArray -g=solidSphereGride1.order2.hdf -dm=gdm -dmFile=gdmMaterial1.txt gdmMaterial3.txt -backGround=backGround -rbc=abcEM2 -kx=.5 -eps0=1 -useSosupDissipation=1 -tf=10. -tp=.1 -ic=gp -x0=-3 -beta=120. -go=og 


-show=solidsO2G4.show -go=go > solidsO2G4.out 


START on solid sphere array


# One sphere: 
ogen -noplot solidSphereArrayGrid -prefix=solidSphereGrid -xa=-4 -xb=4 -ya=-3 -yb=3 -za=-3 -zb=3 - -nsx=1 -nsy=1 -nsz=1 -interp=e -order=2 -factor=1 
ogen -noplot solidSphereArrayGrid -prefix=solidSphereGrid -xa=-4 -xb=4 -ya=-3 -yb=3 -za=-3 -zb=3 - -nsx=1 -nsy=1 -nsz=1 -interp=e -order=2 -factor=2 

ogen -noplot solidSphereArrayGrid -prefix=solidSphereGrid -xa=-4 -xb=4 -ya=-3 -yb=3 -za=-3 -zb=3 - -nsx=1 -nsy=1 -nsz=1 -interp=e -order=4 -numGhost=3 -factor=2 


------------ GRID; 8 spheres 
#   2 x 2 x 2 = 8 spheres: 
ogen -noplot solidSphereArrayGrid -prefix=eightSolidSphereGrid -xa=-4 -xb=4 -ya=-3 -yb=3 -za=-3 -zb=3 - -nsx=2 -nsy=2 -nsz=2 -interp=e -order=2 -factor=1 

ogen -noplot solidSphereArrayGrid -prefix=eightSolidSphereGrid -xa=-4 -xb=4 -ya=-3 -yb=3 -za=-3 -zb=3 - -nsx=2 -nsy=2 -nsz=2 -interp=e -order=2 -factor=2

ogen -noplot solidSphereArrayGrid -prefix=eightSolidSphereGrid -xa=-4 -xb=4 -ya=-3 -yb=3 -za=-3 -zb=3 - -nsx=2 -nsy=2 -nsz=2 -interp=e -order=4 -numGhost=3 -factor=2

# 
#  3 x 3 x 3 = 27 spheres:

ogen -noplot solidSphereArrayGrid -xa=-5 -nsx=3 -nsy=3 -nsz=3 -order=2 -factor=1

 4 x 4 x 4 
ogen -noplot solidSphereArrayGrid -xa=-5.6 -xb=5 -ya=-5 -yb=5 -za=-5 -zb=5 -nsx=4 -nsy=4 -nsz=4 -order=2 -factor=1 

