// This file automatically generated from SmCylinderExactSolution.bC with bpp.
// ==========================================================================================================
// Class to define exact solutions for CgSm
// 
//   VIBRATIONAL MODES OF A CYLINDER
// 
// ==========================================================================================================


#include "SmCylinderExactSolution.h"

#include "NurbsMapping.h"

#include "PlotStuff.h"
#include "ParallelUtility.h"

#include <complex>

typedef ::real LocalReal;
// typedef ::real OV_real;

typedef std::vector<std::complex<Real> > ComplexVector;

#define FOR_3D(i1,i2,i3,I1,I2,I3)                                       int I1Base =I1.getBase(),   I2Base =I2.getBase(),  I3Base =I3.getBase(); int I1Bound=I1.getBound(),  I2Bound=I2.getBound(), I3Bound=I3.getBound(); for(i3=I3Base; i3<=I3Bound; i3++)                                       for(i2=I2Base; i2<=I2Bound; i2++)                                     for(i1=I1Base; i1<=I1Bound; i1++)



// ===============================================================================
/// \brief  Constructor for th class that defines exact solutions 
// ===============================================================================
SmCylinderExactSolution::
SmCylinderExactSolution()
{

  // dbase.put<int>("numberOfDimensions");
    dbase.put<bool>("initialized")=false;

    dbase.put<Real>("omega") = -1.;

  // dbase.put<Real>("amp")=1.;

  // std::complex<Real> & s  = dbase.put<std::complex<Real> >("s");
  // std::complex<Real> & kx = dbase.put<std::complex<Real> >("kx");

  // ComplexVector & kvyta   = dbase.put<ComplexVector>("kvyt");   // top ky's 
  // ComplexVector & kvyba   = dbase.put<ComplexVector>("kvyb");   // bottom ky's 
  // ComplexVector & qvta    = dbase.put<ComplexVector>("qvt");    // top eigenvectors
  // ComplexVector & qvba    = dbase.put<ComplexVector>("qvb");    // bottom eigenvectors 

    
}


// ===============================================================================
/// \brief destructor 
// ===============================================================================
SmCylinderExactSolution::
~SmCylinderExactSolution()
{
    if( dbase.has_key("nurbs") )
    {
        NurbsMapping *nurbs = dbase.get<NurbsMapping*>("nurbs");
        delete [] nurbs;
    }
    

}


// ===============================================================================
/// \brief Return a solution parameter by name
// ===============================================================================
int SmCylinderExactSolution::
getParameter( const aString & name, Real & value )
{
    if( name=="omega" )
    {
        value = dbase.get<Real>("omega");
    }
    else
    {
        printF("SmCylinderExactSolution::getParameter: ERROR: unknown parameter=[%s]\n",(const char*)name);
    }
    return 0;
}

// ----------------------------------------------------------------
// Evaluate the polar cooridinates from the cartesian coordinates 
// ----------------------------------------------------------------


// ===============================================================================
/// \brief Initialize the exact solution.
// ===============================================================================
int SmCylinderExactSolution::
initialize( CompositeGrid & cg, const aString & caseName )
{
    bool & initialized=dbase.get<bool>("initialized");
    initialized=true;

  // one nurbs each for
  //    ur     (real and im parts), 
  //    uTheta (real and im parts)
  //    uz     (real and im parts)
  //    p      (real and im parts)
    const int numNurbs = 4; 
  // if( !dbase.has_key("nurbs") )
  // {
  //   // Build an array of 4 NurbsMapping's 
  //   dbase.put<NurbsMapping*>("nurbs") = new NurbsMapping [numNurbs];
  // }
  // NurbsMapping *nurbs = dbase.get<NurbsMapping*>("nurbs");
    NurbsMapping *nurbs = new NurbsMapping [numNurbs];

    Real & omega = dbase.get<Real>("omega"); 

    Real ra_=0., rb_=1., za_=0., zb_=1., kz_=1., omega_=1.; 
    int m_=1; 
    if( true )
    {
    // --- this next file defines the radial part of the exact solution, computed with finite differences ---
    //   urRe[] = array of real part of ur
    //   urIm[] = array of imag part of ur
    //   uThetaRe[] = array of real part of uTheta
    //   uThetaIm[] = array of imag part of uTheta

    // Synthetic data for testing:
    // #Include "src/incompressible/cylExactTest.h"

    // >> from $ism/matlab/cylinderDiscreteEigFuncs/hollowCylinderEigFun_t_t.h
    // Traction-traction
    // #Include "src/incompressible/hollowCylinderEigFun_t_t.h"

    // Displacement displacement:
// Radial part of the exact solution
// Elastic vibrational modes of a cylinder (incompressible elasticity)
// File written by saveExactSolutionToIncludeFile.m on 02-Dec-2021 07:33:25
Real omega=  6.79248874915669e+00;
Real ra=  5.00000000000000e-01, rb=  1.00000000000000e+00;
Real za=  0.00000000000000e+00, zb=  1.00000000000000e+00;
int m=1;
Real kz=  6.28318530717959e+00;
int Ng=205, ia=3, ib=203;
Real urRe[]={
  -5.81434113617017e-06, -1.43324379671900e-06,  0.00000000000000e+00, -1.39281523932079e-06, -5.49091267706733e-06,
  -1.21745331449113e-05, -2.13250597360878e-05, -3.28251539938016e-05, -4.65588835093181e-05, -6.24118398590667e-05,
  -8.02712471680742e-05, -1.00026061675405e-04, -1.21567062681327e-04, -1.44786935244297e-04, -1.69580344991167e-04,
  -1.95844005393865e-04, -2.23476737858728e-04, -2.52379524964888e-04, -2.82455557180028e-04, -3.13610273372673e-04,
  -3.45751395430601e-04, -3.78788957286838e-04, -4.12635328644913e-04, -4.47205233685882e-04, -4.82415765031224e-04,
  -5.18186393225844e-04, -5.54438971997010e-04, -5.91097739536217e-04, -6.28089316041594e-04, -6.65342697750487e-04,
  -7.02789247683256e-04, -7.40362683310203e-04, -7.77999061346956e-04, -8.15636759873172e-04, -8.53216457964278e-04,
  -8.90681113015413e-04, -9.27975935932158e-04, -9.65048364352318e-04, -1.00184803405854e-03, -1.03832674873215e-03,
  -1.07443844819413e-03, -1.11013917526975e-03, -1.14538704141060e-03, -1.18014219119783e-03, -1.21436676584651e-03,
  -1.24802486582541e-03, -1.28108251269891e-03, -1.31350761029472e-03, -1.34526990529317e-03, -1.37634094733219e-03,
  -1.40669404871224e-03, -1.43630424378678e-03, -1.46514824811286e-03, -1.49320441743800e-03, -1.52045270659022e-03,
  -1.54687462833804e-03, -1.57245321228003e-03, -1.59717296382229e-03, -1.62101982329730e-03, -1.64398112527341e-03,
  -1.66604555810419e-03, -1.68720312375788e-03, -1.70744509797119e-03, -1.72676399076286e-03, -1.74515350734198e-03,
  -1.76260850944496e-03, -1.77912497712904e-03, -1.79469997105033e-03, -1.80933159525165e-03, -1.82301896048215e-03,
  -1.83576214807063e-03, -1.84756217436928e-03, -1.85842095578600e-03, -1.86834127442098e-03, -1.87732674431704e-03,
  -1.88538177834116e-03, -1.89251155570086e-03, -1.89872199010925e-03, -1.90401969860313e-03, -1.90841197101990e-03,
  -1.91190674014053e-03, -1.91451255249822e-03, -1.91623853985902e-03, -1.91709439137286e-03, -1.91709032639721e-03,
  -1.91623706799194e-03, -1.91454581708399e-03, -1.91202822730100e-03, -1.90869638046884e-03, -1.90456276277186e-03,
  -1.89964024156964e-03, -1.89394204286618e-03, -1.88748172942691e-03, -1.88027317953714e-03, -1.87233056639356e-03,
  -1.86366833812622e-03, -1.85430119844033e-03, -1.84424408787057e-03, -1.83351216564234e-03, -1.82212079213017e-03,
  -1.81008551190295e-03, -1.79742203735212e-03, -1.78414623288937e-03, -1.77027409970534e-03, -1.75582176108486e-03,
  -1.74080544826058e-03, -1.72524148680458e-03, -1.70914628354180e-03, -1.69253631397840e-03, -1.67542811023544e-03,
  -1.65783824947594e-03, -1.63978334281837e-03, -1.62128002472364e-03, -1.60234494284809e-03, -1.58299474835145e-03,
  -1.56324608664968e-03, -1.54311558860337e-03, -1.52261986213335e-03, -1.50177548424824e-03, -1.48059899348401e-03,
  -1.45910688273325e-03, -1.43731559246960e-03, -1.41524150434087e-03, -1.39290093513922e-03, -1.37031013112350e-03,
  -1.34748526269647e-03, -1.32444241941900e-03, -1.30119760536036e-03, -1.27776673476844e-03, -1.25416562805611e-03,
  -1.23041000809498e-03, -1.20651549680321e-03, -1.18249761202857e-03, -1.15837176470620e-03, -1.13415325629654e-03,
  -1.10985727648386e-03, -1.08549890113602e-03, -1.06109309051285e-03, -1.03665468771925e-03, -1.01219841739320e-03,
  -9.87738884622645e-04, -9.63290574085626e-04, -9.38867849404293e-04, -9.14484952708084e-04, -8.90156004398923e-04,
  -8.65895003113458e-04, -8.41715825872240e-04, -8.17632228416589e-04, -7.93657845719231e-04, -7.69806192670184e-04,
  -7.46090664928184e-04, -7.22524539931987e-04, -6.99120978071033e-04, -6.75893024002459e-04, -6.52853608117767e-04,
  -6.30015548149035e-04, -6.07391550909733e-04, -5.84994214171382e-04, -5.62836028663790e-04, -5.40929380198858e-04,
  -5.19286551916545e-04, -4.97919726640898e-04, -4.76840989350361e-04, -4.56062329755798e-04, -4.35595644978229e-04,
  -4.15452742331153e-04, -3.95645342197691e-04, -3.76185080999760e-04, -3.57083514260402e-04, -3.38352119751587e-04,
  -3.20002300726563e-04, -3.02045389234555e-04, -2.84492649513722e-04, -2.67355281460698e-04, -2.50644424173108e-04,
  -2.34371159567212e-04, -2.18546516057000e-04, -2.03181472312417e-04, -1.88286961067592e-04, -1.73873873009763e-04,
  -1.59953060706870e-04, -1.46535342627358e-04, -1.33631507170924e-04, -1.21252316816973e-04, -1.09408512253584e-04,
  -9.81108166452397e-05, -8.73699398577343e-05, -7.71965828351317e-05, -6.76014419242648e-05, -5.85952133437046e-05,
  -5.01885976198868e-05, -4.23923041252868e-05, -3.52170556396630e-05, -2.86735929444717e-05, -2.27726795074069e-05,
  -1.75251061363878e-05, -1.29416957699269e-05, -9.03330821398312e-06, -5.81084500464896e-06, -3.28525425762008e-06,
  -1.46753557728730e-06, -3.68745021436278e-07,  0.00000000000000e+00, -3.72483374930372e-07, -1.49744240572645e-06

};
Real urIm[]={
  -8.94173890433268e-05, -2.20415202969936e-05,  0.00000000000000e+00, -2.14197789923360e-05, -8.44434586073769e-05,
  -1.87229290675118e-04, -3.27953093598812e-04, -5.04810346763461e-04, -7.16018152837698e-04, -9.59817051501669e-04,
  -1.23447268901441e-03, -1.53827734941469e-03, -1.86955135316937e-03, -2.22664432895538e-03, -2.60793636414464e-03,
  -3.01183903944168e-03, -3.43679635297630e-03, -3.88128553905043e-03, -4.34381778656528e-03, -4.82293886205111e-03,
  -5.31722964205629e-03, -5.82530655953269e-03, -6.34582196869551e-03, -6.87746443272150e-03, -7.41895893847416e-03,
  -7.96906704234564e-03, -8.52658695113172e-03, -9.09035354174230e-03, -9.65923832341000e-03, -1.02321493459170e-02,
  -1.08080310572461e-02, -1.13858641139152e-02, -1.19646651471467e-02, -1.25434864878764e-02, -1.31214158535139e-02,
  -1.36975759992142e-02, -1.42711243363402e-02, -1.48412525206482e-02, -1.54071860126486e-02, -1.59681836124575e-02,
  -1.65235369713791e-02, -1.70725700823316e-02, -1.76146387511505e-02, -1.81491300506940e-02, -1.86754617595860e-02,
  -1.91930817873532e-02, -1.97014675875996e-02, -2.02001255608184e-02, -2.06885904482996e-02, -2.11664247185958e-02,
  -2.16332179478332e-02, -2.20885861951878e-02, -2.25321713746697e-02, -2.29636406243959e-02, -2.33826856743668e-02,
  -2.37890222137837e-02, -2.41823892588218e-02, -2.45625485217547e-02, -2.49292837822524e-02, -2.52824002616109e-02,
  -2.56217240006719e-02, -2.59471012420490e-02, -2.62583978173438e-02, -2.65554985398903e-02, -2.68383066035747e-02,
  -2.71067429882462e-02, -2.73607458721472e-02, -2.76002700517975e-02, -2.78252863697157e-02, -2.80357811503224e-02,
  -2.82317556443520e-02, -2.84132254820488e-02, -2.85802201354000e-02, -2.87327823896719e-02, -2.88709678243825e-02,
  -2.89948443039775e-02, -2.91044914782754e-02, -2.92000002928836e-02, -2.92814725096594e-02, -2.93490202373025e-02,
  -2.94027654721921e-02, -2.94428396494574e-02, -2.94693832043876e-02, -2.94825451441487e-02, -2.94824826298424e-02,
  -2.94693605688919e-02, -2.94433512177264e-02, -2.94046337947538e-02, -2.93533941035400e-02, -2.92898241661872e-02,
  -2.92141218668009e-02, -2.91264906049954e-02, -2.90271389593616e-02, -2.89162803607947e-02, -2.87941327755630e-02,
  -2.86609183980714e-02, -2.85168633531547e-02, -2.83621974077922e-02, -2.81971536921571e-02, -2.80219684298470e-02,
  -2.78368806771433e-02, -2.76421320712297e-02, -2.74379665871733e-02, -2.72246303035339e-02, -2.70023711765278e-02,
  -2.67714388224760e-02, -2.65320843085240e-02, -2.62845599513854e-02, -2.60291191240067e-02, -2.57660160700015e-02,
  -2.54955057256728e-02, -2.52178435495168e-02, -2.49332853590080e-02, -2.46420871745489e-02, -2.43445050704222e-02,
  -2.40407950325747e-02, -2.37312128231165e-02, -2.34160138513614e-02, -2.30954530512465e-02, -2.27697847650286e-02,
  -2.24392626330476e-02, -2.21041394894793e-02, -2.17646672638593e-02, -2.14210968882931e-02, -2.10736782102008e-02,
  -2.07226599104024e-02, -2.03682894264905e-02, -2.00108128812909e-02, -1.96504750162886e-02, -1.92875191299092e-02,
  -1.89221870205007e-02, -1.85547189338889e-02, -1.81853535154072e-02, -1.78143277662199e-02, -1.74418770038971e-02,
  -1.70682348270310e-02, -1.66936330838614e-02, -1.63183018447110e-02, -1.59424693782169e-02, -1.55663621311289e-02,
  -1.51902047116714e-02, -1.48142198763146e-02, -1.44386285198300e-02, -1.40636496685932e-02, -1.36895004769507e-02,
  -1.33163962266531e-02, -1.29445503291491e-02, -1.25741743307536e-02, -1.22054779205209e-02, -1.18386689407728e-02,
  -1.14739534002030e-02, -1.11115354894331e-02, -1.07516175990012e-02, -1.03944003396346e-02, -1.00400825647925e-02,
  -9.68886139536750e-03, -9.34093224646916e-03, -8.99648885627023e-03, -8.65572331677288e-03, -8.31882610647954e-03,
  -7.98598612491466e-03, -7.65739072887437e-03, -7.33322577041214e-03, -7.01367563647402e-03, -6.69892329009900e-03,
  -6.38915031319303e-03, -6.08453695077594e-03, -5.78526215665622e-03, -5.49150364051290e-03, -5.20343791630690e-03,
  -4.92124035199945e-03, -4.64508522051874e-03, -4.37514575193767e-03, -4.11159418684653e-03, -3.85460183081263e-03,
  -3.60433911002620e-03, -3.36097562788467e-03, -3.12468022277648e-03, -2.89562102665353e-03, -2.67396552484719e-03,
  -2.45988061645160e-03, -2.25353267615483e-03, -2.05508761623119e-03, -1.86471095032475e-03, -1.68256785695728e-03,
  -1.50882324516561e-03, -1.34364181946316e-03, -1.18718814715563e-03, -1.03962672485943e-03, -9.01122047208009e-04,
  -7.71838675087738e-04, -6.51941305430107e-04, -5.41594841348616e-04, -4.40964462803214e-04, -3.50215698639971e-04,
  -2.69514498165653e-04, -1.99027304810117e-04, -1.38921128984928e-04, -8.93636228595767e-05, -5.05231549351531e-05,
  -2.25688855498990e-05, -5.67084322508063e-06,  0.00000000000000e+00, -5.72833448797538e-06, -2.30288156584389e-05

};
Real uThetaRe[]={
  -3.27929431864953e-02, -1.63566001266865e-02,  0.00000000000000e+00,  1.62637773884536e-02,  3.24222111351981e-02,
    4.84633392383927e-02,  6.43757585978383e-02,  8.01486210300224e-02,  9.57716187390959e-02,  1.11234972084595e-01,
    1.26529417374729e-01,  1.41646194554923e-01,  1.56577034811370e-01,  1.71314148114584e-01,  1.85850210731667e-01,
    2.00178352730566e-01,  2.14292145500336e-01,  2.28185589307825e-01,  2.41853100911341e-01,  2.55289501247354e-01,
    2.68490003208801e-01,  2.81450199529329e-01,  2.94166050787022e-01,  3.06633873541881e-01,  3.18850328615932e-01,
    3.30812409529218e-01,  3.42517431098436e-01,  3.53963018208831e-01,  3.65147094765084e-01,  3.76067872829262e-01,
    3.86723841950059e-01,  3.97113758690270e-01,  4.07236636355064e-01,  4.17091734925937e-01,  4.26678551202505e-01,
    4.35996809155167e-01,  4.45046450490901e-01,  4.53827625432465e-01,  4.62340683713231e-01,  4.70586165786617e-01,
    4.78564794251873e-01,  4.86277465494971e-01,  4.93725241544163e-01,  5.00909342138848e-01,  5.07831137012017e-01,
    5.14492138382046e-01,  5.20893993655718e-01,  5.27038478336752e-01,  5.32927489139636e-01,  5.38563037307275e-01,
    5.43947242127242e-01,  5.49082324646051e-01,  5.53970601577611e-01,  5.58614479404465e-01,  5.63016448664964e-01,
    5.67179078428939e-01,  5.71105010952384e-01,  5.74796956513694e-01,  5.78257688422271e-01,  5.81490038201717e-01,
    5.84496890940626e-01,  5.87281180805708e-01,  5.89845886722382e-01,  5.92194028206043e-01,  5.94328661353134e-01,
    5.96252874980514e-01,  5.97969786912008e-01,  5.99482540409329e-01,  6.00794300742988e-01,  6.01908251899961e-01,
    6.02827593424536e-01,  6.03555537386961e-01,  6.04095305483448e-01,  6.04450126252093e-01,  6.04623232413748e-01,
    6.04617858328848e-01,  6.04437237560940e-01,  6.04084600561512e-01,  6.03563172447652e-01,  6.02876170895400e-01,
    6.02026804126111e-01,  6.01018268991374e-01,  5.99853749155584e-01,  5.98536413365970e-01,  5.97069413813167e-01,
    5.95455884577124e-01,  5.93698940157433e-01,  5.91801674081717e-01,  5.89767157592571e-01,  5.87598438412240e-01,
    5.85298539574689e-01,  5.82870458332305e-01,  5.80317165129591e-01,  5.77641602639571e-01,  5.74846684866289e-01,
    5.71935296308609e-01,  5.68910291177931e-01,  5.65774492676487e-01,  5.62530692333179e-01,  5.59181649382559e-01,
    5.55730090201357e-01,  5.52178707795510e-01,  5.48530161322720e-01,  5.44787075675564e-01,  5.40952041094649e-01,
    5.37027612826141e-01,  5.33016310827699e-01,  5.28920619498683e-01,  5.24742987458318e-01,  5.20485827351581e-01,
    5.16151515693223e-01,  5.11742392742348e-01,  5.07260762402845e-01,  5.02708892164607e-01,  4.98089013060422e-01,
    4.93403319656315e-01,  4.88653970069073e-01,  4.83843085999095e-01,  4.78972752798707e-01,  4.74045019552265e-01,
    4.69061899181496e-01,  4.64025368574391e-01,  4.58937368722479e-01,  4.53799804889832e-01,  4.48614546788127e-01,
    4.43383428770147e-01,  4.38108250046715e-01,  4.32790774904114e-01,  4.27432732945666e-01,  4.22035819345576e-01,
    4.16601695106274e-01,  4.11131987338759e-01,  4.05628289543829e-01,  4.00092161908709e-01,  3.94525131611115e-01,
    3.88928693134270e-01,  3.83304308583187e-01,  3.77653408018516e-01,  3.71977389791142e-01,  3.66277620877688e-01,
    3.60555437239849e-01,  3.54812144166843e-01,  3.49049016639069e-01,  3.43267299689133e-01,  3.37468208768108e-01,
    3.31652930117013e-01,  3.25822621137482e-01,  3.19978410771560e-01,  3.14121399875098e-01,  3.08252661605759e-01,
    3.02373241797712e-01,  2.96484159349174e-01,  2.90586406610426e-01,  2.84680949762723e-01,  2.78768729210999e-01,
    2.72850659967760e-01,  2.66927632038530e-01,  2.61000510814491e-01,  2.55070137447909e-01,  2.49137329250830e-01,
    2.43202880070947e-01,  2.37267560675226e-01,  2.31332119140044e-01,  2.25397281224095e-01,  2.19463750751847e-01,
    2.13532209992680e-01,  2.07603320033239e-01,  2.01677721154873e-01,  1.95756033206019e-01,  1.89838855968793e-01,
    1.83926769530457e-01,  1.78020334643958e-01,  1.72120093096951e-01,  1.66226568062977e-01,  1.60340264470104e-01,
    1.54461669341819e-01,  1.48591252164189e-01,  1.42729465215511e-01,  1.36876743938382e-01,  1.31033507243243e-01,
    1.25200157901986e-01,  1.19377082822405e-01,  1.13564653441880e-01,  1.07763226000886e-01,  1.01973141926278e-01,
    9.61947281013347e-02,  9.04282972251585e-02,  8.46741481193322e-02,  7.89325660135496e-02,  7.32038229271454e-02,
    6.74881778621843e-02,  6.17858772577998e-02,  5.60971551196842e-02,  5.04222334858475e-02,  4.47613225798879e-02,
    3.91146211881489e-02,  3.34823169324899e-02,  2.78645864915484e-02,  2.22615960157768e-02,  1.66735012159484e-02,
    1.11004478811852e-02,  5.54257209016578e-03,  0.00000000000000e+00, -5.52715215255922e-03, -1.10387780510522e-02

};
Real uThetaIm[]={
    2.13235211383923e-03,  1.06358342576755e-03,  0.00000000000000e+00, -1.05754765273494e-03, -2.10824536413279e-03,
  -3.15131530831310e-03, -4.18601600181993e-03, -5.21164204451522e-03, -6.22752317478625e-03, -7.23302347421817e-03,
  -8.22754057378724e-03, -9.21050485337164e-03, -1.01813786356094e-02, -1.11396553759837e-02, -1.20848588507721e-02,
  -1.30165423445256e-02, -1.39342878385907e-02, -1.48377052019735e-02, -1.57264313859244e-02, -1.66001296232528e-02,
  -1.74584886336317e-02, -1.83012218357908e-02, -1.91280665674235e-02, -1.99387833138621e-02, -2.07331549459731e-02,
  -2.15109859682155e-02, -2.22721017772981e-02, -2.30163479320256e-02, -2.37435894348843e-02, -2.44537100256929e-02,
  -2.51466114877724e-02, -2.58222129669565e-02, -2.64804503036802e-02, -2.71212753784511e-02, -2.77446554708046e-02,
  -2.83505726319915e-02, -2.89390230715229e-02, -2.95100165575889e-02, -3.00635758315052e-02, -3.05997360361205e-02,
  -3.11185441582496e-02, -3.16200584851280e-02, -3.21043480748591e-02, -3.25714922406555e-02, -3.30215800490408e-02,
  -3.34547098315921e-02, -3.38709887104880e-02, -3.42705321373631e-02, -3.46534634455502e-02, -3.50199134155750e-02,
  -3.53700198535348e-02, -3.57039271823529e-02, -3.60217860457281e-02, -3.63237529245192e-02, -3.66099897652981e-02,
  -3.68806636211240e-02, -3.71359463039713e-02, -3.73760140489488e-02, -3.76010471897267e-02, -3.78112298453553e-02,
  -3.80067496179315e-02, -3.81877973008253e-02, -3.83545665978519e-02, -3.85072538521695e-02, -3.86460577856037e-02,
  -3.87711792476386e-02, -3.88828209738915e-02, -3.89811873541084e-02, -3.90664842091165e-02, -3.91389185768081e-02,
  -3.91986985066630e-02, -3.92460328626630e-02, -3.92811311347164e-02, -3.93042032576309e-02, -3.93154594381864e-02,
  -3.93151099897935e-02, -3.93033651740204e-02, -3.92804350500900e-02, -3.92465293303563e-02, -3.92018572433227e-02,
  -3.91466274026949e-02, -3.90810476828704e-02, -3.90053251007468e-02, -3.89196657032532e-02, -3.88242744606931e-02,
  -3.87193551657834e-02, -3.86051103379928e-02, -3.84817411330967e-02, -3.83494472578174e-02, -3.82084268894377e-02,
  -3.80588765999190e-02, -3.79009912847692e-02, -3.77349640963206e-02, -3.75609863810871e-02, -3.73792476213799e-02,
  -3.71899353809277e-02, -3.69932352540744e-02, -3.67893308187477e-02, -3.65784035933544e-02, -3.63606329963611e-02,
  -3.61361963096554e-02, -3.59052686452128e-02, -3.56680229140308e-02, -3.54246297990345e-02, -3.51752577299168e-02,
  -3.49200728608419e-02, -3.46592390513494e-02, -3.43929178488513e-02, -3.41212684741266e-02, -3.38444478087537e-02,
  -3.35626103849492e-02, -3.32759083774139e-02, -3.29844915968751e-02, -3.26885074862274e-02, -3.23881011177891e-02,
  -3.20834151925710e-02, -3.17745900415776e-02, -3.14617636277234e-02, -3.11450715505499e-02, -3.08246470511338e-02,
  -3.05006210192110e-02, -3.01731220013417e-02, -2.98422762099767e-02, -2.95082075344237e-02, -2.91710375520930e-02,
  -2.88308855413772e-02, -2.84878684953340e-02, -2.81421011363268e-02, -2.77936959312245e-02, -2.74427631083502e-02,
  -2.70894106738823e-02, -2.67337444302546e-02, -2.63758679944855e-02, -2.60158828172172e-02, -2.56538882028785e-02,
  -2.52899813297242e-02, -2.49242572708010e-02, -2.45568090153922e-02, -2.41877274908270e-02, -2.38171015844929e-02,
  -2.34450181668024e-02, -2.30715621139385e-02, -2.26968163311084e-02, -2.23208617761710e-02, -2.19437774836039e-02,
  -2.15656405882768e-02, -2.11865263500152e-02, -2.08065081779314e-02, -2.04256576548191e-02, -2.00440445625859e-02,
  -1.96617369061756e-02, -1.92788009392324e-02, -1.88953011890967e-02, -1.85113004813356e-02, -1.81268599656268e-02,
  -1.77420391403483e-02, -1.73568958778290e-02, -1.69714864500216e-02, -1.65858655524828e-02, -1.62000863307597e-02,
  -1.58142004046484e-02, -1.54282578929004e-02, -1.50423074391001e-02, -1.46563962355223e-02, -1.42705700480209e-02,
  -1.38848732411410e-02, -1.34993488017864e-02, -1.31140383640007e-02, -1.27289822333955e-02, -1.23442194105705e-02,
  -1.19597876154803e-02, -1.15757233110701e-02, -1.11920617268421e-02, -1.08088368819656e-02, -1.04260816094077e-02,
  -1.00438275775866e-02, -9.66210531471668e-03, -9.28094423021200e-03, -8.90037263844608e-03, -8.52041777898579e-03,
  -8.14110584207778e-03, -7.76246198615274e-03, -7.38451036385132e-03, -7.00727413972895e-03, -6.63077551484525e-03,
  -6.25503574468232e-03, -5.88007516255124e-03, -5.50591319914308e-03, -5.13256840140001e-03, -4.76005845744536e-03,
  -4.38840020870036e-03, -4.01760967978280e-03, -3.64770208696834e-03, -3.27869186814734e-03, -2.91059269299885e-03,
  -2.54341748765752e-03, -2.17717845213553e-03, -1.81188707485100e-03, -1.44755415978639e-03, -1.08418983197641e-03,
  -7.21803571253257e-04, -3.60404226149725e-04,  0.00000000000000e+00,  3.59401548980436e-04,  7.17793507691359e-04

};
Real uzRe[]={
    4.80068735388043e-03,  2.41347896100436e-03,  0.00000000000000e+00, -2.43683774322844e-03, -4.89418694806732e-03,
  -7.36926475919747e-03, -9.85935278315614e-03, -1.23617979093912e-02, -1.48740130579523e-02, -1.73934777959627e-02,
  -1.99177388250034e-02, -2.24444103456514e-02, -2.49711743055441e-02, -2.74957805371868e-02, -3.00160467915038e-02,
  -3.25298586729770e-02, -3.50351694820069e-02, -3.75299999699611e-02, -4.00124380121673e-02, -4.24806382039596e-02,
  -4.49328213846684e-02, -4.73672740942998e-02, -4.97823479674485e-02, -5.21764590688295e-02, -5.45480871746416e-02,
  -5.68957750038060e-02, -5.92181274029680e-02, -6.15138104889767e-02, -6.37815507524239e-02, -6.60201341256366e-02,
  -6.82284050184128e-02, -7.04052653246031e-02, -7.25496734025324e-02, -7.46606430320962e-02, -7.67372423512468e-02,
  -7.87785927744545e-02, -8.07838678955842e-02, -8.27522923775457e-02, -8.46831408309070e-02, -8.65757366835962e-02,
  -8.84294510436658e-02, -9.02437015570159e-02, -9.20179512618557e-02, -9.37517074415781e-02, -9.54445204776518e-02,
  -9.70959827039986e-02, -9.87057272642945e-02, -1.00273426973481e-01, -1.01798793184749e-01, -1.03281574663136e-01,
  -1.04721556466835e-01, -1.06118558837200e-01, -1.07472436098412e-01, -1.08783075567666e-01, -1.10050396476680e-01,
  -1.11274348905279e-01, -1.12454912727742e-01, -1.13592096572530e-01, -1.14685936795990e-01, -1.15736496470536e-01,
  -1.16743864387813e-01, -1.17708154077237e-01, -1.18629502840320e-01, -1.19508070801122e-01, -1.20344039973111e-01,
  -1.21137613342716e-01, -1.21889013969791e-01, -1.22598484105171e-01, -1.23266284325498e-01, -1.23892692685450e-01,
  -1.24478003887421e-01, -1.25022528468807e-01, -1.25526592006852e-01, -1.25990534341163e-01, -1.26414708813798e-01,
  -1.26799481527005e-01, -1.27145230618454e-01, -1.27452345554015e-01, -1.27721226437883e-01, -1.27952283340049e-01,
  -1.28145935640944e-01, -1.28302611393128e-01, -1.28422746699919e-01, -1.28506785110754e-01, -1.28555177033158e-01,
  -1.28568379161113e-01, -1.28546853919642e-01, -1.28491068925439e-01, -1.28401496463266e-01, -1.28278612978016e-01,
  -1.28122898582093e-01, -1.27934836577973e-01, -1.27714912995694e-01, -1.27463616144989e-01, -1.27181436181881e-01,
  -1.26868864689470e-01, -1.26526394272632e-01, -1.26154518166437e-01, -1.25753729857967e-01, -1.25324522721328e-01,
  -1.24867389665561e-01, -1.24382822795215e-01, -1.23871313083308e-01, -1.23333350056412e-01, -1.22769421491615e-01,
  -1.22180013125090e-01, -1.21565608372002e-01, -1.20926688057508e-01, -1.20263730158571e-01, -1.19577209556363e-01,
  -1.18867597798963e-01, -1.18135362874108e-01, -1.17380968991769e-01, -1.16604876376254e-01, -1.15807541067636e-01,
  -1.14989414732229e-01, -1.14150944481877e-01, -1.13292572701811e-01, -1.12414736886865e-01, -1.11517869485751e-01,
  -1.10602397753238e-01, -1.09668743609940e-01, -1.08717323509537e-01, -1.07748548313160e-01, -1.06762823170758e-01,
  -1.05760547409216e-01, -1.04742114427009e-01, -1.03707911595161e-01, -1.02658320164379e-01, -1.01593715178041e-01,
  -1.00514465390947e-01, -9.94209331935862e-02, -9.83134745417277e-02, -9.71924388911294e-02, -9.60581691372811e-02,
  -9.49110015598248e-02, -9.37512657716398e-02, -9.25792846723355e-02, -9.13953744059816e-02, -9.01998443229276e-02,
  -8.89929969455675e-02, -8.77751279378196e-02, -8.65465260782469e-02, -8.53074732366004e-02, -8.40582443536833e-02,
  -8.27991074243420e-02, -8.15303234834765e-02, -8.02521465949287e-02, -7.89648238430683e-02, -7.76685953270027e-02,
  -7.63636941572376e-02, -7.50503464546742e-02, -7.37287713518224e-02, -7.23991809960850e-02, -7.10617805550441e-02,
  -6.97167682235720e-02, -6.83643352326898e-02, -6.70046658600697e-02, -6.56379374420468e-02, -6.42643203870413e-02,
  -6.28839781903245e-02, -6.14970674499730e-02, -6.01037378839482e-02, -5.87041323482186e-02, -5.72983868557817e-02,
  -5.58866305965670e-02, -5.44689859580532e-02, -5.30455685465935e-02, -5.16164872093029e-02, -5.01818440564700e-02,
  -4.87417344843766e-02, -4.72962471984936e-02, -4.58454642369478e-02, -4.43894609941768e-02, -4.29283062447430e-02,
  -4.14620621672095e-02, -3.99907843680162e-02, -3.85145219052718e-02, -3.70333173124695e-02, -3.55472066219470e-02,
  -3.40562193881775e-02, -3.25603787106687e-02, -3.10597012566014e-02, -2.95541972829085e-02, -2.80438706581184e-02,
  -2.65287188833277e-02, -2.50087331130474e-02, -2.34838981749109e-02, -2.19541925893158e-02, -2.04195885876335e-02,
  -1.88800521304865e-02, -1.73355429243209e-02, -1.57860144380435e-02, -1.42314139179175e-02, -1.26716824022341e-02,
  -1.11067547345283e-02, -9.53655957599953e-03, -7.96101941697118e-03, -6.38005058687553e-03, -4.79356326376286e-03,
  -3.20146148186505e-03, -1.60364313873210e-03,  0.00000000000000e+00,  1.60958230334279e-03,  3.22522427279022e-03

};
Real uzIm[]={
  -3.12163375169548e-04, -1.56935805819431e-04,  0.00000000000000e+00,  1.58454704210853e-04,  3.18243160573060e-04,
    4.79184414684687e-04,  6.41101703758180e-04,  8.03822510009438e-04,  9.67178609276090e-04,  1.13100611110330e-03,
    1.29514549043598e-03,  1.45944161132264e-03,  1.62374374304578e-03,  1.78790556908277e-03,  1.95178518928747e-03,
    2.11524511567276e-03,  2.27815226215990e-03,  2.44037792865088e-03,  2.60179777976455e-03,  2.76229181856998e-03,
    2.92174435563380e-03,  3.08004397369105e-03,  3.23708348823453e-03,  3.39275990430777e-03,  3.54697436977611e-03,
    3.69963212533818e-03,  3.85064245153066e-03,  3.99991861296846e-03,  4.14737780005251e-03,  4.29294106836615e-03,
    4.43653327597427e-03,  4.57808301882644e-03,  4.71752256445916e-03,  4.85478778418126e-03,  4.98981808391937e-03,
    5.12255633389093e-03,  5.25294879726429e-03,  5.38094505795836e-03,  5.50649794772470e-03,  5.62956347265040e-03,
    5.75010073920951e-03,  5.86807187998679e-03,  5.98344197918948e-03,  6.09617899805569e-03,  6.20625370026407e-03,
    6.31363957743994e-03,  6.41831277485178e-03,  6.52025201738097e-03,  6.61943853584829e-03,  6.71585599376921e-03,
    6.80949041461191e-03,  6.90033010961974e-03,  6.98836560626282e-03,  7.07358957737266e-03,  7.15599677101392e-03,
    7.23558394114105e-03,  7.31234977908445e-03,  7.38629484590742e-03,  7.45742150567151e-03,  7.52573385964307e-03,
    7.59123768147440e-03,  7.65394035338454e-03,  7.71385080336653e-03,  7.77097944344340e-03,  7.82533810899082e-03,
    7.87693999914557e-03,  7.92579961831320e-03,  7.97193271878771e-03,  8.01535624449371e-03,  8.05608827585996e-03,
    8.09414797582882e-03,  8.12955553700894e-03,  8.16233212997122e-03,  8.19249985269256e-03,  8.22008168114309e-03,
    8.24510142102094e-03,  8.26758366062416e-03,  8.28755372486366e-03,  8.30503763040479e-03,  8.32006204193603e-03,
    8.33265422955446e-03,  8.34284202726019e-03,  8.35065379255149e-03,  8.35611836710862e-03,  8.35926503855700e-03,
    8.36012350329730e-03,  8.35872383038938e-03,  8.35509642648032e-03,  8.34927200175688e-03,  8.34128153691718e-03,
    8.33115625113819e-03,  8.31892757103064e-03,  8.30462710056406e-03,  8.28828659194456e-03,  8.26993791743287e-03,
    8.24961304208479e-03,  8.22734399739703e-03,  8.20316285584427e-03,  8.17710170628852e-03,  8.14919263024515e-03,
    8.11946767898913e-03,  8.08795885148336e-03,  8.05469807311336e-03,  8.01971717520993e-03,  7.98304787534410e-03,
    7.94472175837688e-03,  7.90477025824642e-03,  7.86322464047658e-03,  7.82011598538771e-03,  7.77547517199752e-03,
    7.72933286259016e-03,  7.68171948793967e-03,  7.63266523317165e-03,  7.58220002424522e-03,  7.53035351504081e-03,
    7.47715507503613e-03,  7.42263377755606e-03,  7.36681838857852e-03,  7.30973735608488e-03,  7.25141879993356e-03,
    7.19189050224861e-03,  7.13117989830187e-03,  7.06931406787938e-03,  7.00631972711316e-03,  6.94222322076736e-03,
    6.87705051496275e-03,  6.81082719032707e-03,  6.74357843555463e-03,  6.67532904136763e-03,  6.60610339485887e-03,
    6.53592547420777e-03,  6.46481884375616e-03,  6.39280664943014e-03,  6.31991161449419e-03,  6.24615603563337e-03,
    6.17156177933881e-03,  6.09615027859750e-03,  6.01994252986763e-03,  5.94295909033052e-03,  5.86522007540747e-03,
    5.78674515653398e-03,  5.70755355917511e-03,  5.62766406107745e-03,  5.54709499074413e-03,  5.46586422612519e-03,
    5.38398919351186e-03,  5.30148686662680e-03,  5.21837376590142e-03,  5.13466595792886e-03,  5.05037905508771e-03,
    4.96552821532434e-03,  4.88012814208828e-03,  4.79419308441069e-03,  4.70773683711810e-03,  4.62077274117615e-03,
    4.53331368415185e-03,  4.44537210078981e-03,  4.35695997369506e-03,  4.26808883411386e-03,  4.17876976280704e-03,
    4.08901339100968e-03,  3.99882990146850e-03,  3.90822902955290e-03,  3.81722006443296e-03,  3.72581185031631e-03,
    3.63401278774276e-03,  3.54183083492436e-03,  3.44927350913242e-03,  3.35634788812074e-03,  3.26306061158272e-03,
    3.16941788263528e-03,  3.07542546932739e-03,  2.98108870616569e-03,  2.88641249565263e-03,  2.79140130983538e-03,
    2.69605919185784e-03,  2.60038975751337e-03,  2.50439619679217e-03,  2.40808127542285e-03,  2.31144733639822e-03,
    2.21449630148990e-03,  2.11722967273694e-03,  2.01964853391810e-03,  1.92175355198778e-03,  1.82354497849594e-03,
    1.72502265095196e-03,  1.62618599418045e-03,  1.52703402160252e-03,  1.42756533651276e-03,  1.32777813326384e-03,
    1.22767019845464e-03,  1.12723891200773e-03,  1.02648124825171e-03,  9.25393776889395e-04,  8.23972663951729e-04,
    7.22213672657505e-04,  6.20112164221045e-04,  5.17663098596692e-04,  4.14861035128788e-04,  3.11700133169938e-04,
    2.08174152572415e-04,  1.04276454152263e-04,  0.00000000000000e+00, -1.04662646697224e-04, -2.09719321514876e-04

};
Real pRe[]={
    6.10546624016687e-02,  5.98913127441747e-02,  5.87500437076313e-02,  5.76303921702754e-02,  5.65319050443301e-02,
    5.54541392767015e-02,  5.43966616145863e-02,  5.33590483608655e-02,  5.23408851351769e-02,  5.13417666415930e-02,
    5.03612964427746e-02,  4.93990867403937e-02,  4.84547581616287e-02,  4.75279395515378e-02,  4.66182677711222e-02,
    4.57253875009032e-02,  4.48489510498359e-02,  4.39886181693957e-02,  4.31440558726754e-02,  4.23149382583365e-02,
    4.15009463392668e-02,  4.07017678757977e-02,  3.99170972133429e-02,  3.91466351243228e-02,  3.83900886542454e-02,
    3.76471709718166e-02,  3.69176012229604e-02,  3.62011043886301e-02,  3.54974111462979e-02,  3.48062577350133e-02,
    3.41273858239245e-02,  3.34605423841615e-02,  3.28054795639797e-02,  3.21619545670703e-02,  3.15297295339452e-02,
    3.09085714263052e-02,  3.02982519143071e-02,  2.96985472666445e-02,  2.91092382433616e-02,  2.85301099913223e-02,
    2.79609519422577e-02,  2.74015577133192e-02,  2.68517250100665e-02,  2.63112555318204e-02,  2.57799548793140e-02,
    2.52576324645791e-02,  2.47441014230031e-02,  2.42391785274972e-02,  2.37426841047164e-02,  2.32544419532745e-02,
    2.27742792638995e-02,  2.23020265414745e-02,  2.18375175289129e-02,  2.13805891328187e-02,  2.09310813508807e-02,
    2.04888372009546e-02,  2.00537026517877e-02,  1.96255265553400e-02,  1.92041605806602e-02,  1.87894591492717e-02,
    1.83812793720324e-02,  1.79794809874240e-02,  1.75839263012352e-02,  1.71944801276011e-02,  1.68110097313615e-02,
    1.64333847717040e-02,  1.60614772470574e-02,  1.56951614412019e-02,  1.53343138705641e-02,  1.49788132326653e-02,
    1.46285403556928e-02,  1.42833781491641e-02,  1.39432115556558e-02,  1.36079275035692e-02,  1.32774148609040e-02,
    1.29515643900162e-02,  1.26302687033312e-02,  1.23134222199904e-02,  1.20009211234038e-02,  1.16926633196874e-02,
    1.13885483969608e-02,  1.10884775854827e-02,  1.07923537186030e-02,  1.05000811945100e-02,  1.02115659387513e-02,
    9.92671536750915e-03,  9.64543835161026e-03,  9.36764518125044e-03,  9.09324753141592e-03,  8.82215842798325e-03,
    8.55429221447943e-03,  8.28956451948590e-03,  8.02789222466859e-03,  7.76919343341846e-03,  7.51338744008595e-03,
    7.26039469979409e-03,  7.01013679881485e-03,  6.76253642549401e-03,  6.51751734171001e-03,  6.27500435485275e-03,
    6.03492329030839e-03,  5.79720096443681e-03,  5.56176515802877e-03,  5.32854459022955e-03,  5.09746889291683e-03,
    4.86846858552069e-03,  4.64147505027351e-03,  4.41642050787824e-03,  4.19323799358378e-03,  3.97186133365613e-03,
    3.75222512223453e-03,  3.53426469856193e-03,  3.31791612457954e-03,  3.10311616287498e-03,  2.88980225497441e-03,
    2.67791249996879e-03,  2.46738563346463e-03,  2.25816100685021e-03,  2.05017856686783e-03,  1.84337883548351e-03,
    1.63770289004505e-03,  1.43309234372023e-03,  1.22948932620658e-03,  1.02683646470451e-03,  8.25076865145895e-04,
    6.24154093670134e-04,  4.24012158339952e-04,  2.24595491089446e-04,  2.58489298968894e-05, -1.72282298825026e-04,
  -3.69852597628481e-04, -5.66916015226607e-04, -7.63526263493083e-04, -9.59736734272043e-04, -1.15560051600491e-03,
  -1.35117041018079e-03, -1.54649894761664e-03, -1.74163840457374e-03, -1.93664081871643e-03, -2.13155800491936e-03,
  -2.32644157092915e-03, -2.52134293288651e-03, -2.71631333071427e-03, -2.91140384337754e-03, -3.10666540402112e-03,
  -3.30214881498991e-03, -3.49790476273799e-03, -3.69398383263123e-03, -3.89043652364934e-03, -4.08731326299197e-03,
  -4.28466442059452e-03, -4.48254032355856e-03, -4.68099127050173e-03, -4.88006754583234e-03, -5.07981943395336e-03,
  -5.28029723340081e-03, -5.48155127092115e-03, -5.68363191549254e-03, -5.88658959229467e-03, -6.09047479663159e-03,
  -6.29533810781218e-03, -6.50123020299324e-03, -6.70820187098893e-03, -6.91630402605150e-03, -7.12558772162770e-03,
  -7.33610416409506e-03, -7.54790472648240e-03, -7.76104096217927e-03, -7.97556461863783e-03, -8.19152765107197e-03,
  -8.40898223615802e-03, -8.62798078574073e-03, -8.84857596054879e-03, -9.07082068392455e-03, -9.29476815557126e-03,
  -9.52047186532245e-03, -9.74798560693750e-03, -9.97736349192745e-03, -1.02086599634144e-02, -1.04419298100300e-02,
  -1.06772281798552e-02, -1.09146105944075e-02, -1.11541329626768e-02, -1.13958515952170e-02, -1.16398232182950e-02,
  -1.18861049881016e-02, -1.21347545050295e-02, -1.23858298280207e-02, -1.26393894889880e-02, -1.28954925073149e-02,
  -1.31541984044370e-02, -1.34155672185102e-02, -1.36796595191680e-02, -1.39465364223731e-02, -1.42162596053673e-02,
  -1.44888913217226e-02, -1.47644944164989e-02, -1.50431323415112e-02, -1.53248691707114e-02, -1.56097696156874e-02,
  -1.58978990412841e-02, -1.61893234813453e-02, -1.64841096545091e-02, -1.67823249790671e-02, -1.70840375730844e-02

};
Real pIm[]={
    9.38945337598331e-01,  9.21054455986135e-01,  9.03503147066303e-01,  8.86284288597820e-01,  8.69390912650008e-01,
    8.52816205613212e-01,  8.36553504594159e-01,  8.20596293654199e-01,  8.04938200134901e-01,  7.89572991085226e-01,
    7.74494569788288e-01,  7.59696972384524e-01,  7.45174364588266e-01,  7.30921038494686e-01,  7.16931409474272e-01,
    7.03200013152066e-01,  6.89721502469015e-01,  6.76490644822836e-01,  6.63502319285959e-01,  6.50751513898115e-01,
    6.38233323031296e-01,  6.25942944824850e-01,  6.13875678688559e-01,  6.02026922871640e-01,  5.90392172095649e-01,
    5.78967015249365e-01,  5.67747133143805e-01,  5.56728296325538e-01,  5.45906362946550e-01,  5.35277276689030e-01,
    5.24837064743385e-01,  5.14581835837943e-01,  5.04507778318840e-01,  4.94611158278571e-01,  4.84888317731841e-01,
    4.75335672837285e-01,  4.65949712163783e-01,  4.56726995000032e-01,  4.47664149706153e-01,  4.38757872106149e-01,
    4.30004923919979e-01,  4.21402131234207e-01,  4.12946383010069e-01,  4.04634629627911e-01,  3.96463881466994e-01,
    3.88431207519636e-01,  3.80533734038778e-01,  3.72768643217982e-01,  3.65133171903002e-01,  3.57624610334035e-01,
    3.50240300917803e-01,  3.42977637028646e-01,  3.35834061837815e-01,  3.28807067170208e-01,  3.21894192387799e-01,
    3.15093023298999e-01,  3.08401191093286e-01,  3.01816371300397e-01,  2.95336282773406e-01,  2.88958686695059e-01,
    2.82681385606740e-01,  2.76502222459449e-01,  2.70419079686194e-01,  2.64429878295255e-01,  2.58532576983727e-01,
    2.52725171270815e-01,  2.47005692650370e-01,  2.41372207762125e-01,  2.35822817581157e-01,  2.30355656625086e-01,
    2.24968892178549e-01,  2.19660723534468e-01,  2.14429381251709e-01,  2.09273126428664e-01,  2.04190249992361e-01,
    1.99179072002683e-01,  1.94237940971300e-01,  1.89365233194943e-01,  1.84559352102617e-01,  1.79818727616418e-01,
    1.75141815525581e-01,  1.70527096873411e-01,  1.65973077356782e-01,  1.61478286737845e-01,  1.57041278267654e-01,
    1.52660628121387e-01,  1.48334934844851e-01,  1.44062818812006e-01,  1.39842921693171e-01,  1.35673905933695e-01,
    1.31554454242765e-01,  1.27483269092117e-01,  1.23459072224380e-01,  1.19480604170805e-01,  1.15546623778132e-01,
    1.11655907744347e-01,  1.07807250163114e-01,  1.03999462076630e-01,  1.00231371036698e-01,  9.65018206737978e-02,
    9.28096702739353e-02,  8.91537943630688e-02,  8.55330822989121e-02,  8.19464378699136e-02,  7.83927789012194e-02,
    7.48710368674359e-02,  7.13801565120037e-02,  6.79190954730057e-02,  6.44868239152359e-02,  6.10823241683551e-02,
    5.77045903709655e-02,  5.43526281204465e-02,  5.10254541283829e-02,  4.77220958814369e-02,  4.44415913075080e-02,
    4.11829884470294e-02,  3.79453451292584e-02,  3.47277286534157e-02,  3.15292154745318e-02,  2.83488908938678e-02,
    2.51858487537713e-02,  2.20391911368395e-02,  1.89080280692595e-02,  1.57914772281985e-02,  1.26886636531230e-02,
    9.59871946092257e-03,  6.52078356472244e-03,  3.45400139626607e-03,  3.97524631755210e-04, -2.64948907896666e-03,
  -5.68787637999373e-03, -8.71846847381250e-03, -1.17420913827344e-02, -1.47595662074117e-02, -1.77717093825373e-02,
  -2.07793329298318e-02, -2.37832447084123e-02, -2.67842486626439e-02, -2.97831450675653e-02, -3.27807307719844e-02,
  -3.57777994393364e-02, -3.87751417863933e-02, -4.17735458199145e-02, -4.47737970713278e-02, -4.77766788295248e-02,
  -5.07829723718561e-02, -5.37934571934145e-02, -5.68089112346808e-02, -5.98301111076240e-02, -6.28578323203233e-02,
  -6.58928495002054e-02, -6.89359366159650e-02, -7.19878671982492e-02, -7.50494145591832e-02, -7.81213520108104e-02,
  -8.12044530825226e-02, -8.42994917375531e-02, -8.74072425886079e-02, -9.05284811127012e-02, -9.36639838652751e-02,
  -9.68145286936616e-02, -9.99808949499723e-02, -1.03163863703472e-01, -1.06364217952509e-01, -1.09582742836069e-01,
  -1.12820225845026e-01, -1.16077457033146e-01, -1.19355229227918e-01, -1.22654338241275e-01, -1.25975583080271e-01,
  -1.29319766157777e-01, -1.32687693503263e-01, -1.36080174973731e-01, -1.39498024464851e-01, -1.42942060122388e-01,
  -1.46413104553948e-01, -1.49911985041146e-01, -1.53439533752220e-01, -1.56996587955181e-01, -1.60583990231548e-01,
  -1.64202588690731e-01, -1.67853237185124e-01, -1.71536795525977e-01, -1.75254129700095e-01, -1.79006112087434e-01,
  -1.82793621679655e-01, -1.86617544299688e-01, -1.90478772822390e-01, -1.94378207396326e-01, -1.98316755666753e-01,
  -2.02295332999875e-01, -2.06314862708415e-01, -2.10376276278565e-01, -2.14480513598385e-01, -2.18628523187714e-01,
  -2.22821262429640e-01, -2.27059697803604e-01, -2.31344805120191e-01, -2.35677569757687e-01, -2.40058986900424e-01,
  -2.44490061779029e-01, -2.48971809912504e-01, -2.53505257351137e-01, -2.58091440905029e-01, -2.62731408145932e-01

};

        printF("SmCylinderExactSolution: GET DATA FOR EXACT SOLUTION:\n  omega=%g, Ng=%d, ia=%d, ib=%d\n",omega,Ng,ia,ib);
        printF("  ra=%g, rb=%g, m=%d, za=%g, zb=%g, kz=%g\n",ra,rb,m, za,zb,kz);

    // Fill in variables with the "same" name but in outer-scope 
        ra_=ra; rb_=rb; za_=za; zb_=zb; kz_=kz; omega_=omega;  m_=m;

    // Grid in r (includes ghost)
    //         +--+--X--+--+--+-- ...   --+--+--X--+--+
    //         1     ia                         ib    Ng
    //               r=ra                      r=rb
    //               0  1  2                    nr         <- base 0 
        int nr = ib-ia+1;          // number of grid points
        int numGhost0 = ia-1;      // num ghost on left 
        int numGhost1 = Ng-ib;     // num ghost on right
        assert( numGhost0==numGhost1 ); 

        IntegerArray dimension(2,3), gridIndexRange(2,3);
        dimension=0;
        gridIndexRange=0;

        gridIndexRange(1,0)=nr-1;

        dimension(0,0)=gridIndexRange(0,0)-numGhost0;
        dimension(1,0)=gridIndexRange(1,0)+numGhost1;

        int nurbsDegree=3; 
    // here is the new interpolate: 
        int xDegree[3] ={ nurbsDegree,nurbsDegree,nurbsDegree };  // 

        int domainDimension=1, rangeDimension=2; 
        RealArray x(Ng,1,1,1,rangeDimension);  // data 

        Real *uReArray[]={ urRe, uThetaRe, uzRe, pRe }; // array of pointers to array of real-parts 
        Real *uImArray[]={ urIm, uThetaIm, uzIm, pIm }; // array of pointers to array of imaginary-parts 
        for( int n=0; n<numNurbs; n++ )
        {

            Real *uRe = uReArray[n];
            Real *uIm = uImArray[n];
            for( int i=0; i<Ng; i++ )
            {
        // printF(" n=%d: i=%d uRe=%g, uIm=%g\n",n,i,uRe[i],uIm[i]);
                x(i,0,0,0,0) = uRe[i];
                x(i,0,0,0,1) = uIm[i]; 
            }
      // --- Nurbs[n] holds the Re and Im parts of the radial solutions ---
            nurbs[n].interpolate( x,domainDimension,rangeDimension,dimension,gridIndexRange,
                                                        NurbsMapping::parameterizeByIndex,xDegree );
        }
    }

    Real ra=ra_, rb=rb_, za=za_, zb=zb_, kz=kz_;
    omega=omega_; // set value in the dbase
    int m = m_;

    if( 0==1 )
    {
    // Plot radial solution for testing 
        GenericGraphicsInterface & gi = *Overture::getGraphicsInterface();
        PlotStuffParameters psp;
        psp.set(GI_PLOT_THE_OBJECT_AND_EXIT,false);
    // plot the curve (x(r),y(r),z(r))
        PlotIt::plot( gi,nurbs[0], psp );

        OV_ABORT("stop here for now");
    }


  // ---- Fill in Grid functions with the Real and Imaginary Parts of the Spatial Eigenfunction ----

    realCompositeGridFunction & wRe = dbase.put<realCompositeGridFunction>("wRe");
    realCompositeGridFunction & wIm = dbase.put<realCompositeGridFunction>("wIm");


    const int numberOfDimensions = cg.numberOfDimensions();

    const int numberOfComponents = 4; // u1,u2,u3,p
    Range all;
    wRe.updateToMatchGrid(cg,all,all,all,numberOfComponents);
    wIm.updateToMatchGrid(cg,all,all,all,numberOfComponents);

    const int u1c = 0;
    const int u2c = 1;
    const int u3c = 2;
    const int pc  = 3;

    const Real eps=1.e-9;   // ********************************** FIX ME *********

  // Real ra=0., rb=1.;  // Inner and outer radii ***** FIX ME 

  // int m=1, n=1; 

  // Real omega = 7.1234; 

    RealArray rv(1,1), wv(1,3);
    rv=0.;

    std::complex<LocalReal> I(0,1.); 
    std::complex<LocalReal> ur, uTheta, uz, p, expi, u1, u2; 

  // exp( - I*omega*t )
  // std::complex<LocalReal> expiOmegat = cos(omega*t) - I*sin(omega*t);

    printF("Eval the solution: ra=%g, rb=%g, m=%d, omega=%12.6e, kz=%12.6e\n",ra,rb,m,omega,kz);
    Index I1,I2,I3;
    for( int grid=0; grid<cg.numberOfComponentGrids(); grid++ )
    {
        MappedGrid & mg = cg[grid];
        mg.update(MappedGrid::THEvertex | MappedGrid::THEcenter);
        getIndex( mg.dimension(),I1,I2,I3 );

        OV_GET_SERIAL_ARRAY(real,mg.center(),xLocal);
        OV_GET_SERIAL_ARRAY(real,wRe[grid],wReLocal);
        OV_GET_SERIAL_ARRAY(real,wIm[grid],wImLocal);

        int i1,i2,i3;
        Real z = 0; 
        FOR_3D(i1,i2,i3,I1,I2,I3)
        {
            if( numberOfDimensions==3 )
                z = xLocal(i1,i2,i3,2);

                Real x = xLocal(i1,i2,i3,0);
                Real y = xLocal(i1,i2,i3,1);
                Real r = sqrt( x*x + y*y );
                if( r < eps ) //  avoid division by zero
                {
                    x=eps;           // avoid atan(0,0)
                    y=eps;
                    r=sqrt(2.)*eps;  // r=sqrt(x**2+y**2)
                }   
                Real theta = atan2(y,x); 
                Real cosTheta = cos(theta);
                Real sinTheta = sin(theta);

            rv(0,0) = (r-ra)/(rb-ra); // scale r to [0,1]

            nurbs[0].map( rv,wv );  // eval radial component of ur
            ur     = ( wv(0,0) + I*wv(0,1) ) ;

            nurbs[1].map( rv,wv );  // eval radial component of uTheta
            uTheta = ( wv(0,0) + I*wv(0,1) ) ;

            nurbs[2].map( rv,wv );  // eval radial component of uz
            uz     = ( wv(0,0) + I*wv(0,1) ) ; 

            nurbs[3].map( rv,wv );  // eval radial component of p
            p      = ( wv(0,0) + I*wv(0,1) ) ; 

      // --- form the spatial part (complex) of the solution ---
      // expi = exp(i*m*theta) * exp(i*kz*z ) = exp( i*( m*theta + kz*z ) )
            expi = ( cos(m*theta + kz*z ) + I*sin(m*theta + kz*z ) );

            ur     = ur*expi;
            uTheta = uTheta*expi;
            uz     = uz*expi;
            p      = p*expi;

      // Cartesian components of the displacement
      // (u1,u2) = ur*rHat + vr*thetaHat 
      // ur = rHat*uv
      // uTheta = thetaHat*uv
            u1 = ur*cosTheta - uTheta*sinTheta;;
            u2 = ur*sinTheta + uTheta*cosTheta;

            wReLocal(i1,i2,i3,u1c) = std::real( u1 );
            wReLocal(i1,i2,i3,u2c) = std::real( u2 );
            wReLocal(i1,i2,i3,u3c) = std::real( uz );
            wReLocal(i1,i2,i3,pc ) = std::real( p  );

            wImLocal(i1,i2,i3,u1c) = std::imag( u1 );
            wImLocal(i1,i2,i3,u2c) = std::imag( u2 );
            wImLocal(i1,i2,i3,u3c) = std::imag( uz );
            wImLocal(i1,i2,i3,pc ) = std::imag( p  );

        }

    } // end for grid 


  // clean up 
    delete [] nurbs;
    
    return 0;
}




//========================================================================================================
/// \brief Evaluate the exact solution
//========================================================================================================
int SmCylinderExactSolution::
evalSolution(Real t, CompositeGrid & cg, int grid, RealArray & ua, 
                          const Index & I1, const Index &I2, const Index &I3, 
                          int numberOfTimeDerivatives /* = 0 */  )
{

    const bool & initialized=dbase.get<bool>("initialized");
    if( !initialized )
    {
        OV_ABORT("SmCylinderExactSolution:ERROR:evalSolution: Solution is NOT initialized!");
    }


    const int u1c = 0;
    const int u2c = 1;
    const int u3c = 2;
    const int pc  = 3;

    MappedGrid & mg = cg[grid];

    OV_GET_SERIAL_ARRAY(real,ua,uLocal);

  // -- Here are the real and imaginary parts of the spatial solution ---
    realCompositeGridFunction & wRe = dbase.get<realCompositeGridFunction>("wRe");
    realCompositeGridFunction & wIm = dbase.get<realCompositeGridFunction>("wIm");
    OV_GET_SERIAL_ARRAY(real,wRe[grid],wReLocal);
    OV_GET_SERIAL_ARRAY(real,wIm[grid],wImLocal);

    const Real & omega = dbase.get<Real>("omega"); 
    const Real coswt = cos(omega*t), sinwt=sin(omega*t);
    int i1,i2,i3;
    FOR_3D(i1,i2,i3,I1,I2,I3)
    {
    // solution = Re( (wRe+I*wIm)*exp( - I*omega*t) )
        uLocal(i1,i2,i3,u1c) = wReLocal(i1,i2,i3,u1c)*coswt + wImLocal(i1,i2,i3,u1c)*sinwt; 
        uLocal(i1,i2,i3,u2c) = wReLocal(i1,i2,i3,u2c)*coswt + wImLocal(i1,i2,i3,u2c)*sinwt; 
        uLocal(i1,i2,i3,u3c) = wReLocal(i1,i2,i3,u3c)*coswt + wImLocal(i1,i2,i3,u3c)*sinwt; 
        uLocal(i1,i2,i3,pc ) = wReLocal(i1,i2,i3,pc) *coswt + wImLocal(i1,i2,i3,pc) *sinwt; 

    }

    return 0;
}


