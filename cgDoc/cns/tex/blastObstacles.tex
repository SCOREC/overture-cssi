\subsection{Blast wave hitting obstacles}\label{sec:blastObstacles}

To run these example see {\tt cg/cssi/runs/blast/blast.cmd}.

The initial conditions consists of a circle or sphere of high pressure and density.

{
\begin{figure}[htb]
\begin{center}
\begin{tikzpicture}[scale=1]
  \useasboundingbox (0,.5) rectangle (14.,6);  % set the bounding box (so we have less surrounding white space)
%
  \figByHeightb{  0}{0}{fig/blastShapest0p4}{6cm}[.1][.1][.15][.15]; 
  \figByHeightb{  7}{0}{fig/blastShapest1p0}{6cm}[.1][.1][.15][.15]; 
  % \figByHeightWithLabel{  0}{0}{fig/blastShapest1p0}{6cm}[.1][.1][.1][.1][\scriptsizess Shapes];
  % \draw ( 0, 0) node[anchor=south west,xshift=-4pt,yshift=+0pt] {\trimfig{\cssiDocDir/fig/multiCylOneStepColourSchlieren1p0}{\figWidth}};
%
% grid:
 %   \draw[step=1cm,gray] (0,0) grid (12,6);
\end{tikzpicture}
\end{center}
  \caption{Blast wave hitting 3 obstacles. Reverse colour schlieren.}
  \label{fig:blastShapes}
\end{figure}
}

{
\begin{figure}[htb]
\begin{center}
\begin{tikzpicture}[scale=1]
  \useasboundingbox (0,.5) rectangle (14.,6);  % set the bounding box (so we have less surrounding white space)
%
  \figByHeightb{  0}{0}{fig/multipleBuildingsGrid}{6cm}[.05][.0][.05][.15]; 
  % \figByHeightb{  7}{0}{fig/blastShapest1p0}{6cm}[.1][.1][.15][.15]; 
%
% grid:
 %   \draw[step=1cm,gray] (0,0) grid (12,6);
\end{tikzpicture}
\end{center}
  \caption{Grids for some buildings and tower.}
  \label{fig:eightBuildings}
\end{figure}
}

{
\begin{figure}[htb]
\begin{center}
\begin{tikzpicture}[scale=1]
  \useasboundingbox (0,.5) rectangle (14.,6);  % set the bounding box (so we have less surrounding white space)
%
  \figByHeightb{  0}{0}{fig/blastEightBuildings}{6cm}[.05][.0][.05][.15]; 
  \figByHeightb{  7}{0}{fig/blastEightBuildingsZoom}{6cm}[.0][.0][.0][.0]; 
%
% grid:
 %   \draw[step=1cm,gray] (0,0) grid (12,6);
\end{tikzpicture}
\end{center}
  \caption{Blast wave hitting some buildings. Density. Note AMR grids.
    % Reverse colour schlieren.
  }
  \label{fig:blastBuildings}
\end{figure}
}

{
\begin{figure}[htb]
\begin{center}
\begin{tikzpicture}[scale=1]
  \useasboundingbox (0,.5) rectangle (16.,6);  % set the bounding box (so we have less surrounding white space)
%
  \figByHeightb{  0}{0}{fig/blastEightBuildingsSchlierenZoomt0p3}{6cm}[.0][.0][.0][.0]; 
  \figByHeightb{  8}{0}{fig/blastEightBuildingsSchlierenSol8}{6cm}[.0][.0][.0][.0]; 
%
% grid:
 %   \draw[step=1cm,gray] (0,0) grid (12,6);
\end{tikzpicture}
\end{center}
  \caption{Blast wave hitting some buildings. 
    Reverse colour schlieren. Note AMR grids. Grids coarsened for plotting. 
  }
  \label{fig:blastBuildingsSchlieren}
\end{figure}
}

{
\begin{figure}[htb]
\begin{center}
\begin{tikzpicture}[scale=1]
  \useasboundingbox (0,.5) rectangle (16.,6);  % set the bounding box (so we have less surrounding white space)
%
  \figByHeightb{  0}{0}{fig/blastEightBuildingsSchlierenSol8lw2}{6cm}[.0][.0][.0][.0]; 
  \figByHeightb{  8}{0}{fig/blastEightBuildingsSchlierenSol8lw2b}{6cm}[.0][.0][.0][.0]; 
%
% grid:
 %   \draw[step=1cm,gray] (0,0) grid (12,6);
\end{tikzpicture}
\end{center}
  \caption{Blast wave hitting some buildings. 
    Reverse colour schlieren. Note AMR grids. Grids coarsened for plotting. 
  }
  \label{fig:blastBuildingsSchlieren}
\end{figure}
}


% ------------------ DOWNTOWN -----------------
Figures~\ref{fig:blastDowntownGrid}~\ref{fig:blastDowtownI}~\ref{fig:blastDowtownII}
show results from two blasts in a downtown set of buildings. Results computed
with AMR. Note: (June 24, 2021) -- code stopped at some point with a problem with AMR regridding -- 
need to fix this.

{
\begin{figure}[htb]
\begin{center}
\begin{tikzpicture}[scale=1]
  \useasboundingbox (0,.5) rectangle (15.,6);  % set the bounding box (so we have less surrounding white space)
%
  \figByHeightb{  0}{0}{fig/downTownGrid}{6cm}[.1][.05][.2][.2]; 
  \figByHeightb{  9}{0}{fig/downTownGridZoom}{6cm}[.0][.0][.0][.0]; 
  % \figByHeightb{  7}{0}{fig/blastShapest1p0}{6cm}[.1][.1][.15][.15]; 
%
% grid:
 %   \draw[step=1cm,gray] (0,0) grid (12,6);
\end{tikzpicture}
\end{center}
  \caption{Grids for downtown buildings. Smoothed polygon grids are automatically constructed around polygonal building cross-sections.
     Note the treatment of concave corners by using multiple smoothed polygon grids on the boundary.}
  \label{fig:blastDowntownGrid}
\end{figure}
}



{
\begin{figure}[htb]
\begin{center}
\begin{tikzpicture}[scale=1]
  \useasboundingbox (0,.5) rectangle (14.,6);  % set the bounding box (so we have less surrounding white space)
%
  \figByHeightb{  0}{0}{fig/downTownSchlieren}{6cm}[.05][.0][.05][.15]; 
  % \figByHeightb{  7}{0}{fig/downTownGridZoom}{6cm}[.05][.0][.05][.15]; 
  % \figByHeightb{  7}{0}{fig/blastShapest1p0}{6cm}[.1][.1][.15][.15]; 
%
% grid:
 %   \draw[step=1cm,gray] (0,0) grid (12,6);
\end{tikzpicture}
\end{center}
  \caption{Blast waves hitting some downtown buildings. Reverse colour schlieren.}
  \label{fig:blastDowtownI}
\end{figure}
}



{
\begin{figure}[htb]
\begin{center}
\begin{tikzpicture}[scale=1]
  \useasboundingbox (0,.5) rectangle (14.,6);  % set the bounding box (so we have less surrounding white space)
%
  \figByHeightb{  0}{0}{fig/downTownSchlierenTime0p08}{6cm}[.05][.0][.05][.15]; 
  \figByHeightb{  8}{0}{fig/downTownSchlierenTime0p08Zoom}{6cm}[.05][.0][.05][.15]; 
  % \figByHeightb{  7}{0}{fig/blastShapest1p0}{6cm}[.1][.1][.15][.15]; 
%
% grid:
 %   \draw[step=1cm,gray] (0,0) grid (12,6);
\end{tikzpicture}
\end{center}
  \caption{Blast waves hitting some downtown buildings. Reverse colour schlieren.}
  \label{fig:blastDowtownII}
\end{figure}
}
